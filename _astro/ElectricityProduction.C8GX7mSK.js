import{S as X,i as v,s as x,d as M,e as V,t as H,f as D,h as Q,j as T,m as j,k as y,l as R,n as L,p as B,q as N,u as Z,B as $,z as ee,w as te,A as F,o as W,x as se,r as U,y as oe,b as re,c as ae,g as ne}from"./ECharts.CpYfIO0D.js";import{d as q}from"./dayjs.min.2rai63wT.js";import{E as le,a as O,U as Y,A as m,b as P,c as ce,d as fe}from"./AggregationLevelSelection.DG3xjRA_.js";import{T as ge}from"./Toggle.DSrT7CON.js";import{B as ue}from"./ButtonsToggle.DFVURX4c.js";import{m as z,i as G,j as me,l as K}from"./ChartLoadingSpinner.CgSIGXi5.js";import"./index.DACIwEDX.js";function pe(n){let t,e;return t=new ce({props:{aggregation:n[4],energyType:fe.ELECTRICITY,layout:n[5],onclick:n[11]}}),{c(){Z(t.$$.fragment)},l(s){B(t.$$.fragment,s)},m(s,g){j(t,s,g),e=!0},p(s,g){const o={};g&16&&(o.aggregation=s[4]),g&32&&(o.layout=s[5]),t.$set(o)},i(s){e||(D(t.$$.fragment,s),e=!0)},o(s){H(t.$$.fragment,s),e=!1},d(s){V(t,s)}}}function J(n){let t,e,s;function g(r){n[14](r)}let o={id:"showAverageToggle",label:"show average mark line"};return n[6]!==void 0&&(o.checked=n[6]),t=new ge({props:o}),re.push(()=>ae(t,"checked",g)),{c(){Z(t.$$.fragment)},l(r){B(t.$$.fragment,r)},m(r,a){j(t,r,a),s=!0},p(r,a){const b={};!e&&a&64&&(e=!0,b.checked=r[6],ne(()=>e=!1)),t.$set(b)},i(r){s||(D(t.$$.fragment,r),s=!0)},o(r){H(t.$$.fragment,r),s=!1},d(r){V(t,r)}}}function he(n){let t,e,s,g,o="Consumption",r,a,b,p,h,w,d="Data started at:",l,I,u=G(n[7])+"",S,i;a=new ue({props:{name:"buttons-toggle",selected:n[0],onchange:n[10],list:[{label:"Measured",value:O.PLAIN},{label:"Repartition",value:O.REPARTITION}]}});let f=n[0]===O.PLAIN&&J(n);return{c(){t=N("div"),e=N("div"),s=N("div"),g=N("span"),g.textContent=o,r=U(),Z(a.$$.fragment),b=U(),f&&f.c(),p=U(),h=N("div"),w=N("span"),w.textContent=d,l=U(),I=N("span"),S=oe(u),this.h()},l(_){t=R(_,"DIV",{class:!0});var k=L(t);e=R(k,"DIV",{class:!0});var C=L(e);s=R(C,"DIV",{class:!0});var c=L(s);g=R(c,"SPAN",{"data-svelte-h":!0}),F(g)!=="svelte-1vrp2az"&&(g.textContent=o),r=W(c),B(a.$$.fragment,c),c.forEach(M),b=W(C),f&&f.l(C),C.forEach(M),p=W(k),h=R(k,"DIV",{class:!0});var E=L(h);w=R(E,"SPAN",{"data-svelte-h":!0}),F(w)!=="svelte-1cta1ja"&&(w.textContent=d),l=W(E),I=R(E,"SPAN",{class:!0});var A=L(I);S=se(A,u),A.forEach(M),E.forEach(M),k.forEach(M),this.h()},h(){y(s,"class","flex flex-col items-center gap-2 md:flex-row"),y(e,"class","flex flex-col items-center gap-4 lg:flex-row"),y(I,"class","font-semibold"),y(h,"class","flex items-center gap-1 text-sm"),y(t,"class","flex flex-col-reverse items-center gap-4 py-4 lg:flex-row lg:justify-between lg:gap-0 lg:py-2")},m(_,k){Q(_,t,k),T(t,e),T(e,s),T(s,g),T(s,r),j(a,s,null),T(e,b),f&&f.m(e,null),T(t,p),T(t,h),T(h,w),T(h,l),T(h,I),T(I,S),i=!0},p(_,k){const C={};k&1&&(C.selected=_[0]),a.$set(C),_[0]===O.PLAIN?f?(f.p(_,k),k&1&&D(f,1)):(f=J(_),f.c(),D(f,1),f.m(e,null)):f&&($(),H(f,1,1,()=>{f=null}),ee()),(!i||k&128)&&u!==(u=G(_[7])+"")&&te(S,u)},i(_){i||(D(a.$$.fragment,_),D(f),i=!0)},o(_){H(a.$$.fragment,_),H(f),i=!1},d(_){_&&M(t),V(a),f&&f.d()}}}function ie(n){let t,e,s,g;return s=new le({props:{type:n[0],color:n[1],labels:n[2],unit:n[3],aggregation:n[4],timeseries:n[8],dataZoomOptions:n[9],showAverageMarkline:n[6],onclick:n[12],$$slots:{footer:[he],headerActions:[pe]},$$scope:{ctx:n}}}),{c(){t=N("div"),e=N("div"),Z(s.$$.fragment),this.h()},l(o){t=R(o,"DIV",{class:!0});var r=L(t);e=R(r,"DIV",{class:!0});var a=L(e);B(s.$$.fragment,a),a.forEach(M),r.forEach(M),this.h()},h(){y(e,"class","absolute top-0 right-0 bottom-0 left-0"),y(t,"class","relative grow")},m(o,r){Q(o,t,r),T(t,e),j(s,e,null),g=!0},p(o,[r]){const a={};r&1&&(a.type=o[0]),r&2&&(a.color=o[1]),r&4&&(a.labels=o[2]),r&8&&(a.unit=o[3]),r&16&&(a.aggregation=o[4]),r&256&&(a.timeseries=o[8]),r&512&&(a.dataZoomOptions=o[9]),r&64&&(a.showAverageMarkline=o[6]),r&524529&&(a.$$scope={dirty:r,ctx:o}),s.$set(a)},i(o){g||(D(s.$$.fragment,o),g=!0)},o(o){H(s.$$.fragment,o),g=!1},d(o){o&&M(t),V(s)}}}function _e(n,t,e){const s={[`${O.PLAIN}`]:["Production"],[`${O.REPARTITION}`]:["I shared","I sold to market"]},g={[`${O.PLAIN}`]:[z],[`${O.REPARTITION}`]:[me,z]};let o=O.PLAIN,r=[z],a=s[o],b=Y.KWH,p=m.MONTH,h=P.YEAR,w=!1,d,l=[],I={showAll:!1},{data:u}=t;const S=c=>{e(0,o=O.PLAIN),e(3,b=Y.KWH),e(4,p=m.MONTH),e(5,h=P.YEAR),e(8,l=c.months.plain),e(7,d=l[0].startedAt),e(1,r=g[o]),e(2,a=s[o]),e(9,I={showAll:!1})},i=c=>{const E=o===O.REPARTITION?"repartition":"plain";return c[E]},f=c=>{e(0,o=c),e(3,b=Y.KWH),e(6,w=!1),e(4,p=m.MONTH),e(5,h=P.YEAR),e(8,l=i(u.months)),e(7,d=l[0].startedAt),e(1,r=g[o]),e(2,a=s[o])},_=(c,E)=>{if(e(3,b=Y.KWH),e(9,I={showAll:!1}),E===P.YEAR){switch(c){case m.MONTH:e(8,l=i(u.months));break;case m.WEEK:e(8,l=i(u.weeks));break}e(7,d=l[0].startedAt),e(4,p=c),e(5,h=E);return}let A=K(q(d).startOf("month"));switch(c){case m.WEEK:e(8,l=i(u.weeksMap[A]));break;case m.DAY:e(8,l=i(u.daysMap[A]));break;case m.HOUR:A=K(d),e(8,l=i(u.hoursMap[A])),e(9,I={showAll:!0});break}e(7,d=l[0].startedAt),e(4,p=c),e(5,h=E)},k=c=>{const{startedAt:E}=c;let A=K(E);if(console.log("ElectricityProduction.onChartClick timeserie",c),e(9,I={showAll:!1}),h===P.YEAR){switch(p){case m.MONTH:e(4,p=m.WEEK),e(8,l=i(u.weeksMap[A]));break;case m.WEEK:A=K(q(E).startOf("month")),e(4,p=m.DAY),e(8,l=i(u.daysMap[A]));break}e(7,d=l[0].startedAt),e(5,h=P.MONTH);return}switch(p){case m.WEEK:A=K(q(E).startOf("month")),e(4,p=m.DAY),e(8,l=i(u.daysMap[A]));break;case m.DAY:e(4,p=m.HOUR),e(8,l=i(u.hoursMap[A]));break;case m.HOUR:e(4,p=m.MINUTES),e(8,l=i(u.minutesMap[A])),e(3,b=Y.KW);break}e(7,d=l[0].startedAt),[m.HOUR,m.MINUTES].includes(p)&&(e(5,h=P.DAY),e(9,I={showAll:!0}))};function C(c){w=c,e(6,w)}return n.$$set=c=>{"data"in c&&e(13,u=c.data)},n.$$.update=()=>{n.$$.dirty&8192&&S(u)},[o,r,a,b,p,h,w,d,l,I,f,_,k,u,C]}class we extends X{constructor(t){super(),v(this,t,_e,ie,x,{data:13})}}export{we as default};
