import{S as K,i as X,s as H,E as ht,a as mt,b as gt,c as _t,d as f,e as J,t as Q,f as Z,g as bt,h as k,j as D,m as $,k as m,l as b,n as v,o as vt,p as tt,q as p,r as pt,u as et,v as yt,w as Ct,x as At,y as xt,z}from"./ECharts.DF4cteOg.js";import{d as M}from"./dayjs.min.Cbbdfn5l.js";import"./index.BiZfemjP.js";import{C as Y,a as Dt,D as kt,b as Et,W as wt,h as B,c as j,L as Ot,d as St}from"./common.GAsvbAih.js";function q(s){let t,e,a,r;return{c(){t=p("div"),e=p("span"),a=xt(s[0]),this.h()},l(o){t=b(o,"DIV",{class:!0});var c=v(t);e=b(c,"SPAN",{class:!0,title:!0});var n=v(e);a=At(n,s[0]),n.forEach(f),c.forEach(f),this.h()},h(){m(e,"class","text-[0.7rem]"),m(e,"title",r="Unit: "+s[0]),m(t,"class","absolute top-2 left-4 z-10")},m(o,c){k(o,t,c),D(t,e),D(e,a)},p(o,c){c&1&&Ct(a,o[0]),c&1&&r!==(r="Unit: "+o[0])&&m(e,"title",r)},d(o){o&&f(t)}}}function Lt(s){let t,e;return{c(){t=p("div"),e=p("div"),this.h()},l(a){t=b(a,"DIV",{class:!0});var r=v(t);e=b(r,"DIV",{class:!0,style:!0}),v(e).forEach(f),r.forEach(f),this.h()},h(){m(e,"class","h-20 w-20 animate-spin rounded-full border-4 border-t-4 border-gray-200"),z(e,"border-top-color",s[1]),m(t,"class","flex h-full w-full items-center justify-center")},m(a,r){k(a,t,r),D(t,e)},p(a,r){r&2&&z(e,"border-top-color",a[1])},d(a){a&&f(t)}}}function It(s){let t,e,a,r,o,c,n=s[0]&&q(s);function x(l){s[13](l)}let y={init:mt,options:s[3],notMerge:!0,$$slots:{default:[Lt]},$$scope:{ctx:s}};return s[2]!==void 0&&(y.chart=s[2]),r=new ht({props:y}),gt.push(()=>_t(r,"chart",x)),{c(){t=p("div"),n&&n.c(),e=pt(),a=p("div"),et(r.$$.fragment),this.h()},l(l){t=b(l,"DIV",{class:!0});var u=v(t);n&&n.l(u),e=vt(u),a=b(u,"DIV",{class:!0});var d=v(a);tt(r.$$.fragment,d),d.forEach(f),u.forEach(f),this.h()},h(){m(a,"class","absolute top-0 right-0 bottom-0 left-0 overflow-hidden rounded-lg border border-gray-100"),m(t,"class","relative grow")},m(l,u){k(l,t,u),n&&n.m(t,null),D(t,e),D(t,a),$(r,a,null),c=!0},p(l,[u]){l[0]?n?n.p(l,u):(n=q(l),n.c(),n.m(t,e)):n&&(n.d(1),n=null);const d={};u&8&&(d.options=l[3]),u&65538&&(d.$$scope={dirty:u,ctx:l}),!o&&u&4&&(o=!0,d.chart=l[2],bt(()=>o=!1)),r.$set(d)},i(l){c||(Z(r.$$.fragment,l),c=!0)},o(l){Q(r.$$.fragment,l),c=!1},d(l){l&&f(t),n&&n.d(),J(r)}}}function Rt(s,t,e){let{unit:a=""}=t;const r=Et,o=wt;let{xAxisAttribute:c="startedAt"}=t,{yAxisAttribute:n="value"}=t,{currentColor:x=Y}=t,{previousColor:y=Y}=t,{colorOpacity:l=.55}=t,{backgroundColor:u=Dt}=t,{data:d}=t,{onclick:E=kt}=t,_,L={};const rt=(i,C,R,w,T,F,ot)=>{const it=B(w,F),st=B(T,F),{current:U,previous:P}=i,G=U.length-1,O=U.reduce((h,A,g)=>{const V=g===G?w:it,W=g===G?T:st;return h.xAxis.push(A[C]),h.current.push({value:A[R],date:A[C],itemStyle:{borderRadius:j,borderWidth:1,borderColor:V,color:V}}),h.previous.push({value:P[g][R],date:P[g][C],itemStyle:{borderRadius:j,borderWidth:1,borderColor:W,color:W}}),h},{xAxis:[],current:[],previous:[]}),S="2%",N=30,nt={top:N,bottom:N,left:"15%",right:S},lt={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:h=>{let A="";return h.forEach(g=>{A+=`
            <div>
              <span style="display:inline-block;border-radius:10px;width:10px;height:10px;background-color:${g.color};"></span>
              <span>${M(g.data.date).format(r)}</span>
              <span style="float:right;margin-left:20px;font-weight:600">${g.value}</span>
            </div>
          `}),A}},ct={type:"category",data:O.xAxis,axisLabel:{formatter:h=>M(h).format(o),color:Ot},axisLine:{show:!1},axisTick:{show:!1}},ut={type:"value",show:!1},dt={type:"bar",data:O.previous},ft={type:"bar",data:O.current,barCategoryGap:30,markLine:{symbol:["none","none"],data:[{type:"average",x:S,lineStyle:{color:w,width:2,type:"solid"},emphasis:{disabled:!0},label:{show:!0,position:"insideStartTop",fontWeight:"bold",fontSize:12,formatter:h=>Number(h.value).toFixed(3)}},{type:"average",name:"Average",x:S,lineStyle:{color:"transparent"},label:{show:!0,position:"insideStartBottom",fontSize:12,formatter:"{b}",opacity:.8}}]}};e(3,L={backgroundColor:ot,grid:nt,tooltip:lt,xAxis:ct,yAxis:ut,series:[dt,ft]})},I=i=>{if(console.log("onChartClick",i),!i.data)return;const C=i.dataIndex;E({current:d.current[C],previous:d.previous[C]})};yt(()=>(_.on("click",I),console.log("EnergyOverviewChart - mounted",{chart:_}),()=>{_.off("click",I),console.log("EnergyOverviewChart - destroyed",{chart:_})}));function at(i){_=i,e(2,_)}return s.$$set=i=>{"unit"in i&&e(0,a=i.unit),"xAxisAttribute"in i&&e(6,c=i.xAxisAttribute),"yAxisAttribute"in i&&e(7,n=i.yAxisAttribute),"currentColor"in i&&e(1,x=i.currentColor),"previousColor"in i&&e(8,y=i.previousColor),"colorOpacity"in i&&e(9,l=i.colorOpacity),"backgroundColor"in i&&e(10,u=i.backgroundColor),"data"in i&&e(11,d=i.data),"onclick"in i&&e(12,E=i.onclick)},s.$$.update=()=>{s.$$.dirty&4034&&rt(d,c,n,x,y,l,u)},[a,x,_,L,r,o,c,n,y,l,u,d,E,at]}class Tt extends K{constructor(t){super(),X(this,t,Rt,It,H,{unit:0,tooltipDatetimeFormat:4,xAxisDatetimeFormat:5,xAxisAttribute:6,yAxisAttribute:7,currentColor:1,previousColor:8,colorOpacity:9,backgroundColor:10,data:11,onclick:12})}get tooltipDatetimeFormat(){return this.$$.ctx[4]}get xAxisDatetimeFormat(){return this.$$.ctx[5]}}function Ft(s){let t,e,a;return e=new Tt({props:{data:s[0],unit:"kWh",currentColor:St,onclick:s[1]}}),{c(){t=p("div"),et(e.$$.fragment),this.h()},l(r){t=b(r,"DIV",{class:!0});var o=v(t);tt(e.$$.fragment,o),o.forEach(f),this.h()},h(){m(t,"class","flex h-[360px] w-[550px]")},m(r,o){k(r,t,o),$(e,t,null),a=!0},p(r,[o]){const c={};o&1&&(c.data=r[0]),e.$set(c)},i(r){a||(Z(e.$$.fragment,r),a=!0)},o(r){Q(e.$$.fragment,r),a=!1},d(r){r&&f(t),J(e)}}}function Ut(s,t,e){let{data:a}=t;const r=o=>{console.log("DailyElectricityUsage.onChartClick dayUsage:",o)};return s.$$set=o=>{"data"in o&&e(0,a=o.data)},[a,r]}class zt extends K{constructor(t){super(),X(this,t,Ut,Ft,H,{data:0})}}export{zt as default};
