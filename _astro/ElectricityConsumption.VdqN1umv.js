import{S as se,i as le,s as ne,z,d as E,h as w,k as m,l as C,n as N,q as A,A as re,B as ie,C as F,w as oe,j as g,D as J,o as y,x as j,r as O,y as G,e as K,t as D,f as R,m as W,p as X,u as Y,F as ce,G as ue,H as Q,b as fe,c as de,g as _e}from"./ECharts.C5Iir41h.js";import{e as Z,u as ge,d as he,E as me,a as b,U as H,A as V}from"./EnergyChart.DeoKOa97.js";import{T as pe}from"./Toggle.DGDEntvT.js";import{c as B}from"./cn.BpZeWVFd.js";import{h as U,j as x,k as Ee,l as ve}from"./ChartLoadingSpinner.9-7-XflD.js";import"./dayjs.min.2rai63wT.js";import"./index.BAn-HqPX.js";function $(r,t,e){const s=r.slice();s[9]=t[e],s[12]=e;const c=s[9].disabled||s[2];return s[10]=c,s}function ee(r,t){let e,s,c,n=!1,a,l,i,h=t[9].label+"",d,_,f,v,I,k,L;return I=re(t[8][0]),{key:r,first:null,c(){e=A("label"),s=A("input"),l=O(),i=A("span"),d=G(h),f=O(),this.h()},l(p){e=C(p,"LABEL",{class:!0});var o=N(e);s=C(o,"INPUT",{class:!0,type:!0,name:!0}),l=y(o),i=C(o,"SPAN",{class:!0});var u=N(i);d=j(u,h),u.forEach(E),f=y(o),o.forEach(E),this.h()},h(){m(s,"class","peer hidden"),m(s,"type","radio"),m(s,"name",t[1]),s.__value=c=t[9].value,F(s,s.__value),s.disabled=a=t[10],m(i,"class",_=B(te,{"rounded-l-md":t[12]===0,"rounded-r-md":t[12]===t[4]})),m(e,"class",v=B("inline-flex items-center rounded-md text-gray-800",{"cursor-pointer":!t[10]})),I.p(s),this.first=e},m(p,o){w(p,e,o),g(e,s),s.checked=s.__value===t[0],g(e,l),g(e,i),g(i,d),g(e,f),k||(L=[J(s,"change",t[7]),J(s,"input",t[5])],k=!0)},p(p,o){t=p,o&2&&m(s,"name",t[1]),o&8&&c!==(c=t[9].value)&&(s.__value=c,F(s,s.__value),n=!0),o&12&&a!==(a=t[10])&&(s.disabled=a),(n||o&9)&&(s.checked=s.__value===t[0]),o&8&&h!==(h=t[9].label+"")&&oe(d,h),o&24&&_!==(_=B(te,{"rounded-l-md":t[12]===0,"rounded-r-md":t[12]===t[4]}))&&m(i,"class",_),o&12&&v!==(v=B("inline-flex items-center rounded-md text-gray-800",{"cursor-pointer":!t[10]}))&&m(e,"class",v)},d(p){p&&E(e),I.r(),k=!1,ie(L)}}}function be(r){let t,e=[],s=new Map,c=Z(r[3]);const n=a=>a[9].value;for(let a=0;a<c.length;a+=1){let l=$(r,c,a),i=n(l);s.set(i,e[a]=ee(i,l))}return{c(){t=A("div");for(let a=0;a<e.length;a+=1)e[a].c();this.h()},l(a){t=C(a,"DIV",{class:!0});var l=N(t);for(let i=0;i<e.length;i+=1)e[i].l(l);l.forEach(E),this.h()},h(){m(t,"class","flex items-center")},m(a,l){w(a,t,l);for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(t,null)},p(a,[l]){l&63&&(c=Z(a[3]),e=ge(e,l,n,1,a,c,s,t,he,ee,null,$))},i:z,o:z,d(a){a&&E(t);for(let l=0;l<e.length;l+=1)e[l].d()}}}const Ce=()=>{},te="bg-gray-300 px-4 py-1 peer-checked:bg-blue-300 peer-disabled:opacity-50";function Ae(r,t,e){let s,{name:c}=t,{selected:n}=t,{disabled:a=!1}=t,{list:l}=t,{onchange:i=Ce}=t;const h=f=>{i(f.target?.value)},d=[[]];function _(){n=this.__value,e(0,n)}return r.$$set=f=>{"name"in f&&e(1,c=f.name),"selected"in f&&e(0,n=f.selected),"disabled"in f&&e(2,a=f.disabled),"list"in f&&e(3,l=f.list),"onchange"in f&&e(6,i=f.onchange)},r.$$.update=()=>{r.$$.dirty&8&&e(4,s=l.length-1)},[n,c,a,l,s,h,i,_,d]}class Ie extends se{constructor(t){super(),le(this,t,Ae,be,ne,{name:1,selected:0,disabled:2,list:3,onchange:6})}}function ke(r){let t;return{c(){t=G("Electricity Consumption header actions")},l(e){t=j(e,"Electricity Consumption header actions")},m(e,s){w(e,t,s)},d(e){e&&E(t)}}}function ae(r){let t,e,s;function c(a){r[11](a)}let n={id:"showAverageToggle",label:"show average mark line"};return r[5]!==void 0&&(n.checked=r[5]),t=new pe({props:n}),fe.push(()=>de(t,"checked",c)),{c(){Y(t.$$.fragment)},l(a){X(t.$$.fragment,a)},m(a,l){W(t,a,l),s=!0},p(a,l){const i={};!e&&l&32&&(e=!0,i.checked=a[5],_e(()=>e=!1)),t.$set(i)},i(a){s||(R(t.$$.fragment,a),s=!0)},o(a){D(t.$$.fragment,a),s=!1},d(a){K(t,a)}}}function Te(r){let t,e,s,c,n="Consumption",a,l,i,h,d,_,f="Data started at:",v,I,k=x(r[6])+"",L,p;l=new Ie({props:{name:"buttons-toggle",selected:r[0],onchange:r[8],list:[{label:"Measured",value:b.PLAIN},{label:"Repartition",value:b.REPARTITION},{label:"Exceedance",value:b.EXCEEDANCE,disabled:!0}]}});let o=r[0]===b.PLAIN&&ae(r);return{c(){t=A("div"),e=A("div"),s=A("div"),c=A("span"),c.textContent=n,a=O(),Y(l.$$.fragment),i=O(),o&&o.c(),h=O(),d=A("div"),_=A("span"),_.textContent=f,v=O(),I=A("span"),L=G(k),this.h()},l(u){t=C(u,"DIV",{class:!0});var T=N(t);e=C(T,"DIV",{class:!0});var P=N(e);s=C(P,"DIV",{class:!0});var S=N(s);c=C(S,"SPAN",{"data-svelte-h":!0}),Q(c)!=="svelte-1vrp2az"&&(c.textContent=n),a=y(S),X(l.$$.fragment,S),S.forEach(E),i=y(P),o&&o.l(P),P.forEach(E),h=y(T),d=C(T,"DIV",{class:!0});var M=N(d);_=C(M,"SPAN",{"data-svelte-h":!0}),Q(_)!=="svelte-1cta1ja"&&(_.textContent=f),v=y(M),I=C(M,"SPAN",{class:!0});var q=N(I);L=j(q,k),q.forEach(E),M.forEach(E),T.forEach(E),this.h()},h(){m(s,"class","flex flex-col items-center gap-2 md:flex-row"),m(e,"class","flex flex-col items-center gap-4 lg:flex-row"),m(I,"class","font-semibold"),m(d,"class","flex items-center gap-1 text-sm"),m(t,"class","flex flex-col-reverse items-center gap-4 py-4 lg:flex-row lg:justify-between lg:gap-0 lg:py-2")},m(u,T){w(u,t,T),g(t,e),g(e,s),g(s,c),g(s,a),W(l,s,null),g(e,i),o&&o.m(e,null),g(t,h),g(t,d),g(d,_),g(d,v),g(d,I),g(I,L),p=!0},p(u,T){const P={};T&1&&(P.selected=u[0]),l.$set(P),u[0]===b.PLAIN?o?(o.p(u,T),T&1&&R(o,1)):(o=ae(u),o.c(),R(o,1),o.m(e,null)):o&&(ce(),D(o,1,1,()=>{o=null}),ue()),(!p||T&64)&&k!==(k=x(u[6])+"")&&oe(L,k)},i(u){p||(R(l.$$.fragment,u),R(o),p=!0)},o(u){D(l.$$.fragment,u),D(o),p=!1},d(u){u&&E(t),K(l),o&&o.d()}}}function Ne(r){let t,e,s,c;return s=new me({props:{type:r[0],color:r[1],labels:r[2],unit:r[3],aggregation:r[4],timeseries:r[7],showAverageMarkline:r[5],onclick:r[9],$$slots:{footer:[Te],headerActions:[ke]},$$scope:{ctx:r}}}),{c(){t=A("div"),e=A("div"),Y(s.$$.fragment),this.h()},l(n){t=C(n,"DIV",{class:!0});var a=N(t);e=C(a,"DIV",{class:!0});var l=N(e);X(s.$$.fragment,l),l.forEach(E),a.forEach(E),this.h()},h(){m(e,"class","absolute top-0 right-0 bottom-0 left-0"),m(t,"class","relative grow")},m(n,a){w(n,t,a),g(t,e),W(s,e,null),c=!0},p(n,[a]){const l={};a&1&&(l.type=n[0]),a&2&&(l.color=n[1]),a&4&&(l.labels=n[2]),a&8&&(l.unit=n[3]),a&16&&(l.aggregation=n[4]),a&128&&(l.timeseries=n[7]),a&32&&(l.showAverageMarkline=n[5]),a&65633&&(l.$$scope={dirty:a,ctx:n}),s.$set(l)},i(n){c||(R(s.$$.fragment,n),c=!0)},o(n){D(s.$$.fragment,n),c=!1},d(n){n&&E(t),K(s)}}}function Le(r,t,e){const s={[`${b.PLAIN}`]:["Consumption","Exceedance"],[`${b.PLAIN}_EXCEEDANCE`]:["Consumption","Exceedance"],[`${b.REPARTITION}`]:["Shared with me","Bought from market"]},c={[`${b.PLAIN}`]:[U],[`${b.PLAIN}_EXCEEDANCE`]:[U,ve],[`${b.REPARTITION}`]:[Ee,U]};let n=b.PLAIN,a=[U],l=["Consumption","Exceedance"],i=H.KWH,h=V.MONTH,d=!1,_,f=[],{data:v}=t;const I=u=>{e(0,n=b.PLAIN),e(3,i=H.KWH),e(4,h=V.MONTH),e(7,f=u.months.plain),e(6,_=f[0].startedAt),e(1,a=c[n]),e(2,l=s[n])},k=u=>{e(0,n=u),e(5,d=!1),L()},L=()=>{e(3,i=h===V.MINUTES?H.KW:H.KWH),e(7,f=v.months[n===b.REPARTITION?"repartition":"plain"]),e(6,_=f[0].startedAt),e(1,a=c[n]),e(2,l=s[n]),console.log("ElectricityConsumption.updateTimeseries",{type:n,aggregation:h,color:a,labels:l,data:v})},p=u=>{console.log("ElectricityConsumption.onChartClick timeserie:",u)};function o(u){d=u,e(5,d)}return r.$$set=u=>{"data"in u&&e(10,v=u.data)},r.$$.update=()=>{r.$$.dirty&1024&&I(v)},[n,a,l,i,h,d,_,f,k,p,v,o]}class Me extends se{constructor(t){super(),le(this,t,Le,Ne,ne,{data:10})}}export{Me as default};
