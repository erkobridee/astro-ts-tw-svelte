import{S as X,i as v,s as x,d as P,c as V,t as H,e as L,g as Q,h as T,m as j,j as y,k as C,l as D,n as q,p as N,q as B,u as $,v as ee,w as z,o as W,x as te,r as U,y as se,b as oe,a as re,f as ae,z as ne}from"./ECharts.6qOP-yiC.js";import{d as Z}from"./dayjs.min.2rai63wT.js";import{E as le,a as O,U as Y,A as p,b as M,c as ce,d as fe}from"./AggregationLevelSelection.UtbQPP1s.js";import{T as ge}from"./Toggle.C1ZBg3Cm.js";import{B as ue}from"./ButtonsToggle.CvNpljYN.js";import{a as pe,b as F,f as G,c as K}from"./ChartLoadingSpinner.DDnJmpK1.js";import"./index.Bn5gjWO9.js";function me(n){let t,e;return t=new ce({props:{aggregation:n[4],energyType:fe.ELECTRICITY,layout:n[5],onclick:n[11]}}),{c(){B(t.$$.fragment)},l(o){q(t.$$.fragment,o)},m(o,f){j(t,o,f),e=!0},p(o,f){const s={};f&16&&(s.aggregation=o[4]),f&32&&(s.layout=o[5]),t.$set(s)},i(o){e||(L(t.$$.fragment,o),e=!0)},o(o){H(t.$$.fragment,o),e=!1},d(o){V(t,o)}}}function J(n){let t,e,o;function f(r){n[14](r)}let s={id:"showAverageToggle",label:"show average mark line"};return n[6]!==void 0&&(s.checked=n[6]),t=new ge({props:s}),oe.push(()=>re(t,"checked",f)),{c(){B(t.$$.fragment)},l(r){q(t.$$.fragment,r)},m(r,a){j(t,r,a),o=!0},p(r,a){const d={};!e&&a&64&&(e=!0,d.checked=r[6],ae(()=>e=!1)),t.$set(d)},i(r){o||(L(t.$$.fragment,r),o=!0)},o(r){H(t.$$.fragment,r),o=!1},d(r){V(t,r)}}}function he(n){let t,e,o,f,s="Production",r,a,d,m,h,w,k="Data started at:",c,I,u=G(n[7])+"",S,i;a=new ue({props:{name:"buttons-toggle",selected:n[0],onchange:n[10],list:[{label:"Measured",value:O.PLAIN},{label:"Repartition",value:O.REPARTITION}]}});let g=n[0]===O.PLAIN&&J(n);return{c(){t=N("div"),e=N("div"),o=N("div"),f=N("span"),f.textContent=s,r=U(),B(a.$$.fragment),d=U(),g&&g.c(),m=U(),h=N("div"),w=N("span"),w.textContent=k,c=U(),I=N("span"),S=se(u),this.h()},l(_){t=C(_,"DIV",{class:!0});var b=D(t);e=C(b,"DIV",{class:!0});var R=D(e);o=C(R,"DIV",{class:!0});var l=D(o);f=C(l,"SPAN",{"data-svelte-h":!0}),z(f)!=="svelte-1quta9p"&&(f.textContent=s),r=W(l),q(a.$$.fragment,l),l.forEach(P),d=W(R),g&&g.l(R),R.forEach(P),m=W(b),h=C(b,"DIV",{class:!0});var E=D(h);w=C(E,"SPAN",{"data-svelte-h":!0}),z(w)!=="svelte-1cta1ja"&&(w.textContent=k),c=W(E),I=C(E,"SPAN",{class:!0});var A=D(I);S=te(A,u),A.forEach(P),E.forEach(P),b.forEach(P),this.h()},h(){y(o,"class","flex flex-col items-center gap-2 md:flex-row"),y(e,"class","flex flex-col items-center gap-4 lg:flex-row"),y(I,"class","font-semibold"),y(h,"class","flex items-center gap-1 text-sm"),y(t,"class","flex flex-col-reverse items-center gap-4 py-4 lg:flex-row lg:justify-between lg:gap-0 lg:py-2")},m(_,b){Q(_,t,b),T(t,e),T(e,o),T(o,f),T(o,r),j(a,o,null),T(e,d),g&&g.m(e,null),T(t,m),T(t,h),T(h,w),T(h,c),T(h,I),T(I,S),i=!0},p(_,b){const R={};b&1&&(R.selected=_[0]),a.$set(R),_[0]===O.PLAIN?g?(g.p(_,b),b&1&&L(g,1)):(g=J(_),g.c(),L(g,1),g.m(e,null)):g&&(ne(),H(g,1,1,()=>{g=null}),$()),(!i||b&128)&&u!==(u=G(_[7])+"")&&ee(S,u)},i(_){i||(L(a.$$.fragment,_),L(g),i=!0)},o(_){H(a.$$.fragment,_),H(g),i=!1},d(_){_&&P(t),V(a),g&&g.d()}}}function ie(n){let t,e,o,f;return o=new le({props:{type:n[0],color:n[1],labels:n[2],unit:n[3],aggregation:n[4],timeseries:n[8],dataZoomOptions:n[9],showAverageMarkline:n[6],onclick:n[12],$$slots:{footer:[he],headerActions:[me]},$$scope:{ctx:n}}}),{c(){t=N("div"),e=N("div"),B(o.$$.fragment),this.h()},l(s){t=C(s,"DIV",{class:!0});var r=D(t);e=C(r,"DIV",{class:!0});var a=D(e);q(o.$$.fragment,a),a.forEach(P),r.forEach(P),this.h()},h(){y(e,"class","absolute top-0 right-0 bottom-0 left-0"),y(t,"class","relative grow")},m(s,r){Q(s,t,r),T(t,e),j(o,e,null),f=!0},p(s,[r]){const a={};r&1&&(a.type=s[0]),r&2&&(a.color=s[1]),r&4&&(a.labels=s[2]),r&8&&(a.unit=s[3]),r&16&&(a.aggregation=s[4]),r&256&&(a.timeseries=s[8]),r&512&&(a.dataZoomOptions=s[9]),r&64&&(a.showAverageMarkline=s[6]),r&524529&&(a.$$scope={dirty:r,ctx:s}),o.$set(a)},i(s){f||(L(o.$$.fragment,s),f=!0)},o(s){H(o.$$.fragment,s),f=!1},d(s){s&&P(t),V(o)}}}function _e(n,t,e){const o={[`${O.PLAIN}`]:["Production"],[`${O.REPARTITION}`]:["I shared","I sold to market"]},f={[`${O.PLAIN}`]:[F],[`${O.REPARTITION}`]:[pe,F]};let s=O.PLAIN,r=f[s],a=o[s],d=Y.KWH,m=p.MONTH,h=M.YEAR,w=!1,k,c=[],I={showAll:!1},{data:u}=t;const S=l=>{e(0,s=O.PLAIN),e(3,d=Y.KWH),e(4,m=p.MONTH),e(5,h=M.YEAR),e(8,c=l.months.plain),e(7,k=c[0].startedAt),e(1,r=f[s]),e(2,a=o[s]),e(9,I={showAll:!1}),console.log("ElectricityProduction.onData",l)},i=l=>{const E=s===O.REPARTITION?"repartition":"plain";return l[E]},g=l=>{e(0,s=l),e(3,d=Y.KWH),e(6,w=!1),e(4,m=p.MONTH),e(5,h=M.YEAR),e(8,c=i(u.months)),e(7,k=c[0].startedAt),e(1,r=f[s]),e(2,a=o[s])},_=(l,E)=>{if(e(3,d=Y.KWH),e(9,I={showAll:!1}),E===M.YEAR){switch(l){case p.MONTH:e(8,c=i(u.months));break;case p.WEEK:e(8,c=i(u.weeks));break}e(7,k=c[0].startedAt),e(4,m=l),e(5,h=E);return}let A=K(Z(k).startOf("month"));switch(l){case p.WEEK:e(8,c=i(u.weeksMap[A]));break;case p.DAY:e(8,c=i(u.daysMap[A]));break;case p.HOUR:A=K(k),e(8,c=i(u.hoursMap[A])),e(9,I={showAll:!0});break}e(7,k=c[0].startedAt),e(4,m=l),e(5,h=E)},b=l=>{const{startedAt:E}=l;let A=K(E);if(console.log("ElectricityProduction.onChartClick timeserie",l),e(9,I={showAll:!1}),h===M.YEAR){switch(m){case p.MONTH:e(4,m=p.WEEK),e(8,c=i(u.weeksMap[A]));break;case p.WEEK:A=K(Z(E).startOf("month")),e(4,m=p.DAY),e(8,c=i(u.daysMap[A]));break}e(7,k=c[0].startedAt),e(5,h=M.MONTH);return}switch(m){case p.WEEK:A=K(Z(E).startOf("month")),e(4,m=p.DAY),e(8,c=i(u.daysMap[A]));break;case p.DAY:e(4,m=p.HOUR),e(8,c=i(u.hoursMap[A]));break;case p.HOUR:e(4,m=p.MINUTES),e(8,c=i(u.minutesMap[A])),e(3,d=Y.KW);break}e(7,k=c[0].startedAt),[p.HOUR,p.MINUTES].includes(m)&&(e(5,h=M.DAY),e(9,I={showAll:!0}))};function R(l){w=l,e(6,w)}return n.$$set=l=>{"data"in l&&e(13,u=l.data)},n.$$.update=()=>{n.$$.dirty&8192&&S(u)},[s,r,a,d,m,h,w,k,c,I,g,_,b,u,R]}class we extends X{constructor(t){super(),v(this,t,_e,ie,x,{data:13})}}export{we as default};
