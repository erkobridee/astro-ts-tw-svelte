import{S as ce,i as fe,s as ue,E as Be,a as Ve,b as We,c as He,e as q,t as L,f as A,g as Ke,m as z,p as G,u as J,v as je,z as de,d as v,w as ne,A as Ee,h as j,j as k,k as M,l as C,n as w,x as se,o as B,q as F,y as oe,r as V,B as Fe,C as le,D as re,F as Te,G as pe,H as Se,I as Ye,J as be}from"./ECharts.BSvq92Jr.js";import"./dayjs.min.Cbbdfn5l.js";import{m as qe,C as K,c as ze,g as Y,n as ae,L as ie,o as De,d as Ae,p as Oe,q as Ge,k as Je,r as ke,s as Xe,t as Qe,f as Ze}from"./ChartLoadingSpinner.B7W4dR_p.js";import"./index.CV-e_qxF.js";const Q={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},p={DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""};function xe(n){let e,a;return e=new ze({props:{color:n[2]}}),{c(){J(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,l){z(e,t,l),a=!0},p(t,l){const s={};l&4&&(s.color=t[2]),e.$set(s)},i(t){a||(A(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){q(e,t)}}}function $e(n){let e,a,t;function l(o){n[5](o)}let s={init:Ve,options:n[1],notMerge:!0,$$slots:{default:[xe]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.chart=n[0]),e=new Be({props:s}),We.push(()=>He(e,"chart",l)),{c(){J(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,r){z(e,o,r),t=!0},p(o,[r]){const i={};r&2&&(i.options=o[1]),r&132&&(i.$$scope={dirty:r,ctx:o}),!a&&r&1&&(a=!0,i.chart=o[0],Ke(()=>a=!1)),e.$set(i)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){q(e,o)}}}const et=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const l=n[t],s=l.stack;if(!s)continue;e[s]||(e[s]={stackStart:[],stackEnd:[]});const o=e[s],r=l.data[a];r&&!isNaN(r)&&(o.stackStart[a]==null&&(o.stackStart[a]=t),o.stackEnd[a]=t)}return e},tt=n=>{const e=et(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=De(Ae);continue}const l=t.data,s=l.length,o=e[t.stack];for(let r=0;r<s;++r){const i=o.stackEnd[r]===a;l[r]={value:l[r],itemStyle:De(i?Ae:0)}}}return n};function at(n,e,a){let t,{chartOptions:l}=e,{onclick:s=qe}=e,o,r={};const i=u=>{const{color:h,categories:c,series:N,xAxisLabelFormatter:g,yAxisLabelFormatter:m=P=>Y(P),tooltipFormatter:_}=u;console.log(u);const d={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:_},I={containLabel:!0,left:10,right:10,top:10,bottom:10},E=c.length,R={type:"category",data:c,axisLabel:{color:ie,formatter:g,showMinLabel:E<50},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:ae},splitLine:{show:!0,lineStyle:ae,showMinLine:!1,showMaxLine:!1,interval:E>50?10:2}};a(1,r={color:h,tooltip:d,grid:I,xAxis:R,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:ie,showMinLabel:!1,showMaxLabel:!1,formatter:m},splitLine:{lineStyle:ae,showMaxLine:!1}},series:tt(N)})};je(()=>(o.on("click",s),console.log("BaseColumnsChart - mounted",{chart:o}),()=>{o.off("click",s),console.log("BaseColumnsChart - destroyed",{chart:o})}));function b(u){o=u,a(0,o)}return n.$$set=u=>{"chartOptions"in u&&a(3,l=u.chartOptions),"onclick"in u&&a(4,s=u.onclick)},n.$$.update=()=>{n.$$.dirty&8&&a(2,t=l.color[0]??K),n.$$.dirty&8&&i(l)},[o,r,t,l,s,b]}class nt extends ce{constructor(e){super(),fe(this,e,at,$e,ue,{chartOptions:3,onclick:4})}}function ve(n){let e,a;return{c(){e=F("span"),a=oe(n[3])},l(t){e=C(t,"SPAN",{});var l=w(e);a=se(l,n[3]),l.forEach(v)},m(t,l){j(t,e,l),k(e,a)},p(t,l){l&8&&ne(a,t[3])},d(t){t&&v(e)}}}function st(n){let e,a,t,l,s,o,r=Y(n[1],n[4])+"",i,b,u=n[3]&&ve(n);return{c(){e=F("div"),a=F("span"),t=oe(n[0]),l=V(),s=F("div"),o=F("span"),i=oe(r),b=V(),u&&u.c(),this.h()},l(h){e=C(h,"DIV",{class:!0});var c=w(e);a=C(c,"SPAN",{});var N=w(a);t=se(N,n[0]),N.forEach(v),l=B(c),s=C(c,"DIV",{class:!0,style:!0});var g=w(s);o=C(g,"SPAN",{class:!0});var m=w(o);i=se(m,r),m.forEach(v),b=B(g),u&&u.l(g),g.forEach(v),c.forEach(v),this.h()},h(){M(o,"class","text-sm tabular-nums"),M(s,"class","text-sm font-semibold"),Ee(s,"color",n[2]),M(e,"class","flex items-center gap-2")},m(h,c){j(h,e,c),k(e,a),k(a,t),k(e,l),k(e,s),k(s,o),k(o,i),k(s,b),u&&u.m(s,null)},p(h,[c]){c&1&&ne(t,h[0]),c&18&&r!==(r=Y(h[1],h[4])+"")&&ne(i,r),h[3]?u?u.p(h,c):(u=ve(h),u.c(),u.m(s,null)):u&&(u.d(1),u=null),c&4&&Ee(s,"color",h[2])},i:de,o:de,d(h){h&&v(e),u&&u.d()}}}function ot(n,e,a){let{label:t}=e,{value:l}=e,{valueColor:s=ie}=e,{unit:o}=e,{maximumFractionDigits:r=Oe}=e;return n.$$set=i=>{"label"in i&&a(0,t=i.label),"value"in i&&a(1,l=i.value),"valueColor"in i&&a(2,s=i.valueColor),"unit"in i&&a(3,o=i.unit),"maximumFractionDigits"in i&&a(4,r=i.maximumFractionDigits)},[t,l,s,o,r]}class Me extends ce{constructor(e){super(),fe(this,e,ot,st,ue,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const lt=n=>({}),Ie=n=>({}),rt=n=>({}),Le=n=>({});function Ne(n){let e,a,t,l;e=new Me({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let s=n[3][1]&&ye(n);return{c(){J(e.$$.fragment),a=V(),s&&s.c(),t=be()},l(o){G(e.$$.fragment,o),a=B(o),s&&s.l(o),t=be()},m(o,r){z(e,o,r),j(o,a,r),s&&s.m(o,r),j(o,t,r),l=!0},p(o,r){const i={};r&8&&(i.value=o[3][0]),r&1&&(i.unit=o[0]),r&2&&(i.maximumFractionDigits=o[1]),e.$set(i),o[3][1]?s?(s.p(o,r),r&8&&A(s,1)):(s=ye(o),s.c(),A(s,1),s.m(t.parentNode,t)):s&&(le(),L(s,1,1,()=>{s=null}),re())},i(o){l||(A(e.$$.fragment,o),A(s),l=!0)},o(o){L(e.$$.fragment,o),L(s),l=!1},d(o){o&&(v(a),v(t)),q(e,o),s&&s.d(o)}}}function ye(n){let e,a;return e=new Me({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){J(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,l){z(e,t,l),a=!0},p(t,l){const s={};l&8&&(s.value=t[3][1]),l&1&&(s.unit=t[0]),l&2&&(s.maximumFractionDigits=t[1]),e.$set(s)},i(t){a||(A(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){q(e,t)}}}function Ce(n){let e;const a=n[18].footer,t=Fe(a,n,n[17],Ie);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&131072)&&Te(t,a,l,l[17],e?Se(a,l[17],s,lt):pe(l[17]),Ie)},i(l){e||(A(t,l),e=!0)},o(l){L(t,l),e=!1},d(l){t&&t.d(l)}}}function it(n){let e,a,t,l,s,o,r,i,b,u,h,c=n[2].length>0&&Ne(n);const N=n[18].headerActions,g=Fe(N,n,n[17],Le);b=new nt({props:{chartOptions:n[4],onclick:n[7]}});let m=n[8].footer&&Ce(n);return{c(){e=F("div"),a=F("div"),t=F("div"),c&&c.c(),l=V(),s=F("div"),g&&g.c(),o=V(),r=F("div"),i=F("div"),J(b.$$.fragment),u=V(),m&&m.c(),this.h()},l(_){e=C(_,"DIV",{class:!0});var d=w(e);a=C(d,"DIV",{class:!0});var I=w(a);t=C(I,"DIV",{class:!0});var E=w(t);c&&c.l(E),E.forEach(v),l=B(I),s=C(I,"DIV",{});var R=w(s);g&&g.l(R),R.forEach(v),I.forEach(v),o=B(d),r=C(d,"DIV",{class:!0});var W=w(r);i=C(W,"DIV",{class:!0});var P=w(i);G(b.$$.fragment,P),P.forEach(v),W.forEach(v),u=B(d),m&&m.l(d),d.forEach(v),this.h()},h(){M(t,"class","flex items-center gap-4"),M(a,"class","flex items-center justify-between"),M(i,"class","absolute top-0 right-0 bottom-0 left-0"),M(r,"class","relative grow"),M(e,"class","flex h-full grow flex-col gap-2")},m(_,d){j(_,e,d),k(e,a),k(a,t),c&&c.m(t,null),k(a,l),k(a,s),g&&g.m(s,null),k(e,o),k(e,r),k(r,i),z(b,i,null),k(e,u),m&&m.m(e,null),h=!0},p(_,[d]){_[2].length>0?c?(c.p(_,d),d&4&&A(c,1)):(c=Ne(_),c.c(),A(c,1),c.m(t,null)):c&&(le(),L(c,1,1,()=>{c=null}),re()),g&&g.p&&(!h||d&131072)&&Te(g,N,_,_[17],h?Se(N,_[17],d,rt):pe(_[17]),Le);const I={};d&16&&(I.chartOptions=_[4]),b.$set(I),_[8].footer?m?(m.p(_,d),d&256&&A(m,1)):(m=Ce(_),m.c(),A(m,1),m.m(e,null)):m&&(le(),L(m,1,1,()=>{m=null}),re())},i(_){h||(A(c),A(g,_),A(b.$$.fragment,_),A(m),h=!0)},o(_){L(c),L(g,_),L(b.$$.fragment,_),L(m),h=!1},d(_){_&&v(e),c&&c.d(),g&&g.d(_),q(b),m&&m.d()}}}const we={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function ct(n,e,a){let{$$slots:t={},$$scope:l}=e;const s=Ye(t);let{type:o=we.PLAIN}=e,{showAverageMarkline:r=!1}=e,{unit:i=Q.UNDEFINED}=e,{aggregation:b=p.UNDEFINED}=e,{maximumFractionDigits:u=Oe}=e,{color:h=K}=e,{timeseries:c=[]}=e,{referencePower:N=void 0}=e,{referencePowerOptions:g=Ge}=e,{labels:m=["Consumption","Exceedance"]}=e,{onclick:_=Je}=e,d=!1,I=[0,NaN],E={color:[],categories:[],series:[]};const R=(f,S,Z,x,$,ee,X,me,Pe)=>{d=W(Z,x);const he=!!me,_e=f===we.REPARTITION;let te=0,ge=0;const H=X.reduce((D,T)=>{const{startedAt:U,value:y=NaN,anotherValue:O=NaN}=T;return te+=y??0,ge+=O??0,D.startedAtData.push(U),_e?(D.valueData.push(y),D.anotherValueData.push(O),D):(D.valueData.push(y),D)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,E.color=Array.isArray(ee)?ee:[ee],E),a(4,E.categories=H.startedAtData,E),_e||he){a(3,I=[te,ge]);const D={type:"bar",stack:"energy",data:H.valueData},T={type:"bar",stack:"energy",data:H.anotherValueData};a(4,E.series=[D,T],E)}else{a(3,I=[te,NaN]);const D={type:"bar",data:H.valueData};a(4,E.series=[D],E)}E.series.forEach(D=>{if(S){let T=D.markLine;const U={type:"average",label:{fontWeight:"bold",formatter:y=>Y(y.value,$)}};if(T){const{symbol:y=ke,data:O=[]}=T;D.markLine={symbol:y,data:[...O,U]}}else D.markLine={symbol:ke,data:[U]}}}),console.log("EnergyChart.updateChartOptions",{type:f,showAverageMarkline:S,unit:Z,aggregation:x,maximumFractionDigits:$,timeseries:X,isDrilldownEnabled:d,hasReferencePower:he,referencePower:me,referencePowerOptions:Pe,data:H}),[p.DAY,p.HOUR,p.MINUTES].includes(x)&&(a(4,E.xAxisLabelFormatter=Xe,E),a(4,E.tooltipFormatter=D=>{const T=D;let U=X[T[0].dataIndex],y="";return y+=`<div>${Qe(U.startedAt)}</div>`,T.forEach(O=>{U=X[O.dataIndex],y+=Ze({color:O.color,value:`${Y(O.value,$)} ${Z}`})}),y},E))},W=(f,S)=>{switch(f){case Q.M3:return![p.HOUR,p.MINUTES,p.UNDEFINED].includes(S);case Q.KW:case Q.KWH:return![p.MINUTES,p.UNDEFINED].includes(S);default:return!1}},P=(f=0)=>Array.isArray(m)?m[f]??"":m,Ue=(f=0)=>{let S=K;return h&&(S=Array.isArray(h)?h[f]??K:f===0?h:K),S},Re=f=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:d,event:f}),f.data&&_(c[f.dataIndex])};return n.$$set=f=>{"type"in f&&a(9,o=f.type),"showAverageMarkline"in f&&a(10,r=f.showAverageMarkline),"unit"in f&&a(0,i=f.unit),"aggregation"in f&&a(11,b=f.aggregation),"maximumFractionDigits"in f&&a(1,u=f.maximumFractionDigits),"color"in f&&a(12,h=f.color),"timeseries"in f&&a(2,c=f.timeseries),"referencePower"in f&&a(13,N=f.referencePower),"referencePowerOptions"in f&&a(14,g=f.referencePowerOptions),"labels"in f&&a(15,m=f.labels),"onclick"in f&&a(16,_=f.onclick),"$$scope"in f&&a(17,l=f.$$scope)},n.$$.update=()=>{n.$$.dirty&32263&&R(o,r,i,b,u,h,c,N,g)},[i,u,c,I,E,P,Ue,Re,s,o,r,b,h,N,g,m,_,l,t]}class _t extends ce{constructor(e){super(),fe(this,e,ct,it,ue,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{p as A,_t as E,Q as U};
