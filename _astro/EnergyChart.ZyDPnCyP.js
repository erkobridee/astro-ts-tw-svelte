import{S as ie,i as re,s as ce,E as Ue,a as Pe,b as Ve,c as Be,e as W,t as k,f as b,g as He,m as K,p as Y,u as j,v as We,z as ge,d as I,w as ee,A as De,h as H,j as A,k as F,l as p,n as y,x as te,o as M,q as C,y as ae,r as U,B as Le,C as ne,D as se,F as we,G as Fe,H as Te,I as Ke,J as Ee}from"./ECharts.BfJ7rUUm.js";import{d as Oe}from"./dayjs.min.Cbbdfn5l.js";import{j as Ye,C as B,c as je,k as $,L as oe,l as be,d as Ae,m as qe,i as ze}from"./ChartLoadingSpinner.ik7wbbNy.js";import"./index.DgoW5roq.js";const fe=3,le=(n,e=fe,a=navigator?.language)=>new Intl.NumberFormat(a,{maximumFractionDigits:e}).format(n),Ge="DD.MM.YYYY",Je="HH:mm",Xe="dd HH:mm",Qe=n=>Oe(n).format(`${Ge}, ${Je}`),Ze=n=>Oe(n).format(Xe),X={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},w={DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""};function xe(n){let e,a;return e=new je({props:{color:n[2]}}),{c(){j(e.$$.fragment)},l(t){Y(e.$$.fragment,t)},m(t,l){K(e,t,l),a=!0},p(t,l){const s={};l&4&&(s.color=t[2]),e.$set(s)},i(t){a||(b(e.$$.fragment,t),a=!0)},o(t){k(e.$$.fragment,t),a=!1},d(t){W(e,t)}}}function $e(n){let e,a,t;function l(o){n[5](o)}let s={init:Pe,options:n[1],notMerge:!0,$$slots:{default:[xe]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.chart=n[0]),e=new Ue({props:s}),Ve.push(()=>Be(e,"chart",l)),{c(){j(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,i){K(e,o,i),t=!0},p(o,[i]){const r={};i&2&&(r.options=o[1]),i&132&&(r.$$scope={dirty:i,ctx:o}),!a&&i&1&&(a=!0,r.chart=o[0],He(()=>a=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){k(e.$$.fragment,o),t=!1},d(o){W(e,o)}}}const et=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const l=n[t],s=l.stack;if(!s)continue;e[s]||(e[s]={stackStart:[],stackEnd:[]});const o=e[s],i=l.data[a];i&&!isNaN(i)&&(o.stackStart[a]==null&&(o.stackStart[a]=t),o.stackEnd[a]=t)}return e},tt=n=>{const e=et(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=be(Ae);continue}const l=t.data,s=l.length,o=e[t.stack];for(let i=0;i<s;++i){const r=o.stackEnd[i]===a;l[i]={value:l[i],itemStyle:be(r?Ae:0)}}}return n};function at(n,e,a){let t,{chartOptions:l}=e,{onclick:s=Ye}=e,o,i={};const r=f=>{const{color:_,categories:c,series:v,xAxisLabelFormatter:d,tooltipFormatter:h}=f;console.log(f);const m={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:h},D={containLabel:!0,left:10,right:10,top:10,bottom:10},g=c.length,O={type:"category",data:c,axisLabel:{color:oe,formatter:d,showMinLabel:g<50},axisTick:{show:!0,alignWithLabel:!0},axisLine:{lineStyle:$},splitLine:{show:!0,lineStyle:$,showMinLine:!1,showMaxLine:!1,interval:g>50?10:2}};a(1,i={color:_,tooltip:m,grid:D,xAxis:O,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:oe,showMinLabel:!1,showMaxLabel:!1},splitLine:{lineStyle:$,showMaxLine:!1}},series:tt(v)})};We(()=>(o.on("click",s),console.log("BaseColumnsChart - mounted",{chart:o}),()=>{o.off("click",s),console.log("BaseColumnsChart - destroyed",{chart:o})}));function E(f){o=f,a(0,o)}return n.$$set=f=>{"chartOptions"in f&&a(3,l=f.chartOptions),"onclick"in f&&a(4,s=f.onclick)},n.$$.update=()=>{n.$$.dirty&8&&a(2,t=l.color[0]??B),n.$$.dirty&8&&r(l)},[o,i,t,l,s,E]}class nt extends ie{constructor(e){super(),re(this,e,at,$e,ce,{chartOptions:3,onclick:4})}}function Ie(n){let e,a;return{c(){e=C("span"),a=ae(n[3])},l(t){e=p(t,"SPAN",{});var l=y(e);a=te(l,n[3]),l.forEach(I)},m(t,l){H(t,e,l),A(e,a)},p(t,l){l&8&&ee(a,t[3])},d(t){t&&I(e)}}}function st(n){let e,a,t,l,s,o,i=le(n[1],n[4])+"",r,E,f=n[3]&&Ie(n);return{c(){e=C("div"),a=C("span"),t=ae(n[0]),l=U(),s=C("div"),o=C("span"),r=ae(i),E=U(),f&&f.c(),this.h()},l(_){e=p(_,"DIV",{class:!0});var c=y(e);a=p(c,"SPAN",{});var v=y(a);t=te(v,n[0]),v.forEach(I),l=M(c),s=p(c,"DIV",{class:!0,style:!0});var d=y(s);o=p(d,"SPAN",{class:!0});var h=y(o);r=te(h,i),h.forEach(I),E=M(d),f&&f.l(d),d.forEach(I),c.forEach(I),this.h()},h(){F(o,"class","text-sm tabular-nums"),F(s,"class","text-sm font-semibold"),De(s,"color",n[2]),F(e,"class","flex items-center gap-2")},m(_,c){H(_,e,c),A(e,a),A(a,t),A(e,l),A(e,s),A(s,o),A(o,r),A(s,E),f&&f.m(s,null)},p(_,[c]){c&1&&ee(t,_[0]),c&18&&i!==(i=le(_[1],_[4])+"")&&ee(r,i),_[3]?f?f.p(_,c):(f=Ie(_),f.c(),f.m(s,null)):f&&(f.d(1),f=null),c&4&&De(s,"color",_[2])},i:ge,o:ge,d(_){_&&I(e),f&&f.d()}}}function ot(n,e,a){let{label:t}=e,{value:l}=e,{valueColor:s=oe}=e,{unit:o}=e,{maximumFractionDigits:i=fe}=e;return n.$$set=r=>{"label"in r&&a(0,t=r.label),"value"in r&&a(1,l=r.value),"valueColor"in r&&a(2,s=r.valueColor),"unit"in r&&a(3,o=r.unit),"maximumFractionDigits"in r&&a(4,i=r.maximumFractionDigits)},[t,l,s,o,i]}class Se extends ie{constructor(e){super(),re(this,e,ot,st,ce,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const lt=n=>({}),ke=n=>({}),it=n=>({}),ve=n=>({});function Ne(n){let e,a,t,l;e=new Se({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let s=n[3][1]&&pe(n);return{c(){j(e.$$.fragment),a=U(),s&&s.c(),t=Ee()},l(o){Y(e.$$.fragment,o),a=M(o),s&&s.l(o),t=Ee()},m(o,i){K(e,o,i),H(o,a,i),s&&s.m(o,i),H(o,t,i),l=!0},p(o,i){const r={};i&8&&(r.value=o[3][0]),i&1&&(r.unit=o[0]),i&2&&(r.maximumFractionDigits=o[1]),e.$set(r),o[3][1]?s?(s.p(o,i),i&8&&b(s,1)):(s=pe(o),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(ne(),k(s,1,1,()=>{s=null}),se())},i(o){l||(b(e.$$.fragment,o),b(s),l=!0)},o(o){k(e.$$.fragment,o),k(s),l=!1},d(o){o&&(I(a),I(t)),W(e,o),s&&s.d(o)}}}function pe(n){let e,a;return e=new Se({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){j(e.$$.fragment)},l(t){Y(e.$$.fragment,t)},m(t,l){K(e,t,l),a=!0},p(t,l){const s={};l&8&&(s.value=t[3][1]),l&1&&(s.unit=t[0]),l&2&&(s.maximumFractionDigits=t[1]),e.$set(s)},i(t){a||(b(e.$$.fragment,t),a=!0)},o(t){k(e.$$.fragment,t),a=!1},d(t){W(e,t)}}}function ye(n){let e;const a=n[17].footer,t=Le(a,n,n[16],ke);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&65536)&&we(t,a,l,l[16],e?Te(a,l[16],s,lt):Fe(l[16]),ke)},i(l){e||(b(t,l),e=!0)},o(l){k(t,l),e=!1},d(l){t&&t.d(l)}}}function rt(n){let e,a,t,l,s,o,i,r,E,f,_,c=n[2].length>0&&Ne(n);const v=n[17].headerActions,d=Le(v,n,n[16],ve);E=new nt({props:{chartOptions:n[4],onclick:n[7]}});let h=n[8].footer&&ye(n);return{c(){e=C("div"),a=C("div"),t=C("div"),c&&c.c(),l=U(),s=C("div"),d&&d.c(),o=U(),i=C("div"),r=C("div"),j(E.$$.fragment),f=U(),h&&h.c(),this.h()},l(m){e=p(m,"DIV",{class:!0});var D=y(e);a=p(D,"DIV",{class:!0});var g=y(a);t=p(g,"DIV",{class:!0});var O=y(t);c&&c.l(O),O.forEach(I),l=M(g),s=p(g,"DIV",{});var P=y(s);d&&d.l(P),P.forEach(I),g.forEach(I),o=M(D),i=p(D,"DIV",{class:!0});var q=y(i);r=p(q,"DIV",{class:!0});var z=y(r);Y(E.$$.fragment,z),z.forEach(I),q.forEach(I),f=M(D),h&&h.l(D),D.forEach(I),this.h()},h(){F(t,"class","flex items-center gap-4"),F(a,"class","flex items-center justify-between"),F(r,"class","absolute top-0 right-0 bottom-0 left-0"),F(i,"class","relative grow"),F(e,"class","flex h-full grow flex-col gap-2")},m(m,D){H(m,e,D),A(e,a),A(a,t),c&&c.m(t,null),A(a,l),A(a,s),d&&d.m(s,null),A(e,o),A(e,i),A(i,r),K(E,r,null),A(e,f),h&&h.m(e,null),_=!0},p(m,[D]){m[2].length>0?c?(c.p(m,D),D&4&&b(c,1)):(c=Ne(m),c.c(),b(c,1),c.m(t,null)):c&&(ne(),k(c,1,1,()=>{c=null}),se()),d&&d.p&&(!_||D&65536)&&we(d,v,m,m[16],_?Te(v,m[16],D,it):Fe(m[16]),ve);const g={};D&16&&(g.chartOptions=m[4]),E.$set(g),m[8].footer?h?(h.p(m,D),D&256&&b(h,1)):(h=ye(m),h.c(),b(h,1),h.m(e,null)):h&&(ne(),k(h,1,1,()=>{h=null}),se())},i(m){_||(b(c),b(d,m),b(E.$$.fragment,m),b(h),_=!0)},o(m){k(c),k(d,m),k(E.$$.fragment,m),k(h),_=!1},d(m){m&&I(e),c&&c.d(),d&&d.d(m),W(E),h&&h.d()}}}const Ce={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function ct(n,e,a){let{$$slots:t={},$$scope:l}=e;const s=Ke(t);let{type:o=Ce.PLAIN}=e,{unit:i=X.UNDEFINED}=e,{aggregation:r=w.UNDEFINED}=e,{maximumFractionDigits:E=fe}=e,{color:f=B}=e,{timeseries:_=[]}=e,{referencePower:c=void 0}=e,{referencePowerOptions:v=qe}=e,{labels:d=["Consumption","Exceedance"]}=e,{onclick:h=ze}=e,m=!1,D=[0,NaN],g={color:[],categories:[],series:[]};const O=(u,L,Q,ue,Z,G,me,Me)=>{m=P(L,Q);const he=!!me,_e=u===Ce.REPARTITION;let x=0,de=0;const V=G.reduce((N,S)=>{const{startedAt:J,value:T=NaN,anotherValue:R=NaN}=S;return x+=T??0,de+=R??0,N.startedAtData.push(J),_e?(N.valueData.push(T),N.anotherValueData.push(R),N):(N.valueData.push(T),N)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,g.color=Array.isArray(Z)?Z:[Z],g),a(4,g.categories=V.startedAtData,g),_e||he){a(3,D=[x,de]);const N={type:"bar",stack:"energy",data:V.valueData},S={type:"bar",stack:"energy",data:V.anotherValueData};a(4,g.series=[N,S],g)}else{a(3,D=[x,NaN]);const N={type:"bar",data:V.valueData};a(4,g.series=[N],g)}console.log("EnergyChart.updateChartOptions",{type:u,unit:L,aggregation:Q,maximumFractionDigits:ue,timeseries:G,isDrilldownEnabled:m,hasReferencePower:he,referencePower:me,referencePowerOptions:Me,data:V}),[w.DAY,w.HOUR,w.MINUTES].includes(Q)&&(a(4,g.xAxisLabelFormatter=Ze,g),a(4,g.tooltipFormatter=N=>{const S=N;let J=G[S[0].dataIndex],T="";return T+=`<div>${Qe(J.startedAt)}</div>`,S.forEach(R=>{J=G[R.dataIndex],T+=`
            <div>
              <span style="display:inline-block;border-radius:10px;width:10px;height:10px;background-color:${R.color};"></span>
              <span style="float:right;margin-left:20px;font-weight:600">${le(R.value,ue)} ${L}</span>
            </div>
          `}),T},g))},P=(u,L)=>{switch(u){case X.M3:return![w.HOUR,w.MINUTES,w.UNDEFINED].includes(L);case X.KW:case X.KWH:return![w.MINUTES,w.UNDEFINED].includes(L);default:return!1}},q=(u=0)=>Array.isArray(d)?d[u]??"":d,z=(u=0)=>{let L=B;return f&&(L=Array.isArray(f)?f[u]??B:u===0?f:B),L},Re=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:m,event:u}),u.data&&h(_[u.dataIndex])};return n.$$set=u=>{"type"in u&&a(9,o=u.type),"unit"in u&&a(0,i=u.unit),"aggregation"in u&&a(10,r=u.aggregation),"maximumFractionDigits"in u&&a(1,E=u.maximumFractionDigits),"color"in u&&a(11,f=u.color),"timeseries"in u&&a(2,_=u.timeseries),"referencePower"in u&&a(12,c=u.referencePower),"referencePowerOptions"in u&&a(13,v=u.referencePowerOptions),"labels"in u&&a(14,d=u.labels),"onclick"in u&&a(15,h=u.onclick),"$$scope"in u&&a(16,l=u.$$scope)},n.$$.update=()=>{n.$$.dirty&15879&&O(o,i,r,E,f,_,c,v)},[i,E,_,D,g,q,z,Re,s,o,r,f,c,v,d,h,l,t]}class _t extends ie{constructor(e){super(),re(this,e,ct,rt,ce,{type:9,unit:0,aggregation:10,maximumFractionDigits:1,color:11,timeseries:2,referencePower:12,referencePowerOptions:13,labels:14,onclick:15})}}export{w as A,_t as E,X as U};
