import{S as x,i as $,s as ee,E as Pe,a as Me,b as Ve,c as Be,e as M,t as A,f as v,g as He,m as V,p as B,u as H,v as We,z as _e,d as b,w as oe,A as Ee,h as F,j as p,k as w,l as k,n as I,x as q,o as U,q as C,y as z,r as P,B as Le,C as ie,D as re,F as Oe,G as Fe,H as Se,I as Ke,J as be}from"./ECharts.BfJ7rUUm.js";import{d as Ge}from"./dayjs.min.Cbbdfn5l.js";import{g as je,C as G,c as qe,i as se,L as le,j as De,d as ve,k as ze,l as Ye,m as Je}from"./ChartLoadingSpinner.DRIv29os.js";import"./index.DgoW5roq.js";const fe=3,ce=(s,e=fe,t=navigator?.language)=>new Intl.NumberFormat(t,{maximumFractionDigits:e}).format(s),Xe="dd HH:mm",pe=s=>Ge(s).format(Xe),j={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},O={HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""};function Qe(s){let e,t;return e=new qe({props:{color:s[2]}}),{c(){H(e.$$.fragment)},l(a){B(e.$$.fragment,a)},m(a,i){V(e,a,i),t=!0},p(a,i){const n={};i&4&&(n.color=a[2]),e.$set(n)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){A(e.$$.fragment,a),t=!1},d(a){M(e,a)}}}function Ze(s){let e,t,a;function i(o){s[5](o)}let n={init:Me,options:s[1],notMerge:!0,$$slots:{default:[Qe]},$$scope:{ctx:s}};return s[0]!==void 0&&(n.chart=s[0]),e=new Pe({props:n}),Ve.push(()=>Be(e,"chart",i)),{c(){H(e.$$.fragment)},l(o){B(e.$$.fragment,o)},m(o,r){V(e,o,r),a=!0},p(o,[r]){const l={};r&2&&(l.options=o[1]),r&132&&(l.$$scope={dirty:r,ctx:o}),!t&&r&1&&(t=!0,l.chart=o[0],He(()=>t=!1)),e.$set(l)},i(o){a||(v(e.$$.fragment,o),a=!0)},o(o){A(e.$$.fragment,o),a=!1},d(o){M(e,o)}}}const xe=s=>{const e={};for(let t=0;t<s[0].data.length;++t)for(let a=0;a<s.length;++a){const i=s[a],n=i.stack;if(!n)continue;e[n]||(e[n]={stackStart:[],stackEnd:[]});const o=e[n],r=i.data[t];r&&!isNaN(r)&&(o.stackStart[t]==null&&(o.stackStart[t]=a),o.stackEnd[t]=a)}return e},$e=s=>{const e=xe(s);for(let t=0;t<s.length;++t){const a=s[t];if(!a.stack){a.itemStyle=De(ve);continue}const i=a.data,n=i.length,o=e[a.stack];for(let r=0;r<n;++r){const l=o.stackEnd[r]===t;i[r]={value:i[r],itemStyle:De(l?ve:0)}}}return s};function et(s,e,t){let a,{chartOptions:i}=e,{onclick:n=je}=e,o,r={};const l=c=>{const{color:d,categories:f,series:N,xAxisLabelFormatter:g,tooltipFormatter:m}=c;console.log(c),t(1,r={color:d,tooltip:{trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:m},grid:{containLabel:!0,left:10,right:10,top:10,bottom:10},xAxis:{type:"category",data:f,axisLabel:{color:le,formatter:g},axisTick:{show:!0,alignWithLabel:!0},axisLine:{lineStyle:se},splitLine:{show:!0,lineStyle:se,showMinLine:!1,showMaxLine:!1,interval:2}},yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:le,showMaxLabel:!1},splitLine:{lineStyle:se,showMaxLine:!1}},series:$e(N)})};We(()=>(o.on("click",n),console.log("BaseColumnsChart - mounted",{chart:o}),()=>{o.off("click",n),console.log("BaseColumnsChart - destroyed",{chart:o})}));function D(c){o=c,t(0,o)}return s.$$set=c=>{"chartOptions"in c&&t(3,i=c.chartOptions),"onclick"in c&&t(4,n=c.onclick)},s.$$.update=()=>{s.$$.dirty&8&&t(2,a=i.color[0]??G),s.$$.dirty&8&&l(i)},[o,r,a,i,n,D]}class tt extends x{constructor(e){super(),$(this,e,et,Ze,ee,{chartOptions:3,onclick:4})}}function Ae(s){let e,t;return{c(){e=C("span"),t=z(s[3])},l(a){e=k(a,"SPAN",{});var i=I(e);t=q(i,s[3]),i.forEach(b)},m(a,i){F(a,e,i),p(e,t)},p(a,i){i&8&&oe(t,a[3])},d(a){a&&b(e)}}}function at(s){let e,t,a,i,n,o,r=ce(s[1],s[4])+"",l,D,c=s[3]&&Ae(s);return{c(){e=C("div"),t=C("span"),a=z(s[0]),i=P(),n=C("div"),o=C("span"),l=z(r),D=P(),c&&c.c(),this.h()},l(d){e=k(d,"DIV",{class:!0});var f=I(e);t=k(f,"SPAN",{});var N=I(t);a=q(N,s[0]),N.forEach(b),i=U(f),n=k(f,"DIV",{class:!0,style:!0});var g=I(n);o=k(g,"SPAN",{class:!0});var m=I(o);l=q(m,r),m.forEach(b),D=U(g),c&&c.l(g),g.forEach(b),f.forEach(b),this.h()},h(){w(o,"class","text-sm tabular-nums"),w(n,"class","text-sm font-semibold"),Ee(n,"color",s[2]),w(e,"class","flex items-center gap-2")},m(d,f){F(d,e,f),p(e,t),p(t,a),p(e,i),p(e,n),p(n,o),p(o,l),p(n,D),c&&c.m(n,null)},p(d,[f]){f&1&&oe(a,d[0]),f&18&&r!==(r=ce(d[1],d[4])+"")&&oe(l,r),d[3]?c?c.p(d,f):(c=Ae(d),c.c(),c.m(n,null)):c&&(c.d(1),c=null),f&4&&Ee(n,"color",d[2])},i:_e,o:_e,d(d){d&&b(e),c&&c.d()}}}function nt(s,e,t){let{label:a}=e,{value:i}=e,{valueColor:n=le}=e,{unit:o}=e,{maximumFractionDigits:r=fe}=e;return s.$$set=l=>{"label"in l&&t(0,a=l.label),"value"in l&&t(1,i=l.value),"valueColor"in l&&t(2,n=l.valueColor),"unit"in l&&t(3,o=l.unit),"maximumFractionDigits"in l&&t(4,r=l.maximumFractionDigits)},[a,i,n,o,r]}class Te extends x{constructor(e){super(),$(this,e,nt,at,ee,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const st=s=>({}),ke=s=>({}),ot=s=>({}),Ie=s=>({});function Ce(s){let e,t,a,i;e=new Te({props:{label:s[5](0),value:s[3][0],valueColor:s[6](0),unit:s[0],maximumFractionDigits:s[1]}});let n=s[3][1]&&Ne(s);return{c(){H(e.$$.fragment),t=P(),n&&n.c(),a=be()},l(o){B(e.$$.fragment,o),t=U(o),n&&n.l(o),a=be()},m(o,r){V(e,o,r),F(o,t,r),n&&n.m(o,r),F(o,a,r),i=!0},p(o,r){const l={};r&8&&(l.value=o[3][0]),r&1&&(l.unit=o[0]),r&2&&(l.maximumFractionDigits=o[1]),e.$set(l),o[3][1]?n?(n.p(o,r),r&8&&v(n,1)):(n=Ne(o),n.c(),v(n,1),n.m(a.parentNode,a)):n&&(ie(),A(n,1,1,()=>{n=null}),re())},i(o){i||(v(e.$$.fragment,o),v(n),i=!0)},o(o){A(e.$$.fragment,o),A(n),i=!1},d(o){o&&(b(t),b(a)),M(e,o),n&&n.d(o)}}}function Ne(s){let e,t;return e=new Te({props:{label:s[5](1),value:s[3][1],valueColor:s[6](1),unit:s[0],maximumFractionDigits:s[1]}}),{c(){H(e.$$.fragment)},l(a){B(e.$$.fragment,a)},m(a,i){V(e,a,i),t=!0},p(a,i){const n={};i&8&&(n.value=a[3][1]),i&1&&(n.unit=a[0]),i&2&&(n.maximumFractionDigits=a[1]),e.$set(n)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){A(e.$$.fragment,a),t=!1},d(a){M(e,a)}}}function ye(s){let e;const t=s[17].footer,a=Le(t,s,s[16],ke);return{c(){a&&a.c()},l(i){a&&a.l(i)},m(i,n){a&&a.m(i,n),e=!0},p(i,n){a&&a.p&&(!e||n&65536)&&Oe(a,t,i,i[16],e?Se(t,i[16],n,st):Fe(i[16]),ke)},i(i){e||(v(a,i),e=!0)},o(i){A(a,i),e=!1},d(i){a&&a.d(i)}}}function it(s){let e,t,a,i,n,o,r,l,D,c,d,f=s[2].length>0&&Ce(s);const N=s[17].headerActions,g=Le(N,s,s[16],Ie);D=new tt({props:{chartOptions:s[4],onclick:s[7]}});let m=s[8].footer&&ye(s);return{c(){e=C("div"),t=C("div"),a=C("div"),f&&f.c(),i=P(),n=C("div"),g&&g.c(),o=P(),r=C("div"),l=C("div"),H(D.$$.fragment),c=P(),m&&m.c(),this.h()},l(h){e=k(h,"DIV",{class:!0});var E=I(e);t=k(E,"DIV",{class:!0});var _=I(t);a=k(_,"DIV",{class:!0});var W=I(a);f&&f.l(W),W.forEach(b),i=U(_),n=k(_,"DIV",{});var Y=I(n);g&&g.l(Y),Y.forEach(b),_.forEach(b),o=U(E),r=k(E,"DIV",{class:!0});var J=I(r);l=k(J,"DIV",{class:!0});var X=I(l);B(D.$$.fragment,X),X.forEach(b),J.forEach(b),c=U(E),m&&m.l(E),E.forEach(b),this.h()},h(){w(a,"class","flex items-center gap-4"),w(t,"class","flex items-center justify-between"),w(l,"class","absolute top-0 right-0 bottom-0 left-0"),w(r,"class","relative grow"),w(e,"class","flex h-full grow flex-col gap-2")},m(h,E){F(h,e,E),p(e,t),p(t,a),f&&f.m(a,null),p(t,i),p(t,n),g&&g.m(n,null),p(e,o),p(e,r),p(r,l),V(D,l,null),p(e,c),m&&m.m(e,null),d=!0},p(h,[E]){h[2].length>0?f?(f.p(h,E),E&4&&v(f,1)):(f=Ce(h),f.c(),v(f,1),f.m(a,null)):f&&(ie(),A(f,1,1,()=>{f=null}),re()),g&&g.p&&(!d||E&65536)&&Oe(g,N,h,h[16],d?Se(N,h[16],E,ot):Fe(h[16]),Ie);const _={};E&16&&(_.chartOptions=h[4]),D.$set(_),h[8].footer?m?(m.p(h,E),E&256&&v(m,1)):(m=ye(h),m.c(),v(m,1),m.m(e,null)):m&&(ie(),A(m,1,1,()=>{m=null}),re())},i(h){d||(v(f),v(g,h),v(D.$$.fragment,h),v(m),d=!0)},o(h){A(f),A(g,h),A(D.$$.fragment,h),A(m),d=!1},d(h){h&&b(e),f&&f.d(),g&&g.d(h),M(D),m&&m.d()}}}const we={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function rt(s,e,t){let{$$slots:a={},$$scope:i}=e;const n=Ke(a);let{type:o=we.PLAIN}=e,{unit:r=j.UNDEFINED}=e,{aggregation:l=O.UNDEFINED}=e,{maximumFractionDigits:D=fe}=e,{color:c=G}=e,{timeseries:d=[]}=e,{referencePower:f=void 0}=e,{referencePowerOptions:N=ze}=e,{labels:g=["Consumption","Exceedance"]}=e,{onclick:m=Ye}=e,h=!1,E=[0,NaN],_={color:[],categories:[],series:[]};const W=(u,L,te,ue,ae,Q,me,Ue)=>{h=Y(L,te);const he=!!me,de=u===we.REPARTITION;let ne=0,ge=0;const K=Q.reduce((y,T)=>{const{startedAt:Z,value:S=NaN,anotherValue:R=NaN}=T;return ne+=S??0,ge+=R??0,y.startedAtData.push(Z),de?(y.valueData.push(S),y.anotherValueData.push(R),y):(y.valueData.push(S),y)},{startedAtData:[],valueData:[],anotherValueData:[]});if(t(4,_.color=Array.isArray(ae)?ae:[ae],_),t(4,_.categories=K.startedAtData,_),de||he){t(3,E=[ne,ge]);const y={type:"bar",stack:"energy",data:K.valueData},T={type:"bar",stack:"energy",data:K.anotherValueData};t(4,_.series=[y,T],_)}else{t(3,E=[ne,NaN]);const y={type:"bar",data:K.valueData};t(4,_.series=[y],_)}console.log("EnergyChart.updateChartOptions",{type:u,unit:L,aggregation:te,maximumFractionDigits:ue,timeseries:Q,isDrilldownEnabled:h,hasReferencePower:he,referencePower:me,referencePowerOptions:Ue,data:K}),[O.HOUR,O.MINUTES].includes(te)&&(t(4,_.xAxisLabelFormatter=pe,_),t(4,_.tooltipFormatter=y=>{const T=y;let Z=Q[T[0].dataIndex],S="";return S+=`<div>${pe(Z.startedAt)}</div>`,T.forEach(R=>{Z=Q[R.dataIndex],S+=`
            <div>
              <span style="display:inline-block;border-radius:10px;width:10px;height:10px;background-color:${R.color};"></span>
              <span style="float:right;margin-left:20px;font-weight:600">${ce(R.value,ue)} ${L}</span>
            </div>
          `}),S},_))},Y=(u,L)=>{switch(u){case j.M3:return![O.HOUR,O.MINUTES,O.UNDEFINED].includes(L);case j.KW:case j.KWH:return![O.MINUTES,O.UNDEFINED].includes(L);default:return!1}},J=(u=0)=>Array.isArray(g)?g[u]??"":g,X=(u=0)=>{let L=G;return c&&(L=Array.isArray(c)?c[u]??G:u===0?c:G),L},Re=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:h,event:u}),u.data&&m(d[u.dataIndex])};return s.$$set=u=>{"type"in u&&t(9,o=u.type),"unit"in u&&t(0,r=u.unit),"aggregation"in u&&t(10,l=u.aggregation),"maximumFractionDigits"in u&&t(1,D=u.maximumFractionDigits),"color"in u&&t(11,c=u.color),"timeseries"in u&&t(2,d=u.timeseries),"referencePower"in u&&t(12,f=u.referencePower),"referencePowerOptions"in u&&t(13,N=u.referencePowerOptions),"labels"in u&&t(14,g=u.labels),"onclick"in u&&t(15,m=u.onclick),"$$scope"in u&&t(16,i=u.$$scope)},s.$$.update=()=>{s.$$.dirty&15879&&W(o,r,l,D,c,d,f,N)},[r,D,d,E,_,J,X,Re,n,o,l,c,f,N,g,m,i,a]}class lt extends x{constructor(e){super(),$(this,e,rt,it,ee,{type:9,unit:0,aggregation:10,maximumFractionDigits:1,color:11,timeseries:2,referencePower:12,referencePowerOptions:13,labels:14,onclick:15})}}function ct(s){let e;return{c(){e=z("Gas Consumption header actions")},l(t){e=q(t,"Gas Consumption header actions")},m(t,a){F(t,e,a)},d(t){t&&b(e)}}}function ft(s){let e;return{c(){e=z("Footer Row")},l(t){e=q(t,"Footer Row")},m(t,a){F(t,e,a)},d(t){t&&b(e)}}}function ut(s){let e,t,a,i;return a=new lt({props:{timeseries:s[0],onclick:s[1],color:Je,unit:j.M3,aggregation:O.HOUR,$$slots:{footer:[ft],headerActions:[ct]},$$scope:{ctx:s}}}),{c(){e=C("div"),t=C("div"),H(a.$$.fragment),this.h()},l(n){e=k(n,"DIV",{class:!0});var o=I(e);t=k(o,"DIV",{class:!0});var r=I(t);B(a.$$.fragment,r),r.forEach(b),o.forEach(b),this.h()},h(){w(t,"class","absolute top-0 right-0 bottom-0 left-0"),w(e,"class","relative grow")},m(n,o){F(n,e,o),p(e,t),V(a,t,null),i=!0},p(n,[o]){const r={};o&1&&(r.timeseries=n[0]),o&4&&(r.$$scope={dirty:o,ctx:n}),a.$set(r)},i(n){i||(v(a.$$.fragment,n),i=!0)},o(n){A(a.$$.fragment,n),i=!1},d(n){n&&b(e),M(a)}}}function mt(s,e,t){let{timeseries:a=[]}=e;const i=n=>{console.log("GasConsumption.onChartClick timeserie:",n)};return s.$$set=n=>{"timeseries"in n&&t(0,a=n.timeseries)},[a,i]}class Et extends x{constructor(e){super(),$(this,e,mt,ut,ee,{timeseries:0})}}export{Et as default};
