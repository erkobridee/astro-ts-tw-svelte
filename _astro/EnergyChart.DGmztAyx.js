import{S as ge,i as Ee,s as De,E as ze,a as Qe,b as ve,c as Ne,e as z,t as N,f as k,g as Ce,m as Q,p as J,u as Z,v as Je,Q as ye,d as v,w as fe,R as Le,h as x,j as I,k as R,l as L,n as T,x as ue,o as H,q as w,y as me,r as K,A as Ke,M as he,N as de,C as je,D as Ye,F as qe,T as Ze,O as Te}from"./ECharts.D_PwvaFx.js";import{g as $e,d as et}from"./dayjs.min.2rai63wT.js";import{o as tt,C as G,c as at,g as X,p as le,L as _e,q as we,d as pe,T as Oe,r as Se,s as Ge,t as nt,k as rt,u as Me,v as ce,m as q,w as ot,x as st,f as it}from"./ChartLoadingSpinner.DbOd8JNa.js";import"./index.t4S9YAZx.js";var ne={exports:{}},lt=ne.exports,Fe;function ct(){return Fe||(Fe=1,function(n,e){(function(a,t){n.exports=t()})(lt,function(){return function(a,t){t.prototype.isSameOrBefore=function(o,r){return this.isSame(o,r)||this.isBefore(o,r)}}})}(ne)),ne.exports}var ft=ct();const ut=$e(ft);et.extend(ut);const ae={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},S={MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""},Tt={GAS:"GAS"};function mt(n){let e,a;return e=new at({props:{color:n[3]}}),{c(){Z(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,o){Q(e,t,o),a=!0},p(t,o){const r={};o&8&&(r.color=t[3]),e.$set(r)},i(t){a||(k(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){z(e,t)}}}function ht(n){let e,a,t,o;function r(s){n[7](s)}function i(s){n[8](s)}let l={init:Qe,options:n[2],notMerge:!0,$$slots:{default:[mt]},$$scope:{ctx:n}};return n[1]!==void 0&&(l.chart=n[1]),n[0]!==void 0&&(l.chartContainerDOMRect=n[0]),e=new ze({props:l}),ve.push(()=>Ne(e,"chart",r)),ve.push(()=>Ne(e,"chartContainerDOMRect",i)),{c(){Z(e.$$.fragment)},l(s){J(e.$$.fragment,s)},m(s,_){Q(e,s,_),o=!0},p(s,[_]){const d={};_&4&&(d.options=s[2]),_&4104&&(d.$$scope={dirty:_,ctx:s}),!a&&_&2&&(a=!0,d.chart=s[1],Ce(()=>a=!1)),!t&&_&1&&(t=!0,d.chartContainerDOMRect=s[0],Ce(()=>t=!1)),e.$set(d)},i(s){o||(k(e.$$.fragment,s),o=!0)},o(s){N(e.$$.fragment,s),o=!1},d(s){z(e,s)}}}const dt=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const o=n[t],r=o.stack;if(!r)continue;e[r]||(e[r]={stackStart:[],stackEnd:[]});const i=e[r],l=o.data[a];l&&!isNaN(l)&&(i.stackStart[a]==null&&(i.stackStart[a]=t),i.stackEnd[a]=t)}return e},_t=n=>{const e=dt(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=we(pe);continue}const o=t.data,r=o.length,i=e[t.stack];for(let l=0;l<r;++l){const s=i.stackEnd[l]===a;o[l]={value:o[l],itemStyle:we(s?pe:0)}}}return n};function gt(n,e,a){let t,{isTinyScreen:o=!1}=e,{chartOptions:r}=e,{onclick:i=tt}=e,l,s={},_;const d=(c,m)=>{const{color:D,categories:A,series:b,xAxisLabelFormatter:U,yAxisLabelFormatter:P=M=>X(M),tooltipFormatter:V}=c;a(4,o=(()=>{if(!m)return!1;const{width:M,height:W}=m;switch(screen.orientation.angle){case 0:return M<=Se&&W<=Oe;case 90:return M<=Oe&&W<=Se}return!1})()),console.log({isTinyScreen:o,chartOptions:c});const re={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:V},oe={containLabel:!0,left:0,right:0,top:0,bottom:0},u=A.length,p={type:"category",data:A,axisLabel:{color:_e,formatter:U,hideOverlap:!0,showMinLabel:!(o&&A.length>10||A.length>12)},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:le},splitLine:{show:!0,lineStyle:le,showMinLine:!1,showMaxLine:!1,interval:u>50?10:2}};a(2,s={color:D,tooltip:re,grid:oe,xAxis:p,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:_e,showMinLabel:!1,showMaxLabel:!1,formatter:P},splitLine:{lineStyle:le,showMaxLine:!1}},series:_t(b)})};let h="";const f=c=>{if(!o){i(c);return}const m=c.name;if(h&&m===h){i(c),h="";return}h=m};Je(()=>(l.on("click",f),console.log("BaseColumnsChart - mounted",{chart:l}),()=>{l.off("click",f),console.log("BaseColumnsChart - destroyed",{chart:l})}));function C(c){l=c,a(1,l)}function E(c){_=c,a(0,_)}return n.$$set=c=>{"isTinyScreen"in c&&a(4,o=c.isTinyScreen),"chartOptions"in c&&a(5,r=c.chartOptions),"onclick"in c&&a(6,i=c.onclick)},n.$$.update=()=>{n.$$.dirty&32&&a(3,t=r.color[0]??G),n.$$.dirty&33&&d(r,_)},[_,l,s,t,o,r,i,C,E]}class Et extends ge{constructor(e){super(),Ee(this,e,gt,ht,De,{isTinyScreen:4,chartOptions:5,onclick:6})}}function Re(n){let e,a;return{c(){e=w("span"),a=me(n[3])},l(t){e=L(t,"SPAN",{});var o=T(e);a=ue(o,n[3]),o.forEach(v)},m(t,o){x(t,e,o),I(e,a)},p(t,o){o&8&&fe(a,t[3])},d(t){t&&v(e)}}}function Dt(n){let e,a,t,o,r,i,l=X(n[1],n[4])+"",s,_,d=n[3]&&Re(n);return{c(){e=w("div"),a=w("span"),t=me(n[0]),o=K(),r=w("div"),i=w("span"),s=me(l),_=K(),d&&d.c(),this.h()},l(h){e=L(h,"DIV",{class:!0});var f=T(e);a=L(f,"SPAN",{});var C=T(a);t=ue(C,n[0]),C.forEach(v),o=H(f),r=L(f,"DIV",{class:!0,style:!0});var E=T(r);i=L(E,"SPAN",{class:!0});var c=T(i);s=ue(c,l),c.forEach(v),_=H(E),d&&d.l(E),E.forEach(v),f.forEach(v),this.h()},h(){R(i,"class","text-sm tabular-nums"),R(r,"class","text-sm font-semibold"),Le(r,"color",n[2]),R(e,"class","flex items-center gap-2")},m(h,f){x(h,e,f),I(e,a),I(a,t),I(e,o),I(e,r),I(r,i),I(i,s),I(r,_),d&&d.m(r,null)},p(h,[f]){f&1&&fe(t,h[0]),f&18&&l!==(l=X(h[1],h[4])+"")&&fe(s,l),h[3]?d?d.p(h,f):(d=Re(h),d.c(),d.m(r,null)):d&&(d.d(1),d=null),f&4&&Le(r,"color",h[2])},i:ye,o:ye,d(h){h&&v(e),d&&d.d()}}}function bt(n,e,a){let{label:t}=e,{value:o}=e,{valueColor:r=_e}=e,{unit:i}=e,{maximumFractionDigits:l=Ge}=e;return n.$$set=s=>{"label"in s&&a(0,t=s.label),"value"in s&&a(1,o=s.value),"valueColor"in s&&a(2,r=s.valueColor),"unit"in s&&a(3,i=s.unit),"maximumFractionDigits"in s&&a(4,l=s.maximumFractionDigits)},[t,o,r,i,l]}class xe extends ge{constructor(e){super(),Ee(this,e,bt,Dt,De,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const At=n=>({}),Be=n=>({}),kt=n=>({}),Ue=n=>({});function Pe(n){let e,a,t,o;e=new xe({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let r=n[3][1]&&Ve(n);return{c(){Z(e.$$.fragment),a=K(),r&&r.c(),t=Te()},l(i){J(e.$$.fragment,i),a=H(i),r&&r.l(i),t=Te()},m(i,l){Q(e,i,l),x(i,a,l),r&&r.m(i,l),x(i,t,l),o=!0},p(i,l){const s={};l&8&&(s.value=i[3][0]),l&1&&(s.unit=i[0]),l&2&&(s.maximumFractionDigits=i[1]),e.$set(s),i[3][1]?r?(r.p(i,l),l&8&&k(r,1)):(r=Ve(i),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(he(),N(r,1,1,()=>{r=null}),de())},i(i){o||(k(e.$$.fragment,i),k(r),o=!0)},o(i){N(e.$$.fragment,i),N(r),o=!1},d(i){i&&(v(a),v(t)),z(e,i),r&&r.d(i)}}}function Ve(n){let e,a;return e=new xe({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){Z(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,o){Q(e,t,o),a=!0},p(t,o){const r={};o&8&&(r.value=t[3][1]),o&1&&(r.unit=t[0]),o&2&&(r.maximumFractionDigits=t[1]),e.$set(r)},i(t){a||(k(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){z(e,t)}}}function We(n){let e;const a=n[18].footer,t=Ke(a,n,n[17],Be);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,r){t&&t.m(o,r),e=!0},p(o,r){t&&t.p&&(!e||r&131072)&&je(t,a,o,o[17],e?qe(a,o[17],r,At):Ye(o[17]),Be)},i(o){e||(k(t,o),e=!0)},o(o){N(t,o),e=!1},d(o){t&&t.d(o)}}}function It(n){let e,a,t,o,r,i,l,s,_,d,h,f=n[2].length>0&&Pe(n);const C=n[18].headerActions,E=Ke(C,n,n[17],Ue);_=new Et({props:{chartOptions:n[4],onclick:n[7]}});let c=n[8].footer&&We(n);return{c(){e=w("div"),a=w("div"),t=w("div"),f&&f.c(),o=K(),r=w("div"),E&&E.c(),i=K(),l=w("div"),s=w("div"),Z(_.$$.fragment),d=K(),c&&c.c(),this.h()},l(m){e=L(m,"DIV",{class:!0});var D=T(e);a=L(D,"DIV",{class:!0});var A=T(a);t=L(A,"DIV",{class:!0});var b=T(t);f&&f.l(b),b.forEach(v),o=H(A),r=L(A,"DIV",{});var U=T(r);E&&E.l(U),U.forEach(v),A.forEach(v),i=H(D),l=L(D,"DIV",{class:!0});var P=T(l);s=L(P,"DIV",{class:!0});var V=T(s);J(_.$$.fragment,V),V.forEach(v),P.forEach(v),d=H(D),c&&c.l(D),D.forEach(v),this.h()},h(){R(t,"class","flex items-center gap-4"),R(a,"class","flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-0"),R(s,"class","absolute top-0 right-0 bottom-0 left-0"),R(l,"class","relative min-h-[300px] grow"),R(e,"class","flex min-h-full grow flex-col gap-2")},m(m,D){x(m,e,D),I(e,a),I(a,t),f&&f.m(t,null),I(a,o),I(a,r),E&&E.m(r,null),I(e,i),I(e,l),I(l,s),Q(_,s,null),I(e,d),c&&c.m(e,null),h=!0},p(m,[D]){m[2].length>0?f?(f.p(m,D),D&4&&k(f,1)):(f=Pe(m),f.c(),k(f,1),f.m(t,null)):f&&(he(),N(f,1,1,()=>{f=null}),de()),E&&E.p&&(!h||D&131072)&&je(E,C,m,m[17],h?qe(C,m[17],D,kt):Ye(m[17]),Ue);const A={};D&16&&(A.chartOptions=m[4]),_.$set(A),m[8].footer?c?(c.p(m,D),D&256&&k(c,1)):(c=We(m),c.c(),k(c,1),c.m(e,null)):c&&(he(),N(c,1,1,()=>{c=null}),de())},i(m){h||(k(f),k(E,m),k(_.$$.fragment,m),k(c),h=!0)},o(m){N(f),N(E,m),N(_.$$.fragment,m),N(c),h=!1},d(m){m&&v(e),f&&f.d(),E&&E.d(m),z(_),c&&c.d()}}}const He={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function vt(n,e,a){let{$$slots:t={},$$scope:o}=e;const r=Ze(t);let{type:i=He.PLAIN}=e,{showAverageMarkline:l=!1}=e,{unit:s=ae.UNDEFINED}=e,{aggregation:_=S.UNDEFINED}=e,{maximumFractionDigits:d=Ge}=e,{color:h=G}=e,{timeseries:f=[]}=e,{referencePower:C=void 0}=e,{referencePowerOptions:E=nt}=e,{labels:c=["Consumption","Exceedance"]}=e,{onclick:m=rt}=e,D=!1,A=[0,NaN],b={color:[],categories:[],series:[]};const U=(u,p,$,M,W,se,j,be,Xe)=>{D=P($,M);const Ae=!!be,ke=u===He.REPARTITION;let ie=0,Ie=0;const Y=j.reduce((g,O)=>{const{startedAt:B,value:y=NaN,anotherValue:F=NaN}=O;return ie+=y??0,Ie+=F??0,g.startedAtData.push(B),ke?(g.valueData.push(y),g.anotherValueData.push(F),g):(g.valueData.push(y),g)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,b.color=Array.isArray(se)?se:[se],b),a(4,b.categories=Y.startedAtData,b),ke||Ae){a(3,A=[ie,Ie]);const g={type:"bar",stack:"energy",data:Y.valueData},O={type:"bar",stack:"energy",data:Y.anotherValueData};a(4,b.series=[g,O],b)}else{a(3,A=[ie,NaN]);const g={type:"bar",data:Y.valueData};a(4,b.series=[g],b)}b.series.forEach(g=>{if(p){let O=g.markLine;const B={type:"average",label:{fontWeight:"bold",position:"insideEndTop",backgroundColor:"white",padding:2,borderRadius:5,textBorderColor:"white",textBorderWidth:3,formatter:y=>X(y.value,W)}};if(O){const{symbol:y=Me,data:F=[]}=O;g.markLine={symbol:y,data:[...F,B]}}else g.markLine={symbol:Me,data:[B]}}g.cursor=D?"zoom-in":"default"}),console.log("EnergyChart.updateChartOptions",{type:u,showAverageMarkline:p,unit:$,aggregation:M,maximumFractionDigits:W,timeseries:j,isDrilldownEnabled:D,hasReferencePower:Ae,referencePower:be,referencePowerOptions:Xe,data:Y});let ee=ot,te=g=>st(g.startedAt);switch(M){case S.MONTH:ee=ce,te=g=>ce(g.startedAt);break;case S.WEEK:ee=j.length>6?ce:q,te=g=>`${q(g.startedAt)} - ${q(g.endedAt)}`;break;case S.DAY:ee=q,te=g=>q(g.startedAt);break}a(4,b.xAxisLabelFormatter=ee,b),a(4,b.tooltipFormatter=g=>{const O=g;let B=j[O[0].dataIndex],y="";return y+=`<div>${te(B)}</div>`,O.forEach(F=>{B=j[F.dataIndex],y+=it({color:F.color,value:`${X(F.value,W)} ${$}`})}),y},b)},P=(u,p)=>{switch(u){case ae.M3:return![S.HOUR,S.MINUTES,S.UNDEFINED].includes(p);case ae.KW:case ae.KWH:return![S.MINUTES,S.UNDEFINED].includes(p);default:return!1}},V=(u=0)=>Array.isArray(c)?c[u]??"":c,re=(u=0)=>{let p=G;return h&&(p=Array.isArray(h)?h[u]??G:u===0?h:G),p},oe=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:D,event:u}),u.data&&m(f[u.dataIndex])};return n.$$set=u=>{"type"in u&&a(9,i=u.type),"showAverageMarkline"in u&&a(10,l=u.showAverageMarkline),"unit"in u&&a(0,s=u.unit),"aggregation"in u&&a(11,_=u.aggregation),"maximumFractionDigits"in u&&a(1,d=u.maximumFractionDigits),"color"in u&&a(12,h=u.color),"timeseries"in u&&a(2,f=u.timeseries),"referencePower"in u&&a(13,C=u.referencePower),"referencePowerOptions"in u&&a(14,E=u.referencePowerOptions),"labels"in u&&a(15,c=u.labels),"onclick"in u&&a(16,m=u.onclick),"$$scope"in u&&a(17,o=u.$$scope)},n.$$.update=()=>{n.$$.dirty&32263&&U(i,l,s,_,d,h,f,C,E)},[s,d,f,A,b,V,re,oe,r,i,l,_,h,C,E,c,m,o,t]}class wt extends ge{constructor(e){super(),Ee(this,e,vt,It,De,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{S as A,wt as E,ae as U,Tt as a};
