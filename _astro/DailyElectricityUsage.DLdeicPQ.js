import{S as Z,i as $,s as tt,E as ft,a as ht,b as mt,c as gt,d as m,e as L,t as w,f as T,g as _t,h as I,j as D,m as R,k as _,l as y,n as A,o as bt,p as F,q as x,r as Ct,u as U,v as pt,w as vt,x as yt,y as At}from"./ECharts.CpYfIO0D.js";import"./index.DACIwEDX.js";import{h as K}from"./colors.DRy8vmPD.js";import{C as H,a as xt,D as Dt,b as kt,W as Et,c as St,d as X,L as Ot,e as J,f as Lt,g as wt,h as Tt}from"./ChartLoadingSpinner.BbKX_Jhn.js";import"./dayjs.min.2rai63wT.js";function Q(n){let t,e,r,a;return{c(){t=x("div"),e=x("span"),r=At(n[0]),this.h()},l(o){t=y(o,"DIV",{class:!0});var c=A(t);e=y(c,"SPAN",{class:!0,title:!0});var s=A(e);r=yt(s,n[0]),s.forEach(m),c.forEach(m),this.h()},h(){_(e,"class","text-[0.7rem]"),_(e,"title",a="Unit: "+n[0]),_(t,"class","absolute top-2 left-4 z-10")},m(o,c){I(o,t,c),D(t,e),D(e,r)},p(o,c){c&1&&vt(r,o[0]),c&1&&a!==(a="Unit: "+o[0])&&_(e,"title",a)},d(o){o&&m(t)}}}function It(n){let t,e;return t=new St({props:{color:n[1]}}),{c(){U(t.$$.fragment)},l(r){F(t.$$.fragment,r)},m(r,a){R(t,r,a),e=!0},p(r,a){const o={};a&2&&(o.color=r[1]),t.$set(o)},i(r){e||(T(t.$$.fragment,r),e=!0)},o(r){w(t.$$.fragment,r),e=!1},d(r){L(t,r)}}}function Rt(n){let t,e,r,a,o,c,s=n[0]&&Q(n);function v(l){n[13](l)}let b={init:ht,options:n[3],notMerge:!0,$$slots:{default:[It]},$$scope:{ctx:n}};return n[2]!==void 0&&(b.chart=n[2]),a=new ft({props:b}),mt.push(()=>gt(a,"chart",v)),{c(){t=x("div"),s&&s.c(),e=Ct(),r=x("div"),U(a.$$.fragment),this.h()},l(l){t=y(l,"DIV",{class:!0});var u=A(t);s&&s.l(u),e=bt(u),r=y(u,"DIV",{class:!0});var d=A(r);F(a.$$.fragment,d),d.forEach(m),u.forEach(m),this.h()},h(){_(r,"class","absolute top-0 right-0 bottom-0 left-0 overflow-hidden rounded-lg border border-gray-100"),_(t,"class","relative grow")},m(l,u){I(l,t,u),s&&s.m(t,null),D(t,e),D(t,r),R(a,r,null),c=!0},p(l,[u]){l[0]?s?s.p(l,u):(s=Q(l),s.c(),s.m(t,e)):s&&(s.d(1),s=null);const d={};u&8&&(d.options=l[3]),u&65538&&(d.$$scope={dirty:u,ctx:l}),!o&&u&4&&(o=!0,d.chart=l[2],_t(()=>o=!1)),a.$set(d)},i(l){c||(T(a.$$.fragment,l),c=!0)},o(l){w(a.$$.fragment,l),c=!1},d(l){l&&m(t),s&&s.d(),L(a)}}}function Ft(n,t,e){let{unit:r=""}=t;const a=kt,o=Et;let{xAxisAttribute:c="startedAt"}=t,{yAxisAttribute:s="value"}=t,{currentColor:v=H}=t,{previousColor:b=H}=t,{colorOpacity:l=.55}=t,{backgroundColor:u=xt}=t,{data:d}=t,{onclick:k=Dt}=t,g,P={};const et=(i,C,G,E,W,B,rt)=>{const ot=K(E,B),it=K(W,B),{current:M,previous:Y}=i,z=M.length-1,S=M.reduce((f,p,h)=>{const j=h===z?E:ot,q=h===z?W:it;return f.xAxis.push(p[C]),f.current.push({value:p[G],date:p[C],itemStyle:{borderRadius:X,borderWidth:1,borderColor:j,color:j}}),f.previous.push({value:Y[h][G],date:Y[h][C],itemStyle:{borderRadius:X,borderWidth:1,borderColor:q,color:q}}),f},{xAxis:[],current:[],previous:[]}),O="2%",V=30,nt={top:V,bottom:V,left:"15%",right:O},st={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:f=>{let p="";return f.forEach(h=>{p+=Lt({color:h.color,label:J({date:h.data.date,template:a}),value:wt(h.value)})}),p}},lt={type:"category",data:S.xAxis,axisLabel:{formatter:f=>J({date:f,template:o}),color:Ot},axisLine:{show:!1},axisTick:{show:!1}},ct={type:"value",show:!1},ut={type:"bar",data:S.previous},dt={type:"bar",data:S.current,barCategoryGap:30,markLine:{symbol:["none","none"],data:[{type:"average",x:O,lineStyle:{color:E,width:2,type:"solid"},emphasis:{disabled:!0},label:{show:!0,position:"insideStartTop",fontWeight:"bold",fontSize:12,formatter:f=>Number(f.value).toFixed(3)}},{type:"average",name:"Average",x:O,lineStyle:{color:"transparent"},label:{show:!0,position:"insideStartBottom",fontSize:12,formatter:"{b}",opacity:.8}}]}};e(3,P={backgroundColor:rt,grid:nt,tooltip:st,xAxis:lt,yAxis:ct,series:[ut,dt]})},N=i=>{if(console.log("onChartClick",i),!i.data)return;const C=i.dataIndex;k({current:d.current[C],previous:d.previous[C]})};pt(()=>(g.on("click",N),console.log("EnergyOverviewChart - mounted",{chart:g}),()=>{g.off("click",N),console.log("EnergyOverviewChart - destroyed",{chart:g})}));function at(i){g=i,e(2,g)}return n.$$set=i=>{"unit"in i&&e(0,r=i.unit),"xAxisAttribute"in i&&e(6,c=i.xAxisAttribute),"yAxisAttribute"in i&&e(7,s=i.yAxisAttribute),"currentColor"in i&&e(1,v=i.currentColor),"previousColor"in i&&e(8,b=i.previousColor),"colorOpacity"in i&&e(9,l=i.colorOpacity),"backgroundColor"in i&&e(10,u=i.backgroundColor),"data"in i&&e(11,d=i.data),"onclick"in i&&e(12,k=i.onclick)},n.$$.update=()=>{n.$$.dirty&4034&&et(d,c,s,v,b,l,u)},[r,v,g,P,a,o,c,s,b,l,u,d,k,at]}class Ut extends Z{constructor(t){super(),$(this,t,Ft,Rt,tt,{unit:0,tooltipDatetimeFormat:4,xAxisDatetimeFormat:5,xAxisAttribute:6,yAxisAttribute:7,currentColor:1,previousColor:8,colorOpacity:9,backgroundColor:10,data:11,onclick:12})}get tooltipDatetimeFormat(){return this.$$.ctx[4]}get xAxisDatetimeFormat(){return this.$$.ctx[5]}}function Pt(n){let t,e,r;return e=new Ut({props:{data:n[0],unit:"kWh",currentColor:Tt,onclick:n[1]}}),{c(){t=x("div"),U(e.$$.fragment),this.h()},l(a){t=y(a,"DIV",{class:!0});var o=A(t);F(e.$$.fragment,o),o.forEach(m),this.h()},h(){_(t,"class","flex h-[360px] w-[550px]")},m(a,o){I(a,t,o),R(e,t,null),r=!0},p(a,[o]){const c={};o&1&&(c.data=a[0]),e.$set(c)},i(a){r||(T(e.$$.fragment,a),r=!0)},o(a){w(e.$$.fragment,a),r=!1},d(a){a&&m(t),L(e)}}}function Nt(n,t,e){let{data:r}=t;const a=o=>{console.log("DailyElectricityUsage.onChartClick dayUsage:",o)};return n.$$set=o=>{"data"in o&&e(0,r=o.data)},[r,a]}class Vt extends Z{constructor(t){super(),$(this,t,Nt,Pt,tt,{data:0})}}export{Vt as default};
