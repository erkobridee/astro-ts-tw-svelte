import{S as de,i as ge,s as Ee,E as xe,a as Xe,b as Ie,c as Ce,e as X,t as N,f as v,g as Ne,m as z,p as Q,u as J,v as ze,Q as ke,d as C,w as ce,R as ye,h as G,j as I,k as R,l as L,n as T,x as fe,o as H,q as w,y as ue,r as K,A as We,M as me,N as he,C as He,D as Ke,F as Ye,T as Qe,O as Le}from"./ECharts.D_PwvaFx.js";import{g as Je,d as Ze}from"./dayjs.min.2rai63wT.js";import{n as $e,C as j,c as et,g as x,o as le,L as _e,p as tt,d as at,T as Te,q as we,r as qe,s as rt,t as nt,u as pe,v as st,w as ot,f as it,l as q,x as Oe}from"./ChartLoadingSpinner.DzwDg-M7.js";import"./index.t4S9YAZx.js";var re={exports:{}},lt=re.exports,Se;function ct(){return Se||(Se=1,function(r,e){(function(a,t){r.exports=t()})(lt,function(){return function(a,t){t.prototype.isSameOrBefore=function(s,n){return this.isSame(s,n)||this.isBefore(s,n)}}})}(re)),re.exports}var ft=ct();const ut=Je(ft);Ze.extend(ut);const ae={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},S={MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""},Lt={GAS:"GAS"};function mt(r){let e,a;return e=new et({props:{color:r[3]}}),{c(){J(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){z(e,t,s),a=!0},p(t,s){const n={};s&8&&(n.color=t[3]),e.$set(n)},i(t){a||(v(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){X(e,t)}}}function ht(r){let e,a,t,s;function n(o){r[7](o)}function i(o){r[8](o)}let c={init:Xe,options:r[2],notMerge:!0,$$slots:{default:[mt]},$$scope:{ctx:r}};return r[1]!==void 0&&(c.chart=r[1]),r[0]!==void 0&&(c.chartContainerDOMRect=r[0]),e=new xe({props:c}),Ie.push(()=>Ce(e,"chart",n)),Ie.push(()=>Ce(e,"chartContainerDOMRect",i)),{c(){J(e.$$.fragment)},l(o){Q(e.$$.fragment,o)},m(o,d){z(e,o,d),s=!0},p(o,[d]){const _={};d&4&&(_.options=o[2]),d&4104&&(_.$$scope={dirty:d,ctx:o}),!a&&d&2&&(a=!0,_.chart=o[1],Ne(()=>a=!1)),!t&&d&1&&(t=!0,_.chartContainerDOMRect=o[0],Ne(()=>t=!1)),e.$set(_)},i(o){s||(v(e.$$.fragment,o),s=!0)},o(o){N(e.$$.fragment,o),s=!1},d(o){X(e,o)}}}const _t=r=>{const e=r.length-1;return r[e].itemStyle=tt(at),r};function dt(r,e,a){let t,{isTinyScreen:s=!1}=e,{chartOptions:n}=e,{onclick:i=$e}=e,c,o={},d;const _=(l,m)=>{const{color:D,categories:A,series:b,xAxisLabelFormatter:U,yAxisLabelFormatter:P=M=>x(M),tooltipFormatter:V}=l;a(4,s=(()=>{if(!m)return!1;const{width:M,height:W}=m;switch(screen.orientation.angle){case 0:return M<=we&&W<=Te;case 90:return M<=Te&&W<=we}return!1})());const ne={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:V},se={containLabel:!0,left:0,right:0,top:0,bottom:0},u=A.length,p={type:"category",data:A,axisLabel:{color:_e,formatter:U,hideOverlap:!0,showMinLabel:!(s&&A.length>10||A.length>12)},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:le},splitLine:{show:!0,lineStyle:le,showMinLine:!1,showMaxLine:!1,interval:u>50?10:2}};a(2,o={color:D,tooltip:ne,grid:se,xAxis:p,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:_e,showMinLabel:!1,showMaxLabel:!1,formatter:P},splitLine:{lineStyle:le,showMaxLine:!1}},series:_t(b)})};let h="";const f=l=>{if(!s){i(l);return}const m=l.name;if(h&&m===h){i(l),h="";return}h=m};ze(()=>(c.on("click",f),console.log("BaseColumnsChart - mounted",{chart:c}),()=>{c.off("click",f),console.log("BaseColumnsChart - destroyed",{chart:c})}));function k(l){c=l,a(1,c)}function E(l){d=l,a(0,d)}return r.$$set=l=>{"isTinyScreen"in l&&a(4,s=l.isTinyScreen),"chartOptions"in l&&a(5,n=l.chartOptions),"onclick"in l&&a(6,i=l.onclick)},r.$$.update=()=>{r.$$.dirty&32&&a(3,t=n.color[1]??n.color[0]??j),r.$$.dirty&33&&_(n,d)},[d,c,o,t,s,n,i,k,E]}class gt extends de{constructor(e){super(),ge(this,e,dt,ht,Ee,{isTinyScreen:4,chartOptions:5,onclick:6})}}function Me(r){let e,a;return{c(){e=w("span"),a=ue(r[3])},l(t){e=L(t,"SPAN",{});var s=T(e);a=fe(s,r[3]),s.forEach(C)},m(t,s){G(t,e,s),I(e,a)},p(t,s){s&8&&ce(a,t[3])},d(t){t&&C(e)}}}function Et(r){let e,a,t,s,n,i,c=x(r[1],r[4])+"",o,d,_=r[3]&&Me(r);return{c(){e=w("div"),a=w("span"),t=ue(r[0]),s=K(),n=w("div"),i=w("span"),o=ue(c),d=K(),_&&_.c(),this.h()},l(h){e=L(h,"DIV",{class:!0});var f=T(e);a=L(f,"SPAN",{});var k=T(a);t=fe(k,r[0]),k.forEach(C),s=H(f),n=L(f,"DIV",{class:!0,style:!0});var E=T(n);i=L(E,"SPAN",{class:!0});var l=T(i);o=fe(l,c),l.forEach(C),d=H(E),_&&_.l(E),E.forEach(C),f.forEach(C),this.h()},h(){R(i,"class","text-sm tabular-nums"),R(n,"class","text-sm font-semibold"),ye(n,"color",r[2]),R(e,"class","flex items-center gap-2")},m(h,f){G(h,e,f),I(e,a),I(a,t),I(e,s),I(e,n),I(n,i),I(i,o),I(n,d),_&&_.m(n,null)},p(h,[f]){f&1&&ce(t,h[0]),f&18&&c!==(c=x(h[1],h[4])+"")&&ce(o,c),h[3]?_?_.p(h,f):(_=Me(h),_.c(),_.m(n,null)):_&&(_.d(1),_=null),f&4&&ye(n,"color",h[2])},i:ke,o:ke,d(h){h&&C(e),_&&_.d()}}}function Dt(r,e,a){let{label:t}=e,{value:s}=e,{valueColor:n=_e}=e,{unit:i}=e,{maximumFractionDigits:c=qe}=e;return r.$$set=o=>{"label"in o&&a(0,t=o.label),"value"in o&&a(1,s=o.value),"valueColor"in o&&a(2,n=o.valueColor),"unit"in o&&a(3,i=o.unit),"maximumFractionDigits"in o&&a(4,c=o.maximumFractionDigits)},[t,s,n,i,c]}class je extends de{constructor(e){super(),ge(this,e,Dt,Et,Ee,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const bt=r=>({}),Fe=r=>({}),At=r=>({}),Re=r=>({});function Be(r){let e,a,t,s;e=new je({props:{label:r[5](0),value:r[3][0],valueColor:r[6](0),unit:r[0],maximumFractionDigits:r[1]}});let n=r[3][1]&&Ue(r);return{c(){J(e.$$.fragment),a=K(),n&&n.c(),t=Le()},l(i){Q(e.$$.fragment,i),a=H(i),n&&n.l(i),t=Le()},m(i,c){z(e,i,c),G(i,a,c),n&&n.m(i,c),G(i,t,c),s=!0},p(i,c){const o={};c&8&&(o.value=i[3][0]),c&1&&(o.unit=i[0]),c&2&&(o.maximumFractionDigits=i[1]),e.$set(o),i[3][1]?n?(n.p(i,c),c&8&&v(n,1)):(n=Ue(i),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(me(),N(n,1,1,()=>{n=null}),he())},i(i){s||(v(e.$$.fragment,i),v(n),s=!0)},o(i){N(e.$$.fragment,i),N(n),s=!1},d(i){i&&(C(a),C(t)),X(e,i),n&&n.d(i)}}}function Ue(r){let e,a;return e=new je({props:{label:r[5](1),value:r[3][1],valueColor:r[6](1),unit:r[0],maximumFractionDigits:r[1]}}),{c(){J(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){z(e,t,s),a=!0},p(t,s){const n={};s&8&&(n.value=t[3][1]),s&1&&(n.unit=t[0]),s&2&&(n.maximumFractionDigits=t[1]),e.$set(n)},i(t){a||(v(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){X(e,t)}}}function Pe(r){let e;const a=r[18].footer,t=We(a,r,r[17],Fe);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,n){t&&t.m(s,n),e=!0},p(s,n){t&&t.p&&(!e||n&131072)&&He(t,a,s,s[17],e?Ye(a,s[17],n,bt):Ke(s[17]),Fe)},i(s){e||(v(t,s),e=!0)},o(s){N(t,s),e=!1},d(s){t&&t.d(s)}}}function vt(r){let e,a,t,s,n,i,c,o,d,_,h,f=r[2].length>0&&Be(r);const k=r[18].headerActions,E=We(k,r,r[17],Re);d=new gt({props:{chartOptions:r[4],onclick:r[7]}});let l=r[8].footer&&Pe(r);return{c(){e=w("div"),a=w("div"),t=w("div"),f&&f.c(),s=K(),n=w("div"),E&&E.c(),i=K(),c=w("div"),o=w("div"),J(d.$$.fragment),_=K(),l&&l.c(),this.h()},l(m){e=L(m,"DIV",{class:!0});var D=T(e);a=L(D,"DIV",{class:!0});var A=T(a);t=L(A,"DIV",{class:!0});var b=T(t);f&&f.l(b),b.forEach(C),s=H(A),n=L(A,"DIV",{});var U=T(n);E&&E.l(U),U.forEach(C),A.forEach(C),i=H(D),c=L(D,"DIV",{class:!0});var P=T(c);o=L(P,"DIV",{class:!0});var V=T(o);Q(d.$$.fragment,V),V.forEach(C),P.forEach(C),_=H(D),l&&l.l(D),D.forEach(C),this.h()},h(){R(t,"class","flex items-center gap-4"),R(a,"class","flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-0"),R(o,"class","absolute top-0 right-0 bottom-0 left-0"),R(c,"class","relative min-h-[300px] grow"),R(e,"class","flex min-h-full grow flex-col gap-2")},m(m,D){G(m,e,D),I(e,a),I(a,t),f&&f.m(t,null),I(a,s),I(a,n),E&&E.m(n,null),I(e,i),I(e,c),I(c,o),z(d,o,null),I(e,_),l&&l.m(e,null),h=!0},p(m,[D]){m[2].length>0?f?(f.p(m,D),D&4&&v(f,1)):(f=Be(m),f.c(),v(f,1),f.m(t,null)):f&&(me(),N(f,1,1,()=>{f=null}),he()),E&&E.p&&(!h||D&131072)&&He(E,k,m,m[17],h?Ye(k,m[17],D,At):Ke(m[17]),Re);const A={};D&16&&(A.chartOptions=m[4]),d.$set(A),m[8].footer?l?(l.p(m,D),D&256&&v(l,1)):(l=Pe(m),l.c(),v(l,1),l.m(e,null)):l&&(me(),N(l,1,1,()=>{l=null}),he())},i(m){h||(v(f),v(E,m),v(d.$$.fragment,m),v(l),h=!0)},o(m){N(f),N(E,m),N(d.$$.fragment,m),N(l),h=!1},d(m){m&&C(e),f&&f.d(),E&&E.d(m),X(d),l&&l.d()}}}const Ve={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function It(r,e,a){let{$$slots:t={},$$scope:s}=e;const n=Qe(t);let{type:i=Ve.PLAIN}=e,{showAverageMarkline:c=!1}=e,{unit:o=ae.UNDEFINED}=e,{aggregation:d=S.UNDEFINED}=e,{maximumFractionDigits:_=qe}=e,{color:h=j}=e,{timeseries:f=[]}=e,{referencePower:k=void 0}=e,{referencePowerOptions:E=rt}=e,{labels:l=["Consumption","Exceedance"]}=e,{onclick:m=nt}=e,D=!1,A=[0,NaN],b={color:[],categories:[],series:[]};const U=(u,p,Z,M,W,oe,$,De,Ge)=>{D=P(Z,M);const be=!!De,Ae=u===Ve.REPARTITION;let ie=0,ve=0;const Y=$.reduce((g,O)=>{const{startedAt:B,value:y=NaN,anotherValue:F=NaN}=O;return ie+=y??0,ve+=F??0,g.startedAtData.push(B),Ae?(g.valueData.push(y),g.anotherValueData.push(F),g):(g.valueData.push(y),g)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,b.color=Array.isArray(oe)?oe:[oe],b),a(4,b.categories=Y.startedAtData,b),Ae||be){a(3,A=[ie,ve]);const g={type:"bar",stack:"energy",name:l[0],data:Y.valueData},O={type:"bar",stack:"energy",name:l[1],data:Y.anotherValueData};a(4,b.series=[g,O],b)}else{a(3,A=[ie,NaN]);const g={type:"bar",data:Y.valueData};a(4,b.series=[g],b)}b.series.forEach(g=>{if(p){let O=g.markLine;const B={type:"average",label:{fontWeight:"bold",position:"insideEndTop",backgroundColor:"white",padding:2,borderRadius:5,textBorderColor:"white",textBorderWidth:3,formatter:y=>x(y.value,W)}};if(O){const{symbol:y=pe,data:F=[]}=O;g.markLine={symbol:y,data:[...F,B]}}else g.markLine={symbol:pe,data:[B]}}g.cursor=D?"zoom-in":"default"}),console.log("EnergyChart.updateChartOptions",{type:u,showAverageMarkline:p,unit:Z,aggregation:M,maximumFractionDigits:W,timeseries:$,isDrilldownEnabled:D,hasReferencePower:be,referencePower:De,referencePowerOptions:Ge,data:Y});let ee=st,te=g=>ot(g.startedAt);switch(M){case S.MONTH:ee=Oe,te=g=>Oe(g.startedAt);break;case S.WEEK:ee=q,te=g=>`${q(g.startedAt)} - ${q(g.endedAt)}`;break;case S.DAY:ee=q,te=g=>q(g.startedAt);break}a(4,b.xAxisLabelFormatter=ee,b),a(4,b.tooltipFormatter=g=>{const O=g;let B=$[O[0].dataIndex],y="";return y+=`<div>${te(B)}</div>`,O.forEach(F=>{B=$[F.dataIndex],y+=it({color:F.color,value:`${x(F.value,W)} ${Z}`})}),y},b)},P=(u,p)=>{switch(u){case ae.M3:return![S.HOUR,S.MINUTES,S.UNDEFINED].includes(p);case ae.KW:case ae.KWH:return![S.MINUTES,S.UNDEFINED].includes(p);default:return!1}},V=(u=0)=>Array.isArray(l)?l[u]??"":l,ne=(u=0)=>{let p=j;return h&&(p=Array.isArray(h)?h[u]??j:u===0?h:j),p},se=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:D,event:u}),u.data&&m(f[u.dataIndex])};return r.$$set=u=>{"type"in u&&a(9,i=u.type),"showAverageMarkline"in u&&a(10,c=u.showAverageMarkline),"unit"in u&&a(0,o=u.unit),"aggregation"in u&&a(11,d=u.aggregation),"maximumFractionDigits"in u&&a(1,_=u.maximumFractionDigits),"color"in u&&a(12,h=u.color),"timeseries"in u&&a(2,f=u.timeseries),"referencePower"in u&&a(13,k=u.referencePower),"referencePowerOptions"in u&&a(14,E=u.referencePowerOptions),"labels"in u&&a(15,l=u.labels),"onclick"in u&&a(16,m=u.onclick),"$$scope"in u&&a(17,s=u.$$scope)},r.$$.update=()=>{r.$$.dirty&32263&&U(i,c,o,d,_,h,f,k,E)},[o,_,f,A,b,V,ne,se,n,i,c,d,h,k,E,l,m,s,t]}class Tt extends de{constructor(e){super(),ge(this,e,It,vt,Ee,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{S as A,Tt as E,ae as U,Ve as a,Lt as b};
