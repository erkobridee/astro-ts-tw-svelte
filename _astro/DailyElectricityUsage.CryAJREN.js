import{S as j,i as X,s as q,E as dt,a as ft,b as ht,c as _t,d as f,e as K,t as H,f as J,g as gt,h as E,j as k,m as Q,k as _,l as m,n as b,o as mt,p as Z,q as v,r as bt,u as $,v as vt,w as yt,x as Ct,y as pt,z as G}from"./ECharts.DF4cteOg.js";import{d as N}from"./dayjs.min.Cbbdfn5l.js";import"./index.BiZfemjP.js";import{C as V,a as At,D as kt,h as z,b as B,L as Et,c as xt}from"./common.C16CT1O5.js";function W(i){let t,e,a,r;return{c(){t=v("div"),e=v("span"),a=pt(i[0]),this.h()},l(o){t=m(o,"DIV",{class:!0});var c=b(t);e=m(c,"SPAN",{class:!0,title:!0});var l=b(e);a=Ct(l,i[0]),l.forEach(f),c.forEach(f),this.h()},h(){_(e,"class","text-[0.7rem]"),_(e,"title",r="Unit: "+i[0]),_(t,"class","absolute top-2 left-4 z-10")},m(o,c){E(o,t,c),k(t,e),k(e,a)},p(o,c){c&1&&yt(a,o[0]),c&1&&r!==(r="Unit: "+o[0])&&_(e,"title",r)},d(o){o&&f(t)}}}function Dt(i){let t,e;return{c(){t=v("div"),e=v("div"),this.h()},l(a){t=m(a,"DIV",{class:!0});var r=b(t);e=m(r,"DIV",{class:!0,style:!0}),b(e).forEach(f),r.forEach(f),this.h()},h(){_(e,"class","h-20 w-20 animate-spin rounded-full border-4 border-t-4 border-gray-200"),G(e,"border-top-color",i[1]),_(t,"class","flex h-full w-full items-center justify-center")},m(a,r){E(a,t,r),k(t,e)},p(a,r){r&2&&G(e,"border-top-color",a[1])},d(a){a&&f(t)}}}function Ot(i){let t,e,a,r,o,c,l=i[0]&&W(i);function A(n){i[11](n)}let y={init:ft,options:i[3],notMerge:!0,$$slots:{default:[Dt]},$$scope:{ctx:i}};return i[2]!==void 0&&(y.chart=i[2]),r=new dt({props:y}),ht.push(()=>_t(r,"chart",A)),{c(){t=v("div"),l&&l.c(),e=bt(),a=v("div"),$(r.$$.fragment),this.h()},l(n){t=m(n,"DIV",{class:!0});var u=b(t);l&&l.l(u),e=mt(u),a=m(u,"DIV",{class:!0});var d=b(a);Z(r.$$.fragment,d),d.forEach(f),u.forEach(f),this.h()},h(){_(a,"class","absolute top-0 right-0 bottom-0 left-0 overflow-hidden rounded-lg border border-gray-100"),_(t,"class","relative grow")},m(n,u){E(n,t,u),l&&l.m(t,null),k(t,e),k(t,a),Q(r,a,null),c=!0},p(n,[u]){n[0]?l?l.p(n,u):(l=W(n),l.c(),l.m(t,e)):l&&(l.d(1),l=null);const d={};u&8&&(d.options=n[3]),u&16386&&(d.$$scope={dirty:u,ctx:n}),!o&&u&4&&(o=!0,d.chart=n[2],gt(()=>o=!1)),r.$set(d)},i(n){c||(J(r.$$.fragment,n),c=!0)},o(n){H(r.$$.fragment,n),c=!1},d(n){n&&f(t),l&&l.d(),K(r)}}}const wt="DD.MM.YYYY",It="ddd";function St(i,t,e){let{unit:a=""}=t,{xAxisAttribute:r="startedAt"}=t,{yAxisAttribute:o="value"}=t,{currentColor:c=V}=t,{previousColor:l=V}=t,{colorOpacity:A=.55}=t,{backgroundColor:y=At}=t,{data:n}=t,{onclick:u=kt}=t,d,w={};const tt=(s,C,S,x,L,T,rt)=>{const at=z(x,T),ot=z(L,T),{current:R,previous:U}=s,M=R.length-1,D=R.reduce((h,p,g)=>{const Y=g===M?x:at,F=g===M?L:ot;return h.xAxis.push(p[C]),h.current.push({value:p[S],date:p[C],itemStyle:{borderRadius:B,borderWidth:1,borderColor:Y,color:Y}}),h.previous.push({value:U[g][S],date:U[g][C],itemStyle:{borderRadius:B,borderWidth:1,borderColor:F,color:F}}),h},{xAxis:[],current:[],previous:[]}),O="2%",P=30,st={top:P,bottom:P,left:"15%",right:O},it={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:h=>{let p="";return h.forEach(g=>{p+=`
            <div>
              <span style="display:inline-block;border-radius:10px;width:10px;height:10px;background-color:${g.color};"></span>
              <span>${N(g.data.date).format(wt)}</span>
              <span style="float:right;margin-left:20px;font-weight:600">${g.value}</span>
            </div>
          `}),p}},nt={type:"category",data:D.xAxis,axisLabel:{formatter:h=>N(h).format(It),color:Et},axisLine:{show:!1},axisTick:{show:!1}},lt={type:"value",show:!1},ct={type:"bar",data:D.previous},ut={type:"bar",data:D.current,barCategoryGap:30,markLine:{symbol:["none","none"],data:[{type:"average",x:O,lineStyle:{color:x,width:2,type:"solid"},emphasis:{disabled:!0},label:{show:!0,position:"insideStartTop",fontWeight:"bold",fontSize:12,formatter:h=>Number(h.value).toFixed(3)}},{type:"average",name:"Average",x:O,lineStyle:{color:"transparent"},label:{show:!0,position:"insideStartBottom",fontSize:12,formatter:"{b}",opacity:.8}}]}};e(3,w={backgroundColor:rt,grid:st,tooltip:it,xAxis:nt,yAxis:lt,series:[ct,ut]})},I=s=>{if(console.log("onChartClick",s),!s.data)return;const C=s.dataIndex;u({current:n.current[C],previous:n.previous[C]})};vt(()=>(d.on("click",I),console.log("EnergyOverviewChart - mounted",{chart:d}),()=>{d.off("click",I),console.log("EnergyOverviewChart - destroyed",{chart:d})}));function et(s){d=s,e(2,d)}return i.$$set=s=>{"unit"in s&&e(0,a=s.unit),"xAxisAttribute"in s&&e(4,r=s.xAxisAttribute),"yAxisAttribute"in s&&e(5,o=s.yAxisAttribute),"currentColor"in s&&e(1,c=s.currentColor),"previousColor"in s&&e(6,l=s.previousColor),"colorOpacity"in s&&e(7,A=s.colorOpacity),"backgroundColor"in s&&e(8,y=s.backgroundColor),"data"in s&&e(9,n=s.data),"onclick"in s&&e(10,u=s.onclick)},i.$$.update=()=>{i.$$.dirty&1010&&tt(n,r,o,c,l,A,y)},[a,c,d,w,r,o,l,A,y,n,u,et]}class Lt extends j{constructor(t){super(),X(this,t,St,Ot,q,{unit:0,xAxisAttribute:4,yAxisAttribute:5,currentColor:1,previousColor:6,colorOpacity:7,backgroundColor:8,data:9,onclick:10})}}function Tt(i){let t,e,a;return e=new Lt({props:{data:i[0],unit:"kWh",currentColor:xt,onclick:i[1]}}),{c(){t=v("div"),$(e.$$.fragment),this.h()},l(r){t=m(r,"DIV",{class:!0});var o=b(t);Z(e.$$.fragment,o),o.forEach(f),this.h()},h(){_(t,"class","flex h-[360px] w-[550px]")},m(r,o){E(r,t,o),Q(e,t,null),a=!0},p(r,[o]){const c={};o&1&&(c.data=r[0]),e.$set(c)},i(r){a||(J(e.$$.fragment,r),a=!0)},o(r){H(e.$$.fragment,r),a=!1},d(r){r&&f(t),K(e)}}}function Rt(i,t,e){let{data:a}=t;const r=o=>{console.log("DailyElectricityUsage.onChartClick dayUsage:",o)};return i.$$set=o=>{"data"in o&&e(0,a=o.data)},[a,r]}class Gt extends j{constructor(t){super(),X(this,t,Rt,Tt,q,{data:0})}}export{Gt as default};
