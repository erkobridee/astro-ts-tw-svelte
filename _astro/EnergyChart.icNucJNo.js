import{S as Ee,i as be,s as De,E as Je,a as Ze,b as ye,c as Ne,e as z,t as y,f as v,g as pe,m as Q,p as J,u as Z,v as $e,Q as Ce,d as I,w as ue,R as we,h as X,j as k,k as F,l as C,n as w,x as me,o as H,q as L,y as he,r as K,A as Ye,M as de,N as ge,C as qe,D as xe,F as Ge,T as et,O as Le}from"./ECharts.D_PwvaFx.js";import{g as tt,d as at}from"./dayjs.min.2rai63wT.js";import{o as nt,C as G,c as rt,g as j,p as fe,L as _e,q as Te,d as Oe,T as Se,r as Me,s as Xe,t as st,u as ot,v as Re,w as it,x as lt,f as ct,m as x,y as Fe}from"./ChartLoadingSpinner.DVULy6zJ.js";import"./index.t4S9YAZx.js";var ne={exports:{}},ft=ne.exports,Be;function ut(){return Be||(Be=1,function(n,e){(function(a,t){n.exports=t()})(ft,function(){return function(a,t){t.prototype.isSameOrBefore=function(s,r){return this.isSame(s,r)||this.isBefore(s,r)}}})}(ne)),ne.exports}var mt=ut();const ht=tt(mt);at.extend(ht);const ae={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},M={MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""},Tt={GAS:"GAS"};function dt(n){let e,a;return e=new rt({props:{color:n[3]}}),{c(){Z(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,s){Q(e,t,s),a=!0},p(t,s){const r={};s&8&&(r.color=t[3]),e.$set(r)},i(t){a||(v(e.$$.fragment,t),a=!0)},o(t){y(e.$$.fragment,t),a=!1},d(t){z(e,t)}}}function gt(n){let e,a,t,s;function r(o){n[7](o)}function l(o){n[8](o)}let i={init:Ze,options:n[2],notMerge:!0,$$slots:{default:[dt]},$$scope:{ctx:n}};return n[1]!==void 0&&(i.chart=n[1]),n[0]!==void 0&&(i.chartContainerDOMRect=n[0]),e=new Je({props:i}),ye.push(()=>Ne(e,"chart",r)),ye.push(()=>Ne(e,"chartContainerDOMRect",l)),{c(){Z(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,m){Q(e,o,m),s=!0},p(o,[m]){const h={};m&4&&(h.options=o[2]),m&4104&&(h.$$scope={dirty:m,ctx:o}),!a&&m&2&&(a=!0,h.chart=o[1],pe(()=>a=!1)),!t&&m&1&&(t=!0,h.chartContainerDOMRect=o[0],pe(()=>t=!1)),e.$set(h)},i(o){s||(v(e.$$.fragment,o),s=!0)},o(o){y(e.$$.fragment,o),s=!1},d(o){z(e,o)}}}const _t=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const s=n[t],r=s.stack;if(!r)continue;e[r]||(e[r]={stackStart:[],stackEnd:[]});const l=e[r],i=s.data[a];(()=>{const m=i&&i.value?i.value:i;if(!m||m===null)return!1;switch(typeof m){case"number":return!isNaN(m);case"string":return m!=="-"}})()&&(l.stackStart[a]==null&&(l.stackStart[a]=t),l.stackEnd[a]=t)}return e},Et=n=>{const e=_t(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=Te(Oe);continue}const s=t.data,r=s.length,l=e[t.stack];for(let i=0;i<r;++i){const o=l.stackEnd[i]===a,m=s[i]&&s[i].value||s[i],h=Te(o?Oe:0);s[i]={value:m,itemStyle:h}}}return n};function bt(n,e,a){let t,{isTinyScreen:s=!1}=e,{chartOptions:r}=e,{onclick:l=nt}=e,i,o={},m;const h=(c,d)=>{const{color:b,categories:A,series:D,xAxisLabelFormatter:U,yAxisLabelFormatter:V=R=>j(R),tooltipFormatter:W}=c;a(4,s=(()=>{if(!d)return!1;const{width:R,height:B}=d;switch(screen.orientation.angle){case 0:return R<=Me&&B<=Se;case 90:return R<=Se&&B<=Me}return!1})());const re={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:W},se={containLabel:!0,left:0,right:0,top:0,bottom:0},u=A.length,T={type:"category",data:A,axisLabel:{color:_e,formatter:U,hideOverlap:!0,showMinLabel:!(s&&A.length>10||A.length>12)},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:fe},splitLine:{show:!0,lineStyle:fe,showMinLine:!1,showMaxLine:!1,interval:u>50?10:2}};a(2,o={color:b,tooltip:re,grid:se,xAxis:T,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:_e,showMinLabel:!1,showMaxLabel:!1,formatter:V},splitLine:{lineStyle:fe,showMaxLine:!1}},series:Et(D)})};let g="";const f=c=>{if(!s){l(c);return}const d=c.name;if(g&&d===g){l(c),g="";return}g=d};$e(()=>(i.on("click",f),console.log("BaseColumnsChart - mounted",{chart:i}),()=>{i.off("click",f),console.log("BaseColumnsChart - destroyed",{chart:i})}));function N(c){i=c,a(1,i)}function E(c){m=c,a(0,m)}return n.$$set=c=>{"isTinyScreen"in c&&a(4,s=c.isTinyScreen),"chartOptions"in c&&a(5,r=c.chartOptions),"onclick"in c&&a(6,l=c.onclick)},n.$$.update=()=>{n.$$.dirty&32&&a(3,t=r.color[1]??r.color[0]??G),n.$$.dirty&33&&h(r,m)},[m,i,o,t,s,r,l,N,E]}class Dt extends Ee{constructor(e){super(),be(this,e,bt,gt,De,{isTinyScreen:4,chartOptions:5,onclick:6})}}function Pe(n){let e,a;return{c(){e=L("span"),a=he(n[3])},l(t){e=C(t,"SPAN",{});var s=w(e);a=me(s,n[3]),s.forEach(I)},m(t,s){X(t,e,s),k(e,a)},p(t,s){s&8&&ue(a,t[3])},d(t){t&&I(e)}}}function At(n){let e,a,t,s,r,l,i=j(n[1],n[4])+"",o,m,h=n[3]&&Pe(n);return{c(){e=L("div"),a=L("span"),t=he(n[0]),s=K(),r=L("div"),l=L("span"),o=he(i),m=K(),h&&h.c(),this.h()},l(g){e=C(g,"DIV",{class:!0});var f=w(e);a=C(f,"SPAN",{});var N=w(a);t=me(N,n[0]),N.forEach(I),s=H(f),r=C(f,"DIV",{class:!0,style:!0});var E=w(r);l=C(E,"SPAN",{class:!0});var c=w(l);o=me(c,i),c.forEach(I),m=H(E),h&&h.l(E),E.forEach(I),f.forEach(I),this.h()},h(){F(l,"class","text-sm tabular-nums"),F(r,"class","text-sm font-semibold"),we(r,"color",n[2]),F(e,"class","flex items-center gap-2")},m(g,f){X(g,e,f),k(e,a),k(a,t),k(e,s),k(e,r),k(r,l),k(l,o),k(r,m),h&&h.m(r,null)},p(g,[f]){f&1&&ue(t,g[0]),f&18&&i!==(i=j(g[1],g[4])+"")&&ue(o,i),g[3]?h?h.p(g,f):(h=Pe(g),h.c(),h.m(r,null)):h&&(h.d(1),h=null),f&4&&we(r,"color",g[2])},i:Ce,o:Ce,d(g){g&&I(e),h&&h.d()}}}function vt(n,e,a){let{label:t}=e,{value:s}=e,{valueColor:r=_e}=e,{unit:l}=e,{maximumFractionDigits:i=Xe}=e;return n.$$set=o=>{"label"in o&&a(0,t=o.label),"value"in o&&a(1,s=o.value),"valueColor"in o&&a(2,r=o.valueColor),"unit"in o&&a(3,l=o.unit),"maximumFractionDigits"in o&&a(4,i=o.maximumFractionDigits)},[t,s,r,l,i]}class ze extends Ee{constructor(e){super(),be(this,e,vt,At,De,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const kt=n=>({}),Ue=n=>({}),It=n=>({}),Ve=n=>({});function We(n){let e,a,t,s;e=new ze({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let r=n[3][1]&&He(n);return{c(){Z(e.$$.fragment),a=K(),r&&r.c(),t=Le()},l(l){J(e.$$.fragment,l),a=H(l),r&&r.l(l),t=Le()},m(l,i){Q(e,l,i),X(l,a,i),r&&r.m(l,i),X(l,t,i),s=!0},p(l,i){const o={};i&8&&(o.value=l[3][0]),i&1&&(o.unit=l[0]),i&2&&(o.maximumFractionDigits=l[1]),e.$set(o),l[3][1]?r?(r.p(l,i),i&8&&v(r,1)):(r=He(l),r.c(),v(r,1),r.m(t.parentNode,t)):r&&(de(),y(r,1,1,()=>{r=null}),ge())},i(l){s||(v(e.$$.fragment,l),v(r),s=!0)},o(l){y(e.$$.fragment,l),y(r),s=!1},d(l){l&&(I(a),I(t)),z(e,l),r&&r.d(l)}}}function He(n){let e,a;return e=new ze({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){Z(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,s){Q(e,t,s),a=!0},p(t,s){const r={};s&8&&(r.value=t[3][1]),s&1&&(r.unit=t[0]),s&2&&(r.maximumFractionDigits=t[1]),e.$set(r)},i(t){a||(v(e.$$.fragment,t),a=!0)},o(t){y(e.$$.fragment,t),a=!1},d(t){z(e,t)}}}function Ke(n){let e;const a=n[18].footer,t=Ye(a,n,n[17],Ue);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),e=!0},p(s,r){t&&t.p&&(!e||r&131072)&&qe(t,a,s,s[17],e?Ge(a,s[17],r,kt):xe(s[17]),Ue)},i(s){e||(v(t,s),e=!0)},o(s){y(t,s),e=!1},d(s){t&&t.d(s)}}}function yt(n){let e,a,t,s,r,l,i,o,m,h,g,f=n[2].length>0&&We(n);const N=n[18].headerActions,E=Ye(N,n,n[17],Ve);m=new Dt({props:{chartOptions:n[4],onclick:n[7]}});let c=n[8].footer&&Ke(n);return{c(){e=L("div"),a=L("div"),t=L("div"),f&&f.c(),s=K(),r=L("div"),E&&E.c(),l=K(),i=L("div"),o=L("div"),Z(m.$$.fragment),h=K(),c&&c.c(),this.h()},l(d){e=C(d,"DIV",{class:!0});var b=w(e);a=C(b,"DIV",{class:!0});var A=w(a);t=C(A,"DIV",{class:!0});var D=w(t);f&&f.l(D),D.forEach(I),s=H(A),r=C(A,"DIV",{});var U=w(r);E&&E.l(U),U.forEach(I),A.forEach(I),l=H(b),i=C(b,"DIV",{class:!0});var V=w(i);o=C(V,"DIV",{class:!0});var W=w(o);J(m.$$.fragment,W),W.forEach(I),V.forEach(I),h=H(b),c&&c.l(b),b.forEach(I),this.h()},h(){F(t,"class","flex items-center gap-4"),F(a,"class","flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-0"),F(o,"class","absolute top-0 right-0 bottom-0 left-0"),F(i,"class","relative min-h-[300px] grow"),F(e,"class","flex min-h-full grow flex-col gap-2")},m(d,b){X(d,e,b),k(e,a),k(a,t),f&&f.m(t,null),k(a,s),k(a,r),E&&E.m(r,null),k(e,l),k(e,i),k(i,o),Q(m,o,null),k(e,h),c&&c.m(e,null),g=!0},p(d,[b]){d[2].length>0?f?(f.p(d,b),b&4&&v(f,1)):(f=We(d),f.c(),v(f,1),f.m(t,null)):f&&(de(),y(f,1,1,()=>{f=null}),ge()),E&&E.p&&(!g||b&131072)&&qe(E,N,d,d[17],g?Ge(N,d[17],b,It):xe(d[17]),Ve);const A={};b&16&&(A.chartOptions=d[4]),m.$set(A),d[8].footer?c?(c.p(d,b),b&256&&v(c,1)):(c=Ke(d),c.c(),v(c,1),c.m(e,null)):c&&(de(),y(c,1,1,()=>{c=null}),ge())},i(d){g||(v(f),v(E,d),v(m.$$.fragment,d),v(c),g=!0)},o(d){y(f),y(E,d),y(m.$$.fragment,d),y(c),g=!1},d(d){d&&I(e),f&&f.d(),E&&E.d(d),z(m),c&&c.d()}}}const je={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function Nt(n,e,a){let{$$slots:t={},$$scope:s}=e;const r=et(t);let{type:l=je.PLAIN}=e,{showAverageMarkline:i=!1}=e,{unit:o=ae.UNDEFINED}=e,{aggregation:m=M.UNDEFINED}=e,{maximumFractionDigits:h=Xe}=e,{color:g=G}=e,{timeseries:f=[]}=e,{referencePower:N=void 0}=e,{referencePowerOptions:E=st}=e,{labels:c=["Consumption","Exceedance"]}=e,{onclick:d=ot}=e,b=!1,A=[0,NaN],D={color:[],categories:[],series:[]};const U=(u,T,Y,R,B,oe,$,Ae,Qe)=>{b=V(Y,R);const ve=!!Ae,ie=u===je.REPARTITION;let le=0,ke=0;const q=$.reduce((_,S)=>{const{startedAt:P,value:O=NaN,anotherValue:p=NaN}=S;return le+=O??0,ke+=p??0,_.startedAtData.push(P),ie?(_.valueData.push(O),_.anotherValueData.push(p),_):(_.valueData.push(O),_)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,D.color=Array.isArray(oe)?oe:[oe],D),a(4,D.categories=q.startedAtData,D),ie||ve){a(3,A=[le,ke]);const _={type:"bar",stack:"energy",name:c[0],data:q.valueData},S={type:"bar",stack:"energy",name:c[1],data:q.anotherValueData};a(4,D.series=[_,S],D)}else{a(3,A=[le,NaN]);const _={type:"bar",data:q.valueData};a(4,D.series=[_],D)}D.series.forEach(_=>{if(T){let S=_.markLine;const P={type:"average",label:{fontWeight:"bold",position:"insideEndTop",backgroundColor:"white",padding:2,borderRadius:5,textBorderColor:"white",textBorderWidth:3,formatter:O=>j(O.value,B)}};if(S){const{symbol:O=Re,data:p=[]}=S;_.markLine={symbol:O,data:[...p,P]}}else _.markLine={symbol:Re,data:[P]}}_.cursor=b?"zoom-in":"default"}),console.log("EnergyChart.updateChartOptions",{type:u,showAverageMarkline:T,unit:Y,aggregation:R,maximumFractionDigits:B,timeseries:$,isDrilldownEnabled:b,hasReferencePower:ve,referencePower:Ae,referencePowerOptions:Qe,data:q});let ee=it,te=_=>lt(_.startedAt);switch(R){case M.MONTH:ee=Fe,te=_=>Fe(_.startedAt);break;case M.WEEK:ee=x,te=_=>`${x(_.startedAt)} - ${x(_.endedAt)}`;break;case M.DAY:ee=x,te=_=>x(_.startedAt);break}a(4,D.xAxisLabelFormatter=ee,D),a(4,D.tooltipFormatter=_=>{const S=_;let P=$[S[0].dataIndex],O=0,p="";return p+=`<div>${te(P)}</div>`,S.reverse().forEach(ce=>{P=$[ce.dataIndex];const Ie=ce.value;O+=Ie,p+=ct({color:ce.color,value:`${j(Ie,B)} ${Y}`})}),ie&&(p+='<div style="padding-top: 5px;"><hr>',p+=`<span style="float:right;margin-left:20px;font-weight:600">${j(O,B)} ${Y}</span>`,p+="</div>"),p},D)},V=(u,T)=>{switch(u){case ae.M3:return![M.HOUR,M.MINUTES,M.UNDEFINED].includes(T);case ae.KW:case ae.KWH:return![M.MINUTES,M.UNDEFINED].includes(T);default:return!1}},W=(u=0)=>Array.isArray(c)?c[u]??"":c,re=(u=0)=>{let T=G;return g&&(T=Array.isArray(g)?g[u]??G:u===0?g:G),T},se=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:b,event:u}),u.data&&d(f[u.dataIndex])};return n.$$set=u=>{"type"in u&&a(9,l=u.type),"showAverageMarkline"in u&&a(10,i=u.showAverageMarkline),"unit"in u&&a(0,o=u.unit),"aggregation"in u&&a(11,m=u.aggregation),"maximumFractionDigits"in u&&a(1,h=u.maximumFractionDigits),"color"in u&&a(12,g=u.color),"timeseries"in u&&a(2,f=u.timeseries),"referencePower"in u&&a(13,N=u.referencePower),"referencePowerOptions"in u&&a(14,E=u.referencePowerOptions),"labels"in u&&a(15,c=u.labels),"onclick"in u&&a(16,d=u.onclick),"$$scope"in u&&a(17,s=u.$$scope)},n.$$.update=()=>{n.$$.dirty&32263&&U(l,i,o,m,h,g,f,N,E)},[o,h,f,A,D,W,re,se,r,l,i,m,g,N,E,c,d,s,t]}class Ot extends Ee{constructor(e){super(),be(this,e,Nt,yt,De,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{M as A,Ot as E,ae as U,je as a,Tt as b};
