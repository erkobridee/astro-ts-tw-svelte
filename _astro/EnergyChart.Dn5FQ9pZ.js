import{S as _e,i as ge,s as Ee,E as ze,a as Qe,b as Ie,c as ve,e as x,t as N,f as k,g as Ne,m as z,p as Q,u as J,v as Je,Q as Ce,d as v,w as ce,R as ye,h as G,j as I,k as R,l as L,n as T,x as fe,o as H,q as w,y as ue,r as K,A as Ke,M as me,N as he,C as je,D as Ye,F as qe,T as Ze,O as Le}from"./ECharts.D_PwvaFx.js";import{g as $e,d as et}from"./dayjs.min.2rai63wT.js";import{m as tt,C as q,c as at,g as X,n as le,L as de,o as Te,d as we,T as pe,p as Oe,q as Ge,r as nt,s as rt,t as Se,u as st,v as ot,f as it,k as Y,w as Me}from"./ChartLoadingSpinner.D7xEQwwr.js";import"./index.t4S9YAZx.js";var ne={exports:{}},lt=ne.exports,Fe;function ct(){return Fe||(Fe=1,function(n,e){(function(a,t){n.exports=t()})(lt,function(){return function(a,t){t.prototype.isSameOrBefore=function(s,r){return this.isSame(s,r)||this.isBefore(s,r)}}})}(ne)),ne.exports}var ft=ct();const ut=$e(ft);et.extend(ut);const ae={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},S={MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""},Tt={GAS:"GAS"};function mt(n){let e,a;return e=new at({props:{color:n[3]}}),{c(){J(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){z(e,t,s),a=!0},p(t,s){const r={};s&8&&(r.color=t[3]),e.$set(r)},i(t){a||(k(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){x(e,t)}}}function ht(n){let e,a,t,s;function r(o){n[7](o)}function i(o){n[8](o)}let l={init:Qe,options:n[2],notMerge:!0,$$slots:{default:[mt]},$$scope:{ctx:n}};return n[1]!==void 0&&(l.chart=n[1]),n[0]!==void 0&&(l.chartContainerDOMRect=n[0]),e=new ze({props:l}),Ie.push(()=>ve(e,"chart",r)),Ie.push(()=>ve(e,"chartContainerDOMRect",i)),{c(){J(e.$$.fragment)},l(o){Q(e.$$.fragment,o)},m(o,_){z(e,o,_),s=!0},p(o,[_]){const d={};_&4&&(d.options=o[2]),_&4104&&(d.$$scope={dirty:_,ctx:o}),!a&&_&2&&(a=!0,d.chart=o[1],Ne(()=>a=!1)),!t&&_&1&&(t=!0,d.chartContainerDOMRect=o[0],Ne(()=>t=!1)),e.$set(d)},i(o){s||(k(e.$$.fragment,o),s=!0)},o(o){N(e.$$.fragment,o),s=!1},d(o){x(e,o)}}}const dt=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const s=n[t],r=s.stack;if(!r)continue;e[r]||(e[r]={stackStart:[],stackEnd:[]});const i=e[r],l=s.data[a];l&&!isNaN(l)&&(i.stackStart[a]==null&&(i.stackStart[a]=t),i.stackEnd[a]=t)}return e},_t=n=>{const e=dt(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=Te(we);continue}const s=t.data,r=s.length,i=e[t.stack];for(let l=0;l<r;++l){const o=i.stackEnd[l]===a;s[l]={value:s[l],itemStyle:Te(o?we:0)}}}return n};function gt(n,e,a){let t,{isTinyScreen:s=!1}=e,{chartOptions:r}=e,{onclick:i=tt}=e,l,o={},_;const d=(c,m)=>{const{color:D,categories:A,series:b,xAxisLabelFormatter:U,yAxisLabelFormatter:P=M=>X(M),tooltipFormatter:V}=c;a(4,s=(()=>{if(!m)return!1;const{width:M,height:W}=m;switch(screen.orientation.angle){case 0:return M<=Oe&&W<=pe;case 90:return M<=pe&&W<=Oe}return!1})()),console.log({isTinyScreen:s,chartOptions:c});const re={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:V},se={containLabel:!0,left:0,right:0,top:0,bottom:0},u=A.length,p={type:"category",data:A,axisLabel:{color:de,formatter:U,hideOverlap:!0,showMinLabel:!(s&&A.length>10||A.length>12)},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:le},splitLine:{show:!0,lineStyle:le,showMinLine:!1,showMaxLine:!1,interval:u>50?10:2}};a(2,o={color:D,tooltip:re,grid:se,xAxis:p,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:de,showMinLabel:!1,showMaxLabel:!1,formatter:P},splitLine:{lineStyle:le,showMaxLine:!1}},series:_t(b)})};let h="";const f=c=>{if(!s){i(c);return}const m=c.name;if(h&&m===h){i(c),h="";return}h=m};Je(()=>(l.on("click",f),console.log("BaseColumnsChart - mounted",{chart:l}),()=>{l.off("click",f),console.log("BaseColumnsChart - destroyed",{chart:l})}));function C(c){l=c,a(1,l)}function E(c){_=c,a(0,_)}return n.$$set=c=>{"isTinyScreen"in c&&a(4,s=c.isTinyScreen),"chartOptions"in c&&a(5,r=c.chartOptions),"onclick"in c&&a(6,i=c.onclick)},n.$$.update=()=>{n.$$.dirty&32&&a(3,t=r.color[0]??q),n.$$.dirty&33&&d(r,_)},[_,l,o,t,s,r,i,C,E]}class Et extends _e{constructor(e){super(),ge(this,e,gt,ht,Ee,{isTinyScreen:4,chartOptions:5,onclick:6})}}function Re(n){let e,a;return{c(){e=w("span"),a=ue(n[3])},l(t){e=L(t,"SPAN",{});var s=T(e);a=fe(s,n[3]),s.forEach(v)},m(t,s){G(t,e,s),I(e,a)},p(t,s){s&8&&ce(a,t[3])},d(t){t&&v(e)}}}function Dt(n){let e,a,t,s,r,i,l=X(n[1],n[4])+"",o,_,d=n[3]&&Re(n);return{c(){e=w("div"),a=w("span"),t=ue(n[0]),s=K(),r=w("div"),i=w("span"),o=ue(l),_=K(),d&&d.c(),this.h()},l(h){e=L(h,"DIV",{class:!0});var f=T(e);a=L(f,"SPAN",{});var C=T(a);t=fe(C,n[0]),C.forEach(v),s=H(f),r=L(f,"DIV",{class:!0,style:!0});var E=T(r);i=L(E,"SPAN",{class:!0});var c=T(i);o=fe(c,l),c.forEach(v),_=H(E),d&&d.l(E),E.forEach(v),f.forEach(v),this.h()},h(){R(i,"class","text-sm tabular-nums"),R(r,"class","text-sm font-semibold"),ye(r,"color",n[2]),R(e,"class","flex items-center gap-2")},m(h,f){G(h,e,f),I(e,a),I(a,t),I(e,s),I(e,r),I(r,i),I(i,o),I(r,_),d&&d.m(r,null)},p(h,[f]){f&1&&ce(t,h[0]),f&18&&l!==(l=X(h[1],h[4])+"")&&ce(o,l),h[3]?d?d.p(h,f):(d=Re(h),d.c(),d.m(r,null)):d&&(d.d(1),d=null),f&4&&ye(r,"color",h[2])},i:Ce,o:Ce,d(h){h&&v(e),d&&d.d()}}}function bt(n,e,a){let{label:t}=e,{value:s}=e,{valueColor:r=de}=e,{unit:i}=e,{maximumFractionDigits:l=Ge}=e;return n.$$set=o=>{"label"in o&&a(0,t=o.label),"value"in o&&a(1,s=o.value),"valueColor"in o&&a(2,r=o.valueColor),"unit"in o&&a(3,i=o.unit),"maximumFractionDigits"in o&&a(4,l=o.maximumFractionDigits)},[t,s,r,i,l]}class Xe extends _e{constructor(e){super(),ge(this,e,bt,Dt,Ee,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const At=n=>({}),Be=n=>({}),kt=n=>({}),Ue=n=>({});function Pe(n){let e,a,t,s;e=new Xe({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let r=n[3][1]&&Ve(n);return{c(){J(e.$$.fragment),a=K(),r&&r.c(),t=Le()},l(i){Q(e.$$.fragment,i),a=H(i),r&&r.l(i),t=Le()},m(i,l){z(e,i,l),G(i,a,l),r&&r.m(i,l),G(i,t,l),s=!0},p(i,l){const o={};l&8&&(o.value=i[3][0]),l&1&&(o.unit=i[0]),l&2&&(o.maximumFractionDigits=i[1]),e.$set(o),i[3][1]?r?(r.p(i,l),l&8&&k(r,1)):(r=Ve(i),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(me(),N(r,1,1,()=>{r=null}),he())},i(i){s||(k(e.$$.fragment,i),k(r),s=!0)},o(i){N(e.$$.fragment,i),N(r),s=!1},d(i){i&&(v(a),v(t)),x(e,i),r&&r.d(i)}}}function Ve(n){let e,a;return e=new Xe({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){J(e.$$.fragment)},l(t){Q(e.$$.fragment,t)},m(t,s){z(e,t,s),a=!0},p(t,s){const r={};s&8&&(r.value=t[3][1]),s&1&&(r.unit=t[0]),s&2&&(r.maximumFractionDigits=t[1]),e.$set(r)},i(t){a||(k(e.$$.fragment,t),a=!0)},o(t){N(e.$$.fragment,t),a=!1},d(t){x(e,t)}}}function We(n){let e;const a=n[18].footer,t=Ke(a,n,n[17],Be);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,r){t&&t.m(s,r),e=!0},p(s,r){t&&t.p&&(!e||r&131072)&&je(t,a,s,s[17],e?qe(a,s[17],r,At):Ye(s[17]),Be)},i(s){e||(k(t,s),e=!0)},o(s){N(t,s),e=!1},d(s){t&&t.d(s)}}}function It(n){let e,a,t,s,r,i,l,o,_,d,h,f=n[2].length>0&&Pe(n);const C=n[18].headerActions,E=Ke(C,n,n[17],Ue);_=new Et({props:{chartOptions:n[4],onclick:n[7]}});let c=n[8].footer&&We(n);return{c(){e=w("div"),a=w("div"),t=w("div"),f&&f.c(),s=K(),r=w("div"),E&&E.c(),i=K(),l=w("div"),o=w("div"),J(_.$$.fragment),d=K(),c&&c.c(),this.h()},l(m){e=L(m,"DIV",{class:!0});var D=T(e);a=L(D,"DIV",{class:!0});var A=T(a);t=L(A,"DIV",{class:!0});var b=T(t);f&&f.l(b),b.forEach(v),s=H(A),r=L(A,"DIV",{});var U=T(r);E&&E.l(U),U.forEach(v),A.forEach(v),i=H(D),l=L(D,"DIV",{class:!0});var P=T(l);o=L(P,"DIV",{class:!0});var V=T(o);Q(_.$$.fragment,V),V.forEach(v),P.forEach(v),d=H(D),c&&c.l(D),D.forEach(v),this.h()},h(){R(t,"class","flex items-center gap-4"),R(a,"class","flex flex-col gap-4 md:flex-row md:items-center md:justify-between md:gap-0"),R(o,"class","absolute top-0 right-0 bottom-0 left-0"),R(l,"class","relative min-h-[300px] grow"),R(e,"class","flex min-h-full grow flex-col gap-2")},m(m,D){G(m,e,D),I(e,a),I(a,t),f&&f.m(t,null),I(a,s),I(a,r),E&&E.m(r,null),I(e,i),I(e,l),I(l,o),z(_,o,null),I(e,d),c&&c.m(e,null),h=!0},p(m,[D]){m[2].length>0?f?(f.p(m,D),D&4&&k(f,1)):(f=Pe(m),f.c(),k(f,1),f.m(t,null)):f&&(me(),N(f,1,1,()=>{f=null}),he()),E&&E.p&&(!h||D&131072)&&je(E,C,m,m[17],h?qe(C,m[17],D,kt):Ye(m[17]),Ue);const A={};D&16&&(A.chartOptions=m[4]),_.$set(A),m[8].footer?c?(c.p(m,D),D&256&&k(c,1)):(c=We(m),c.c(),k(c,1),c.m(e,null)):c&&(me(),N(c,1,1,()=>{c=null}),he())},i(m){h||(k(f),k(E,m),k(_.$$.fragment,m),k(c),h=!0)},o(m){N(f),N(E,m),N(_.$$.fragment,m),N(c),h=!1},d(m){m&&v(e),f&&f.d(),E&&E.d(m),x(_),c&&c.d()}}}const He={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function vt(n,e,a){let{$$slots:t={},$$scope:s}=e;const r=Ze(t);let{type:i=He.PLAIN}=e,{showAverageMarkline:l=!1}=e,{unit:o=ae.UNDEFINED}=e,{aggregation:_=S.UNDEFINED}=e,{maximumFractionDigits:d=Ge}=e,{color:h=q}=e,{timeseries:f=[]}=e,{referencePower:C=void 0}=e,{referencePowerOptions:E=nt}=e,{labels:c=["Consumption","Exceedance"]}=e,{onclick:m=rt}=e,D=!1,A=[0,NaN],b={color:[],categories:[],series:[]};const U=(u,p,Z,M,W,oe,$,De,xe)=>{D=P(Z,M);const be=!!De,Ae=u===He.REPARTITION;let ie=0,ke=0;const j=$.reduce((g,O)=>{const{startedAt:B,value:y=NaN,anotherValue:F=NaN}=O;return ie+=y??0,ke+=F??0,g.startedAtData.push(B),Ae?(g.valueData.push(y),g.anotherValueData.push(F),g):(g.valueData.push(y),g)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,b.color=Array.isArray(oe)?oe:[oe],b),a(4,b.categories=j.startedAtData,b),Ae||be){a(3,A=[ie,ke]);const g={type:"bar",stack:"energy",data:j.valueData},O={type:"bar",stack:"energy",data:j.anotherValueData};a(4,b.series=[g,O],b)}else{a(3,A=[ie,NaN]);const g={type:"bar",data:j.valueData};a(4,b.series=[g],b)}b.series.forEach(g=>{if(p){let O=g.markLine;const B={type:"average",label:{fontWeight:"bold",position:"insideEndTop",backgroundColor:"white",padding:2,borderRadius:5,textBorderColor:"white",textBorderWidth:3,formatter:y=>X(y.value,W)}};if(O){const{symbol:y=Se,data:F=[]}=O;g.markLine={symbol:y,data:[...F,B]}}else g.markLine={symbol:Se,data:[B]}}g.cursor=D?"zoom-in":"default"}),console.log("EnergyChart.updateChartOptions",{type:u,showAverageMarkline:p,unit:Z,aggregation:M,maximumFractionDigits:W,timeseries:$,isDrilldownEnabled:D,hasReferencePower:be,referencePower:De,referencePowerOptions:xe,data:j});let ee=st,te=g=>ot(g.startedAt);switch(M){case S.MONTH:ee=Me,te=g=>Me(g.startedAt);break;case S.WEEK:ee=Y,te=g=>`${Y(g.startedAt)} - ${Y(g.endedAt)}`;break;case S.DAY:ee=Y,te=g=>Y(g.startedAt);break}a(4,b.xAxisLabelFormatter=ee,b),a(4,b.tooltipFormatter=g=>{const O=g;let B=$[O[0].dataIndex],y="";return y+=`<div>${te(B)}</div>`,O.forEach(F=>{B=$[F.dataIndex],y+=it({color:F.color,value:`${X(F.value,W)} ${Z}`})}),y},b)},P=(u,p)=>{switch(u){case ae.M3:return![S.HOUR,S.MINUTES,S.UNDEFINED].includes(p);case ae.KW:case ae.KWH:return![S.MINUTES,S.UNDEFINED].includes(p);default:return!1}},V=(u=0)=>Array.isArray(c)?c[u]??"":c,re=(u=0)=>{let p=q;return h&&(p=Array.isArray(h)?h[u]??q:u===0?h:q),p},se=u=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:D,event:u}),u.data&&m(f[u.dataIndex])};return n.$$set=u=>{"type"in u&&a(9,i=u.type),"showAverageMarkline"in u&&a(10,l=u.showAverageMarkline),"unit"in u&&a(0,o=u.unit),"aggregation"in u&&a(11,_=u.aggregation),"maximumFractionDigits"in u&&a(1,d=u.maximumFractionDigits),"color"in u&&a(12,h=u.color),"timeseries"in u&&a(2,f=u.timeseries),"referencePower"in u&&a(13,C=u.referencePower),"referencePowerOptions"in u&&a(14,E=u.referencePowerOptions),"labels"in u&&a(15,c=u.labels),"onclick"in u&&a(16,m=u.onclick),"$$scope"in u&&a(17,s=u.$$scope)},n.$$.update=()=>{n.$$.dirty&32263&&U(i,l,o,_,d,h,f,C,E)},[o,d,f,A,b,V,re,se,r,i,l,_,h,C,E,c,m,s,t]}class wt extends _e{constructor(e){super(),ge(this,e,vt,It,Ee,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{S as A,wt as E,ae as U,Tt as a};
