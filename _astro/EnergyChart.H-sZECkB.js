import{B as ot,f as I,t as L,S as Ie,i as Ne,s as Ce,E as st,a as rt,b as Le,c as Oe,e as re,g as Se,m as le,p as ie,u as ce,v as lt,z as Me,d as N,w as De,U as Fe,h as $,j as T,k as z,l as B,n as U,x as ye,o as oe,q as P,y as pe,r as se,I as Qe,F as he,G as de,K as $e,L as et,M as tt,V as it,T as J}from"./ECharts.C5Iir41h.js";import{g as ct,d as ft}from"./dayjs.min.2rai63wT.js";import{q as ut,C as ne,c as mt,g as Q,r as we,L as ve,s as Re,d as Be,T as Ue,t as Pe,u as at,v as ht,o as dt,w as Ve,x as _t,y as gt,f as Et,j as ae,z as We}from"./ChartLoadingSpinner.D5pNuVyy.js";import"./index.BAn-HqPX.js";function Ze(n){return n?.length!==void 0?n:Array.from(n)}function zt(n,e){n.d(1),e.delete(n.key)}function bt(n,e){L(n,1,1,()=>{e.delete(n.key)})}function wt(n,e,a,t,o,r,i,l,s,m,f,_){let h=n.length,y=r.length,b=h;const C={};for(;b--;)C[n[b].key]=b;const D=[],S=new Map,g=new Map,w=[];for(b=y;b--;){const E=_(o,r,b),p=a(E);let v=i.get(p);v?w.push(()=>v.p(E,e)):(v=m(p,E),v.c()),S.set(p,D[b]=v),p in C&&g.set(p,Math.abs(b-C[p]))}const u=new Set,d=new Set;function A(E){I(E,1),E.m(l,f),i.set(E.key,E),f=E.first,y--}for(;h&&y;){const E=D[y-1],p=n[h-1],v=E.key,c=p.key;E===p?(f=E.first,h--,y--):S.has(c)?!i.has(v)||u.has(v)?A(E):d.has(c)?h--:g.get(v)>g.get(c)?(d.add(v),A(E)):(u.add(c),h--):(s(p,i),h--)}for(;h--;){const E=n[h];S.has(E.key)||s(E,i)}for(;y;)A(D[y-1]);return ot(w),D}var me={exports:{}},At=me.exports,He;function kt(){return He||(He=1,function(n,e){(function(a,t){n.exports=t()})(At,function(){return function(a,t){t.prototype.isSameOrBefore=function(o,r){return this.isSame(o,r)||this.isBefore(o,r)}}})}(me)),me.exports}var Dt=kt();const yt=ct(Dt);ft.extend(yt);const ue={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},H={MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""},jt={GAS:"GAS",ELECTRICITY:"ELECTRICITY"},pt=300,vt=(n,e=pt)=>{let a;const t=()=>{clearTimeout(a)},o=function(...r){t(),a=setTimeout(()=>n.apply(this,r),e)};return o.cleanup=t,o};function It(n){let e,a;return e=new mt({props:{color:n[3]}}),{c(){ce(e.$$.fragment)},l(t){ie(e.$$.fragment,t)},m(t,o){le(e,t,o),a=!0},p(t,o){const r={};o&8&&(r.color=t[3]),e.$set(r)},i(t){a||(I(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){re(e,t)}}}function Nt(n){let e,a,t,o;function r(s){n[7](s)}function i(s){n[8](s)}let l={init:rt,options:n[2],notMerge:!0,$$slots:{default:[It]},$$scope:{ctx:n}};return n[1]!==void 0&&(l.chart=n[1]),n[0]!==void 0&&(l.chartContainerDOMRect=n[0]),e=new st({props:l}),Le.push(()=>Oe(e,"chart",r)),Le.push(()=>Oe(e,"chartContainerDOMRect",i)),{c(){ce(e.$$.fragment)},l(s){ie(e.$$.fragment,s)},m(s,m){le(e,s,m),o=!0},p(s,[m]){const f={};m&4&&(f.options=s[2]),m&32776&&(f.$$scope={dirty:m,ctx:s}),!a&&m&2&&(a=!0,f.chart=s[1],Se(()=>a=!1)),!t&&m&1&&(t=!0,f.chartContainerDOMRect=s[0],Se(()=>t=!1)),e.$set(f)},i(s){o||(I(e.$$.fragment,s),o=!0)},o(s){L(e.$$.fragment,s),o=!1},d(s){re(e,s)}}}const Ae={show:!1,windowSize:12,showAll:!1},Ct=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const o=n[t],r=o.stack;if(!r)continue;e[r]||(e[r]={stackStart:[],stackEnd:[]});const i=e[r],l=o.data[a];(()=>{const m=l&&l.value?l.value:l;if(!m||m===null)return!1;switch(typeof m){case"number":return!isNaN(m);case"string":return m!=="-"}})()&&(i.stackStart[a]==null&&(i.stackStart[a]=t),i.stackEnd[a]=t)}return e},Tt=n=>{const e=Ct(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=Re(Be);continue}const o=t.data,r=o.length,i=e[t.stack];for(let l=0;l<r;++l){const s=i.stackEnd[l]===a,m=o[l]&&o[l].value||o[l],f=Re(s?Be:0);o[l]={value:m,itemStyle:f}}}return n},Ke="click",ke="mousemove";function Lt(n,e,a){let t,{isTinyScreen:o=!1}=e,{chartOptions:r}=e,{onclick:i=ut}=e,l,s={},m,f="",_="";const h=(g,w)=>{const{color:u,categories:d,series:A,xAxisLabelFormatter:E,yAxisLabelFormatter:p=M=>Q(M),tooltipFormatter:v,dataZoomLabelFormatter:c,dataZoomOptions:O={}}=g,{show:X=Ae.show,windowSize:K=Ae.windowSize,minWindowSize:j=K?Math.floor(K/2):void 0,showAll:_e=Ae.showAll}=O;f="",_="",a(4,o=(()=>{if(!w)return!1;const{width:M,height:Z}=w;switch(screen.orientation.angle){case 0:return M<=Pe&&Z<=Ue;case 90:return M<=Ue&&Z<=Pe}return!1})());const ee={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:v},Y={containLabel:!0,left:0,right:0,top:0,bottom:0},W=d.length,ge={type:"category",data:d,axisLabel:{color:ve,formatter:E,hideOverlap:!0,showMinLabel:!(o&&W>10||W>12)},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:we},splitLine:{show:!0,lineStyle:we,showMinLine:!1,showMaxLine:!1,interval:W>50?10:2}};if(a(2,s={color:u,tooltip:ee,grid:Y,xAxis:ge,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:ve,showMinLabel:!1,showMaxLabel:!1,formatter:p},splitLine:{lineStyle:we,showMaxLine:!1}},series:Tt(A)}),X||o&&W>K){Y.bottom=55;const M=j?j*100/W:void 0,Z=100;let x=d[0];if(!_e){const q=W-1;x=d[q-K]}a(2,s.dataZoom=[{type:"inside",startValue:x,end:Z,minSpan:M},{show:!0,type:"slider",startValue:x,end:Z,minSpan:M,labelFormatter:c}],s)}},b=vt(g=>{!o||g.event?.type!==ke||(_=g.name)},500),C=g=>{if(!o){i(g);return}b.cleanup();const w=g.name;if(f&&w===f||_&&w===_){f="",_="",i(g);return}f=w,_=""};lt(()=>(l.on(Ke,"series",C),l.on(ke,"series",b),console.log("BaseColumnsChart - mounted",{chart:l}),()=>{l.off(Ke,C),l.off(ke,b),console.log("BaseColumnsChart - destroyed",{chart:l})}));function D(g){l=g,a(1,l)}function S(g){m=g,a(0,m)}return n.$$set=g=>{"isTinyScreen"in g&&a(4,o=g.isTinyScreen),"chartOptions"in g&&a(5,r=g.chartOptions),"onclick"in g&&a(6,i=g.onclick)},n.$$.update=()=>{n.$$.dirty&32&&a(3,t=r.color[1]??r.color[0]??ne),n.$$.dirty&33&&h(r,m)},[m,l,s,t,o,r,i,D,S]}class Ot extends Ie{constructor(e){super(),Ne(this,e,Lt,Nt,Ce,{isTinyScreen:4,chartOptions:5,onclick:6})}}function ze(n){let e,a;return{c(){e=P("span"),a=pe(n[3])},l(t){e=B(t,"SPAN",{});var o=U(e);a=ye(o,n[3]),o.forEach(N)},m(t,o){$(t,e,o),T(e,a)},p(t,o){o&8&&De(a,t[3])},d(t){t&&N(e)}}}function St(n){let e,a,t,o,r,i,l=Q(n[1],n[4])+"",s,m,f=n[3]&&ze(n);return{c(){e=P("div"),a=P("span"),t=pe(n[0]),o=se(),r=P("div"),i=P("span"),s=pe(l),m=se(),f&&f.c(),this.h()},l(_){e=B(_,"DIV",{class:!0});var h=U(e);a=B(h,"SPAN",{});var y=U(a);t=ye(y,n[0]),y.forEach(N),o=oe(h),r=B(h,"DIV",{class:!0,style:!0});var b=U(r);i=B(b,"SPAN",{class:!0});var C=U(i);s=ye(C,l),C.forEach(N),m=oe(b),f&&f.l(b),b.forEach(N),h.forEach(N),this.h()},h(){z(i,"class","text-sm tabular-nums"),z(r,"class","text-sm font-semibold"),Fe(r,"color",n[2]),z(e,"class","flex flex-col md:flex-row md:items-center md:gap-2")},m(_,h){$(_,e,h),T(e,a),T(a,t),T(e,o),T(e,r),T(r,i),T(i,s),T(r,m),f&&f.m(r,null)},p(_,[h]){h&1&&De(t,_[0]),h&18&&l!==(l=Q(_[1],_[4])+"")&&De(s,l),_[3]?f?f.p(_,h):(f=ze(_),f.c(),f.m(r,null)):f&&(f.d(1),f=null),h&4&&Fe(r,"color",_[2])},i:Me,o:Me,d(_){_&&N(e),f&&f.d()}}}function Mt(n,e,a){let{label:t}=e,{value:o}=e,{valueColor:r=ve}=e,{unit:i}=e,{maximumFractionDigits:l=at}=e;return n.$$set=s=>{"label"in s&&a(0,t=s.label),"value"in s&&a(1,o=s.value),"valueColor"in s&&a(2,r=s.valueColor),"unit"in s&&a(3,i=s.unit),"maximumFractionDigits"in s&&a(4,l=s.maximumFractionDigits)},[t,o,r,i,l]}class nt extends Ie{constructor(e){super(),Ne(this,e,Mt,St,Ce,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const Ft=n=>({}),je=n=>({}),Rt=n=>({}),Ye=n=>({});function qe(n,e,a){const t=n.slice();t[23]=e[a],t[26]=a;const o=t[3][t[26]];return t[24]=o,t}function Bt(n){let e,a;return e=new nt({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}}),{c(){ce(e.$$.fragment)},l(t){ie(e.$$.fragment,t)},m(t,o){le(e,t,o),a=!0},p(t,o){const r={};o&8&&(r.value=t[3][0]),o&1&&(r.unit=t[0]),o&2&&(r.maximumFractionDigits=t[1]),e.$set(r)},i(t){a||(I(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){re(e,t)}}}function Ut(n){let e=[],a=new Map,t,o,r=Ze(n[2]);const i=l=>l[26];for(let l=0;l<r.length;l+=1){let s=qe(n,r,l),m=i(s);a.set(m,e[l]=Xe(m,s))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=J()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);t=J()},m(l,s){for(let m=0;m<e.length;m+=1)e[m]&&e[m].m(l,s);$(l,t,s),o=!0},p(l,s){s&79&&(r=Ze(l[2]),he(),e=wt(e,s,i,1,l,r,a,t.parentNode,bt,Xe,t,qe),de())},i(l){if(!o){for(let s=0;s<r.length;s+=1)I(e[s]);o=!0}},o(l){for(let s=0;s<e.length;s+=1)L(e[s]);o=!1},d(l){l&&N(t);for(let s=0;s<e.length;s+=1)e[s].d(l)}}}function Ge(n){let e,a;return e=new nt({props:{label:n[23],value:n[3][n[26]],valueColor:n[6](n[26]),unit:n[0],maximumFractionDigits:n[1]}}),{c(){ce(e.$$.fragment)},l(t){ie(e.$$.fragment,t)},m(t,o){le(e,t,o),a=!0},p(t,o){const r={};o&4&&(r.label=t[23]),o&12&&(r.value=t[3][t[26]]),o&4&&(r.valueColor=t[6](t[26])),o&1&&(r.unit=t[0]),o&2&&(r.maximumFractionDigits=t[1]),e.$set(r)},i(t){a||(I(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){re(e,t)}}}function Xe(n,e){let a,t=!isNaN(e[24]),o,r,i=t&&Ge(e);return{key:n,first:null,c(){a=J(),i&&i.c(),o=J(),this.h()},l(l){a=J(),i&&i.l(l),o=J(),this.h()},h(){this.first=a},m(l,s){$(l,a,s),i&&i.m(l,s),$(l,o,s),r=!0},p(l,s){e=l,s&12&&(t=!isNaN(e[24])),t?i?(i.p(e,s),s&12&&I(i,1)):(i=Ge(e),i.c(),I(i,1),i.m(o.parentNode,o)):i&&(he(),L(i,1,1,()=>{i=null}),de())},i(l){r||(I(i),r=!0)},o(l){L(i),r=!1},d(l){l&&(N(a),N(o)),i&&i.d(l)}}}function xe(n){let e;const a=n[19].footer,t=Qe(a,n,n[18],je);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,r){t&&t.m(o,r),e=!0},p(o,r){t&&t.p&&(!e||r&262144)&&$e(t,a,o,o[18],e?tt(a,o[18],r,Ft):et(o[18]),je)},i(o){e||(I(t,o),e=!0)},o(o){L(t,o),e=!1},d(o){t&&t.d(o)}}}function Pt(n){let e,a,t,o,r,i,l,s,m,f,_,h,y,b;const C=[Ut,Bt],D=[];function S(d,A){return A&4&&(o=null),o==null&&(o=!!Array.isArray(d[2])),o?0:1}r=S(n,-1),i=D[r]=C[r](n);const g=n[19].headerActions,w=Qe(g,n,n[18],Ye);h=new Ot({props:{chartOptions:n[4],onclick:n[7]}});let u=n[8].footer&&xe(n);return{c(){e=P("div"),a=P("div"),t=P("div"),i.c(),l=se(),s=P("div"),w&&w.c(),m=se(),f=P("div"),_=P("div"),ce(h.$$.fragment),y=se(),u&&u.c(),this.h()},l(d){e=B(d,"DIV",{class:!0});var A=U(e);a=B(A,"DIV",{class:!0});var E=U(a);t=B(E,"DIV",{class:!0});var p=U(t);i.l(p),p.forEach(N),l=oe(E),s=B(E,"DIV",{});var v=U(s);w&&w.l(v),v.forEach(N),E.forEach(N),m=oe(A),f=B(A,"DIV",{class:!0});var c=U(f);_=B(c,"DIV",{class:!0});var O=U(_);ie(h.$$.fragment,O),O.forEach(N),c.forEach(N),y=oe(A),u&&u.l(A),A.forEach(N),this.h()},h(){z(t,"class","flex justify-center gap-4 md:items-center md:justify-start"),z(a,"class","flex flex-col gap-4 sm:flex-row sm:flex-wrap sm:justify-between"),z(_,"class","absolute top-0 right-0 bottom-0 left-0"),z(f,"class","relative min-h-[200px] grow"),z(e,"class","flex min-h-full grow flex-col gap-2")},m(d,A){$(d,e,A),T(e,a),T(a,t),D[r].m(t,null),T(a,l),T(a,s),w&&w.m(s,null),T(e,m),T(e,f),T(f,_),le(h,_,null),T(e,y),u&&u.m(e,null),b=!0},p(d,[A]){let E=r;r=S(d,A),r===E?D[r].p(d,A):(he(),L(D[E],1,1,()=>{D[E]=null}),de(),i=D[r],i?i.p(d,A):(i=D[r]=C[r](d),i.c()),I(i,1),i.m(t,null)),w&&w.p&&(!b||A&262144)&&$e(w,g,d,d[18],b?tt(g,d[18],A,Rt):et(d[18]),Ye);const p={};A&16&&(p.chartOptions=d[4]),h.$set(p),d[8].footer?u?(u.p(d,A),A&256&&I(u,1)):(u=xe(d),u.c(),I(u,1),u.m(e,null)):u&&(he(),L(u,1,1,()=>{u=null}),de())},i(d){b||(I(i),I(w,d),I(h.$$.fragment,d),I(u),b=!0)},o(d){L(i),L(w,d),L(h.$$.fragment,d),L(u),b=!1},d(d){d&&N(e),D[r].d(),w&&w.d(d),re(h),u&&u.d()}}}const Je={PLAIN:"PLAIN",REPARTITION:"REPARTITION",EXCEEDANCE:"EXCEEDANCE"};function Vt(n,e,a){let{$$slots:t={},$$scope:o}=e;const r=it(t);let{type:i=Je.PLAIN}=e,{showAverageMarkline:l=!1}=e,{unit:s=ue.UNDEFINED}=e,{aggregation:m=H.UNDEFINED}=e,{maximumFractionDigits:f=at}=e,{dataZoomOptions:_=void 0}=e,{color:h=ne}=e,{timeseries:y=[]}=e,{referencePower:b=void 0}=e,{referencePowerOptions:C=ht}=e,{labels:D=["Consumption","Exceedance"]}=e,{onclick:S=dt}=e,g=!1,w=[0,NaN],u={color:[],categories:[],series:[]};const d=(c,O,X,K,j,_e,ee,Y,W,ge)=>{g=A(X,K);const Ee=!!W,M=c===Je.REPARTITION;let Z=0,x=0;const q=Y.reduce((k,F)=>{const{startedAt:G,value:V=NaN,anotherValue:R=NaN}=F;return Z+=V??0,x+=R??0,k.startedAtData.push(G),M?(k.valueData.push(V),k.anotherValueData.push(R),k):(k.valueData.push(V),k)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,u.color=Array.isArray(ee)?ee:[ee],u),a(4,u.categories=q.startedAtData,u),M||Ee){a(3,w=[Z,x]);const k={type:"bar",stack:"energy",name:D[0],data:q.valueData},F={type:"bar",stack:"energy",name:D[1],data:q.anotherValueData};a(4,u.series=[k,F],u)}else{a(3,w=[Z,NaN]);const k={type:"bar",data:q.valueData};a(4,u.series=[k],u)}u.series.forEach(k=>{if(O){let F=k.markLine;const G={type:"average",label:{fontWeight:"bold",position:"insideEndTop",backgroundColor:"white",padding:2,borderRadius:5,textBorderColor:"white",textBorderWidth:3,formatter:V=>Q(V.value,j)}};if(F){const{symbol:V=Ve,data:R=[]}=F;k.markLine={symbol:V,data:[...R,G]}}else k.markLine={symbol:Ve,data:[G]}}k.cursor=g?"zoom-in":"default"}),console.log("EnergyChart.updateChartOptions",{type:c,showAverageMarkline:O,unit:X,aggregation:K,maximumFractionDigits:j,timeseries:Y,isDrilldownEnabled:g,hasReferencePower:Ee,referencePower:W,referencePowerOptions:ge,data:q});let te=_t,fe=k=>gt(k.startedAt);switch(K){case H.MONTH:te=We,fe=k=>We(k.startedAt);break;case H.WEEK:te=ae,fe=k=>`${ae(k.startedAt)} - ${ae(k.endedAt)}`;break;case H.DAY:te=ae,fe=k=>ae(k.startedAt);break}a(4,u.xAxisLabelFormatter=te,u),a(4,u.tooltipFormatter=k=>{const F=k;let G=Y[F[0].dataIndex],V=0,R="";return R+=`<div>${fe(G)}</div>`,F.reverse().forEach(be=>{G=Y[be.dataIndex];const Te=be.value;V+=Te,R+=Et({color:be.color,value:`${Q(Te,j)} ${X}`})}),M&&(R+='<div style="padding-top: 5px;"><hr>',R+=`<span style="float:right;margin-left:20px;font-weight:600">${Q(V,j)} ${X}</span>`,R+="</div>"),R},u),a(4,u.dataZoomLabelFormatter=(k,F)=>te(F),u),a(4,u.dataZoomOptions=_e,u)},A=(c,O)=>{switch(c){case ue.M3:return![H.HOUR,H.MINUTES,H.UNDEFINED].includes(O);case ue.KW:case ue.KWH:return![H.MINUTES,H.UNDEFINED].includes(O);default:return!1}},E=(c=0)=>Array.isArray(D)?D[c]??"":D,p=(c=0)=>{let O=ne;return h&&(O=Array.isArray(h)?h[c]??ne:c===0?h:ne),O},v=c=>{c.data&&S(y[c.dataIndex])};return n.$$set=c=>{"type"in c&&a(9,i=c.type),"showAverageMarkline"in c&&a(10,l=c.showAverageMarkline),"unit"in c&&a(0,s=c.unit),"aggregation"in c&&a(11,m=c.aggregation),"maximumFractionDigits"in c&&a(1,f=c.maximumFractionDigits),"dataZoomOptions"in c&&a(12,_=c.dataZoomOptions),"color"in c&&a(13,h=c.color),"timeseries"in c&&a(14,y=c.timeseries),"referencePower"in c&&a(15,b=c.referencePower),"referencePowerOptions"in c&&a(16,C=c.referencePowerOptions),"labels"in c&&a(2,D=c.labels),"onclick"in c&&a(17,S=c.onclick),"$$scope"in c&&a(18,o=c.$$scope)},n.$$.update=()=>{n.$$.dirty&130563&&d(i,l,s,m,f,_,h,y,b,C)},[s,f,D,w,u,E,p,v,r,i,l,m,_,h,y,b,C,S,o,t]}class Yt extends Ie{constructor(e){super(),Ne(this,e,Vt,Pt,Ce,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,dataZoomOptions:12,color:13,timeseries:14,referencePower:15,referencePowerOptions:16,labels:2,onclick:17})}}export{H as A,Yt as E,ue as U,Je as a,jt as b,zt as d,Ze as e,bt as o,wt as u};
