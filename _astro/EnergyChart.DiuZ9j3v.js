import{S as re,i as ce,s as fe,E as Be,a as Ke,b as He,c as We,e as W,t as L,f as b,g as je,m as j,p as Y,u as q,v as Ye,z as de,d as I,w as te,A as Ee,h as H,j as k,k as O,l as y,n as C,x as ae,o as U,q as w,y as ne,r as P,B as Te,C as se,D as oe,F as Se,G as pe,H as Oe,I as qe,J as De}from"./ECharts.BSvq92Jr.js";import"./dayjs.min.Cbbdfn5l.js";import{k as Ge,C as K,c as ze,l as ee,L as le,m as Ae,d as be,g as ie,n as Me,o as Je,p as Xe,q as ke,r as Ie,s as Qe,t as Ze,f as xe}from"./ChartLoadingSpinner.DiAs7Kny.js";import"./index.CV-e_qxF.js";const X={KW:"kW",KWH:"kWh",M3:"mÂ³",UNDEFINED:""},S={DAY:"day",HOUR:"hour",MINUTES:"15_minutes",UNDEFINED:""};function $e(n){let e,a;return e=new ze({props:{color:n[2]}}),{c(){q(e.$$.fragment)},l(t){Y(e.$$.fragment,t)},m(t,l){j(e,t,l),a=!0},p(t,l){const s={};l&4&&(s.color=t[2]),e.$set(s)},i(t){a||(b(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){W(e,t)}}}function et(n){let e,a,t;function l(o){n[5](o)}let s={init:Ke,options:n[1],notMerge:!0,$$slots:{default:[$e]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.chart=n[0]),e=new Be({props:s}),He.push(()=>We(e,"chart",l)),{c(){q(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,i){j(e,o,i),t=!0},p(o,[i]){const r={};i&2&&(r.options=o[1]),i&132&&(r.$$scope={dirty:i,ctx:o}),!a&&i&1&&(a=!0,r.chart=o[0],je(()=>a=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){L(e.$$.fragment,o),t=!1},d(o){W(e,o)}}}const tt=n=>{const e={};for(let a=0;a<n[0].data.length;++a)for(let t=0;t<n.length;++t){const l=n[t],s=l.stack;if(!s)continue;e[s]||(e[s]={stackStart:[],stackEnd:[]});const o=e[s],i=l.data[a];i&&!isNaN(i)&&(o.stackStart[a]==null&&(o.stackStart[a]=t),o.stackEnd[a]=t)}return e},at=n=>{const e=tt(n);for(let a=0;a<n.length;++a){const t=n[a];if(!t.stack){t.itemStyle=Ae(be);continue}const l=t.data,s=l.length,o=e[t.stack];for(let i=0;i<s;++i){const r=o.stackEnd[i]===a;l[i]={value:l[i],itemStyle:Ae(r?be:0)}}}return n};function nt(n,e,a){let t,{chartOptions:l}=e,{onclick:s=Ge}=e,o,i={};const r=u=>{const{color:h,categories:c,series:N,xAxisLabelFormatter:g,tooltipFormatter:m}=u;console.log(u);const _={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:m},d={containLabel:!0,left:10,right:10,top:10,bottom:10},v=c.length,E={type:"category",data:c,axisLabel:{color:le,formatter:g,showMinLabel:v<50},axisTick:{show:!1,alignWithLabel:!0},axisLine:{lineStyle:ee},splitLine:{show:!0,lineStyle:ee,showMinLine:!1,showMaxLine:!1,interval:v>50?10:2}};a(1,i={color:h,tooltip:_,grid:d,xAxis:E,yAxis:{type:"value",position:"right",axisLabel:{verticalAlign:"bottom",padding:[0,-10,2,0],color:le,showMinLabel:!1,showMaxLabel:!1},splitLine:{lineStyle:ee,showMaxLine:!1}},series:at(N)})};Ye(()=>(o.on("click",s),console.log("BaseColumnsChart - mounted",{chart:o}),()=>{o.off("click",s),console.log("BaseColumnsChart - destroyed",{chart:o})}));function D(u){o=u,a(0,o)}return n.$$set=u=>{"chartOptions"in u&&a(3,l=u.chartOptions),"onclick"in u&&a(4,s=u.onclick)},n.$$.update=()=>{n.$$.dirty&8&&a(2,t=l.color[0]??K),n.$$.dirty&8&&r(l)},[o,i,t,l,s,D]}class st extends re{constructor(e){super(),ce(this,e,nt,et,fe,{chartOptions:3,onclick:4})}}function ve(n){let e,a;return{c(){e=w("span"),a=ne(n[3])},l(t){e=y(t,"SPAN",{});var l=C(e);a=ae(l,n[3]),l.forEach(I)},m(t,l){H(t,e,l),k(e,a)},p(t,l){l&8&&te(a,t[3])},d(t){t&&I(e)}}}function ot(n){let e,a,t,l,s,o,i=ie(n[1],n[4])+"",r,D,u=n[3]&&ve(n);return{c(){e=w("div"),a=w("span"),t=ne(n[0]),l=P(),s=w("div"),o=w("span"),r=ne(i),D=P(),u&&u.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var c=C(e);a=y(c,"SPAN",{});var N=C(a);t=ae(N,n[0]),N.forEach(I),l=U(c),s=y(c,"DIV",{class:!0,style:!0});var g=C(s);o=y(g,"SPAN",{class:!0});var m=C(o);r=ae(m,i),m.forEach(I),D=U(g),u&&u.l(g),g.forEach(I),c.forEach(I),this.h()},h(){O(o,"class","text-sm tabular-nums"),O(s,"class","text-sm font-semibold"),Ee(s,"color",n[2]),O(e,"class","flex items-center gap-2")},m(h,c){H(h,e,c),k(e,a),k(a,t),k(e,l),k(e,s),k(s,o),k(o,r),k(s,D),u&&u.m(s,null)},p(h,[c]){c&1&&te(t,h[0]),c&18&&i!==(i=ie(h[1],h[4])+"")&&te(r,i),h[3]?u?u.p(h,c):(u=ve(h),u.c(),u.m(s,null)):u&&(u.d(1),u=null),c&4&&Ee(s,"color",h[2])},i:de,o:de,d(h){h&&I(e),u&&u.d()}}}function lt(n,e,a){let{label:t}=e,{value:l}=e,{valueColor:s=le}=e,{unit:o}=e,{maximumFractionDigits:i=Me}=e;return n.$$set=r=>{"label"in r&&a(0,t=r.label),"value"in r&&a(1,l=r.value),"valueColor"in r&&a(2,s=r.valueColor),"unit"in r&&a(3,o=r.unit),"maximumFractionDigits"in r&&a(4,i=r.maximumFractionDigits)},[t,l,s,o,i]}class Re extends re{constructor(e){super(),ce(this,e,lt,ot,fe,{label:0,value:1,valueColor:2,unit:3,maximumFractionDigits:4})}}const it=n=>({}),Le=n=>({}),rt=n=>({}),Ne=n=>({});function ye(n){let e,a,t,l;e=new Re({props:{label:n[5](0),value:n[3][0],valueColor:n[6](0),unit:n[0],maximumFractionDigits:n[1]}});let s=n[3][1]&&Ce(n);return{c(){q(e.$$.fragment),a=P(),s&&s.c(),t=De()},l(o){Y(e.$$.fragment,o),a=U(o),s&&s.l(o),t=De()},m(o,i){j(e,o,i),H(o,a,i),s&&s.m(o,i),H(o,t,i),l=!0},p(o,i){const r={};i&8&&(r.value=o[3][0]),i&1&&(r.unit=o[0]),i&2&&(r.maximumFractionDigits=o[1]),e.$set(r),o[3][1]?s?(s.p(o,i),i&8&&b(s,1)):(s=Ce(o),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(se(),L(s,1,1,()=>{s=null}),oe())},i(o){l||(b(e.$$.fragment,o),b(s),l=!0)},o(o){L(e.$$.fragment,o),L(s),l=!1},d(o){o&&(I(a),I(t)),W(e,o),s&&s.d(o)}}}function Ce(n){let e,a;return e=new Re({props:{label:n[5](1),value:n[3][1],valueColor:n[6](1),unit:n[0],maximumFractionDigits:n[1]}}),{c(){q(e.$$.fragment)},l(t){Y(e.$$.fragment,t)},m(t,l){j(e,t,l),a=!0},p(t,l){const s={};l&8&&(s.value=t[3][1]),l&1&&(s.unit=t[0]),l&2&&(s.maximumFractionDigits=t[1]),e.$set(s)},i(t){a||(b(e.$$.fragment,t),a=!0)},o(t){L(e.$$.fragment,t),a=!1},d(t){W(e,t)}}}function we(n){let e;const a=n[18].footer,t=Te(a,n,n[17],Le);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,s){t&&t.m(l,s),e=!0},p(l,s){t&&t.p&&(!e||s&131072)&&Se(t,a,l,l[17],e?Oe(a,l[17],s,it):pe(l[17]),Le)},i(l){e||(b(t,l),e=!0)},o(l){L(t,l),e=!1},d(l){t&&t.d(l)}}}function ct(n){let e,a,t,l,s,o,i,r,D,u,h,c=n[2].length>0&&ye(n);const N=n[18].headerActions,g=Te(N,n,n[17],Ne);D=new st({props:{chartOptions:n[4],onclick:n[7]}});let m=n[8].footer&&we(n);return{c(){e=w("div"),a=w("div"),t=w("div"),c&&c.c(),l=P(),s=w("div"),g&&g.c(),o=P(),i=w("div"),r=w("div"),q(D.$$.fragment),u=P(),m&&m.c(),this.h()},l(_){e=y(_,"DIV",{class:!0});var d=C(e);a=y(d,"DIV",{class:!0});var v=C(a);t=y(v,"DIV",{class:!0});var E=C(t);c&&c.l(E),E.forEach(I),l=U(v),s=y(v,"DIV",{});var V=C(s);g&&g.l(V),V.forEach(I),v.forEach(I),o=U(d),i=y(d,"DIV",{class:!0});var G=C(i);r=y(G,"DIV",{class:!0});var z=C(r);Y(D.$$.fragment,z),z.forEach(I),G.forEach(I),u=U(d),m&&m.l(d),d.forEach(I),this.h()},h(){O(t,"class","flex items-center gap-4"),O(a,"class","flex items-center justify-between"),O(r,"class","absolute top-0 right-0 bottom-0 left-0"),O(i,"class","relative grow"),O(e,"class","flex h-full grow flex-col gap-2")},m(_,d){H(_,e,d),k(e,a),k(a,t),c&&c.m(t,null),k(a,l),k(a,s),g&&g.m(s,null),k(e,o),k(e,i),k(i,r),j(D,r,null),k(e,u),m&&m.m(e,null),h=!0},p(_,[d]){_[2].length>0?c?(c.p(_,d),d&4&&b(c,1)):(c=ye(_),c.c(),b(c,1),c.m(t,null)):c&&(se(),L(c,1,1,()=>{c=null}),oe()),g&&g.p&&(!h||d&131072)&&Se(g,N,_,_[17],h?Oe(N,_[17],d,rt):pe(_[17]),Ne);const v={};d&16&&(v.chartOptions=_[4]),D.$set(v),_[8].footer?m?(m.p(_,d),d&256&&b(m,1)):(m=we(_),m.c(),b(m,1),m.m(e,null)):m&&(se(),L(m,1,1,()=>{m=null}),oe())},i(_){h||(b(c),b(g,_),b(D.$$.fragment,_),b(m),h=!0)},o(_){L(c),L(g,_),L(D.$$.fragment,_),L(m),h=!1},d(_){_&&I(e),c&&c.d(),g&&g.d(_),W(D),m&&m.d()}}}const Fe={PLAIN:"PLAIN",REPARTITION:"REPARTITION"};function ft(n,e,a){let{$$slots:t={},$$scope:l}=e;const s=qe(t);let{type:o=Fe.PLAIN}=e,{showAverageMarkline:i=!1}=e,{unit:r=X.UNDEFINED}=e,{aggregation:D=S.UNDEFINED}=e,{maximumFractionDigits:u=Me}=e,{color:h=K}=e,{timeseries:c=[]}=e,{referencePower:N=void 0}=e,{referencePowerOptions:g=Je}=e,{labels:m=["Consumption","Exceedance"]}=e,{onclick:_=Xe}=e,d=!1,v=[0,NaN],E={color:[],categories:[],series:[]};const V=(f,p,Q,Z,ue,x,J,me,Ve)=>{d=G(Q,Z);const he=!!me,_e=f===Fe.REPARTITION;let $=0,ge=0;const B=J.reduce((A,F)=>{const{startedAt:M,value:T=NaN,anotherValue:R=NaN}=F;return $+=T??0,ge+=R??0,A.startedAtData.push(M),_e?(A.valueData.push(T),A.anotherValueData.push(R),A):(A.valueData.push(T),A)},{startedAtData:[],valueData:[],anotherValueData:[]});if(a(4,E.color=Array.isArray(x)?x:[x],E),a(4,E.categories=B.startedAtData,E),_e||he){a(3,v=[$,ge]);const A={type:"bar",stack:"energy",data:B.valueData},F={type:"bar",stack:"energy",data:B.anotherValueData};a(4,E.series=[A,F],E)}else{a(3,v=[$,NaN]);const A={type:"bar",data:B.valueData};a(4,E.series=[A],E)}E.series.forEach(A=>{if(p){let F=A.markLine;if(F){const{symbol:M=ke,data:T=[]}=F;A.markLine={symbol:M,data:[...T,Ie]}}else A.markLine={symbol:ke,data:[Ie]}}}),console.log("EnergyChart.updateChartOptions",{type:f,showAverageMarkline:p,unit:Q,aggregation:Z,maximumFractionDigits:ue,timeseries:J,isDrilldownEnabled:d,hasReferencePower:he,referencePower:me,referencePowerOptions:Ve,data:B}),[S.DAY,S.HOUR,S.MINUTES].includes(Z)&&(a(4,E.xAxisLabelFormatter=Qe,E),a(4,E.tooltipFormatter=A=>{const F=A;let M=J[F[0].dataIndex],T="";return T+=`<div>${Ze(M.startedAt)}</div>`,F.forEach(R=>{M=J[R.dataIndex],T+=xe({color:R.color,value:`${ie(R.value,ue)} ${Q}`})}),T},E))},G=(f,p)=>{switch(f){case X.M3:return![S.HOUR,S.MINUTES,S.UNDEFINED].includes(p);case X.KW:case X.KWH:return![S.MINUTES,S.UNDEFINED].includes(p);default:return!1}},z=(f=0)=>Array.isArray(m)?m[f]??"":m,Ue=(f=0)=>{let p=K;return h&&(p=Array.isArray(h)?h[f]??K:f===0?h:K),p},Pe=f=>{console.log("EnergyChart.onChartClick",{isDrilldownEnabled:d,event:f}),f.data&&_(c[f.dataIndex])};return n.$$set=f=>{"type"in f&&a(9,o=f.type),"showAverageMarkline"in f&&a(10,i=f.showAverageMarkline),"unit"in f&&a(0,r=f.unit),"aggregation"in f&&a(11,D=f.aggregation),"maximumFractionDigits"in f&&a(1,u=f.maximumFractionDigits),"color"in f&&a(12,h=f.color),"timeseries"in f&&a(2,c=f.timeseries),"referencePower"in f&&a(13,N=f.referencePower),"referencePowerOptions"in f&&a(14,g=f.referencePowerOptions),"labels"in f&&a(15,m=f.labels),"onclick"in f&&a(16,_=f.onclick),"$$scope"in f&&a(17,l=f.$$scope)},n.$$.update=()=>{n.$$.dirty&32263&&V(o,i,r,D,u,h,c,N,g)},[r,u,c,v,E,z,Ue,Pe,s,o,i,D,h,N,g,m,_,l,t]}class gt extends re{constructor(e){super(),ce(this,e,ft,ct,fe,{type:9,showAverageMarkline:10,unit:0,aggregation:11,maximumFractionDigits:1,color:12,timeseries:2,referencePower:13,referencePowerOptions:14,labels:15,onclick:16})}}export{S as A,gt as E,X as U};
