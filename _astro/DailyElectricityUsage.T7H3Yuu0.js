import{S as Z,i as $,s as tt,E as ft,a as ht,b as gt,c as mt,d as g,e as L,t as O,f as I,g as _t,h as R,j as k,m as T,k as _,l as v,n as A,o as bt,p as F,q as x,r as pt,u as U,v as Ct,w as yt,x as vt,y as At}from"./ECharts.D0fEGlje.js";import{d as K}from"./dayjs.min.Cbbdfn5l.js";import"./index.CRcaC6jV.js";import{C as X,a as xt,D as kt,b as Dt,W as Et,c as St,h as H,d as J,L as wt,e as Lt}from"./ChartLoadingSpinner.BJizMXA0.js";function Q(n){let t,e,r,a;return{c(){t=x("div"),e=x("span"),r=At(n[0]),this.h()},l(o){t=v(o,"DIV",{class:!0});var c=A(t);e=v(c,"SPAN",{class:!0,title:!0});var s=A(e);r=vt(s,n[0]),s.forEach(g),c.forEach(g),this.h()},h(){_(e,"class","text-[0.7rem]"),_(e,"title",a="Unit: "+n[0]),_(t,"class","absolute top-2 left-4 z-10")},m(o,c){R(o,t,c),k(t,e),k(e,r)},p(o,c){c&1&&yt(r,o[0]),c&1&&a!==(a="Unit: "+o[0])&&_(e,"title",a)},d(o){o&&g(t)}}}function Ot(n){let t,e;return t=new St({props:{color:n[1]}}),{c(){U(t.$$.fragment)},l(r){F(t.$$.fragment,r)},m(r,a){T(t,r,a),e=!0},p(r,a){const o={};a&2&&(o.color=r[1]),t.$set(o)},i(r){e||(I(t.$$.fragment,r),e=!0)},o(r){O(t.$$.fragment,r),e=!1},d(r){L(t,r)}}}function It(n){let t,e,r,a,o,c,s=n[0]&&Q(n);function y(l){n[13](l)}let b={init:ht,options:n[3],notMerge:!0,$$slots:{default:[Ot]},$$scope:{ctx:n}};return n[2]!==void 0&&(b.chart=n[2]),a=new ft({props:b}),gt.push(()=>mt(a,"chart",y)),{c(){t=x("div"),s&&s.c(),e=pt(),r=x("div"),U(a.$$.fragment),this.h()},l(l){t=v(l,"DIV",{class:!0});var u=A(t);s&&s.l(u),e=bt(u),r=v(u,"DIV",{class:!0});var d=A(r);F(a.$$.fragment,d),d.forEach(g),u.forEach(g),this.h()},h(){_(r,"class","absolute top-0 right-0 bottom-0 left-0 overflow-hidden rounded-lg border border-gray-100"),_(t,"class","relative grow")},m(l,u){R(l,t,u),s&&s.m(t,null),k(t,e),k(t,r),T(a,r,null),c=!0},p(l,[u]){l[0]?s?s.p(l,u):(s=Q(l),s.c(),s.m(t,e)):s&&(s.d(1),s=null);const d={};u&8&&(d.options=l[3]),u&65538&&(d.$$scope={dirty:u,ctx:l}),!o&&u&4&&(o=!0,d.chart=l[2],_t(()=>o=!1)),a.$set(d)},i(l){c||(I(a.$$.fragment,l),c=!0)},o(l){O(a.$$.fragment,l),c=!1},d(l){l&&g(t),s&&s.d(),L(a)}}}function Rt(n,t,e){let{unit:r=""}=t;const a=Dt,o=Et;let{xAxisAttribute:c="startedAt"}=t,{yAxisAttribute:s="value"}=t,{currentColor:y=X}=t,{previousColor:b=X}=t,{colorOpacity:l=.55}=t,{backgroundColor:u=xt}=t,{data:d}=t,{onclick:D=kt}=t,m,P={};const et=(i,p,N,E,W,M,rt)=>{const ot=H(E,M),it=H(W,M),{current:Y,previous:z}=i,B=Y.length-1,S=Y.reduce((f,C,h)=>{const j=h===B?E:ot,q=h===B?W:it;return f.xAxis.push(C[p]),f.current.push({value:C[N],date:C[p],itemStyle:{borderRadius:J,borderWidth:1,borderColor:j,color:j}}),f.previous.push({value:z[h][N],date:z[h][p],itemStyle:{borderRadius:J,borderWidth:1,borderColor:q,color:q}}),f},{xAxis:[],current:[],previous:[]}),w="2%",V=30,nt={top:V,bottom:V,left:"15%",right:w},st={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:"rgba(150,150,150,0.1)"}},formatter:f=>{let C="";return f.forEach(h=>{C+=`
            <div>
              <span style="display:inline-block;border-radius:10px;width:10px;height:10px;background-color:${h.color};"></span>
              <span>${K(h.data.date).format(a)}</span>
              <span style="float:right;margin-left:20px;font-weight:600">${h.value}</span>
            </div>
          `}),C}},lt={type:"category",data:S.xAxis,axisLabel:{formatter:f=>K(f).format(o),color:wt},axisLine:{show:!1},axisTick:{show:!1}},ct={type:"value",show:!1},ut={type:"bar",data:S.previous},dt={type:"bar",data:S.current,barCategoryGap:30,markLine:{symbol:["none","none"],data:[{type:"average",x:w,lineStyle:{color:E,width:2,type:"solid"},emphasis:{disabled:!0},label:{show:!0,position:"insideStartTop",fontWeight:"bold",fontSize:12,formatter:f=>Number(f.value).toFixed(3)}},{type:"average",name:"Average",x:w,lineStyle:{color:"transparent"},label:{show:!0,position:"insideStartBottom",fontSize:12,formatter:"{b}",opacity:.8}}]}};e(3,P={backgroundColor:rt,grid:nt,tooltip:st,xAxis:lt,yAxis:ct,series:[ut,dt]})},G=i=>{if(console.log("onChartClick",i),!i.data)return;const p=i.dataIndex;D({current:d.current[p],previous:d.previous[p]})};Ct(()=>(m.on("click",G),console.log("EnergyOverviewChart - mounted",{chart:m}),()=>{m.off("click",G),console.log("EnergyOverviewChart - destroyed",{chart:m})}));function at(i){m=i,e(2,m)}return n.$$set=i=>{"unit"in i&&e(0,r=i.unit),"xAxisAttribute"in i&&e(6,c=i.xAxisAttribute),"yAxisAttribute"in i&&e(7,s=i.yAxisAttribute),"currentColor"in i&&e(1,y=i.currentColor),"previousColor"in i&&e(8,b=i.previousColor),"colorOpacity"in i&&e(9,l=i.colorOpacity),"backgroundColor"in i&&e(10,u=i.backgroundColor),"data"in i&&e(11,d=i.data),"onclick"in i&&e(12,D=i.onclick)},n.$$.update=()=>{n.$$.dirty&4034&&et(d,c,s,y,b,l,u)},[r,y,m,P,a,o,c,s,b,l,u,d,D,at]}class Tt extends Z{constructor(t){super(),$(this,t,Rt,It,tt,{unit:0,tooltipDatetimeFormat:4,xAxisDatetimeFormat:5,xAxisAttribute:6,yAxisAttribute:7,currentColor:1,previousColor:8,colorOpacity:9,backgroundColor:10,data:11,onclick:12})}get tooltipDatetimeFormat(){return this.$$.ctx[4]}get xAxisDatetimeFormat(){return this.$$.ctx[5]}}function Ft(n){let t,e,r;return e=new Tt({props:{data:n[0],unit:"kWh",currentColor:Lt,onclick:n[1]}}),{c(){t=x("div"),U(e.$$.fragment),this.h()},l(a){t=v(a,"DIV",{class:!0});var o=A(t);F(e.$$.fragment,o),o.forEach(g),this.h()},h(){_(t,"class","flex h-[360px] w-[550px]")},m(a,o){R(a,t,o),T(e,t,null),r=!0},p(a,[o]){const c={};o&1&&(c.data=a[0]),e.$set(c)},i(a){r||(I(e.$$.fragment,a),r=!0)},o(a){O(e.$$.fragment,a),r=!1},d(a){a&&g(t),L(e)}}}function Ut(n,t,e){let{data:r}=t;const a=o=>{console.log("DailyElectricityUsage.onChartClick dayUsage:",o)};return n.$$set=o=>{"data"in o&&e(0,r=o.data)},[r,a]}class Yt extends Z{constructor(t){super(),$(this,t,Ut,Ft,tt,{data:0})}}export{Yt as default};
