import{S as oe,i as re,s as ae,d as N,c as W,t as C,e as I,g as z,h as O,m as U,j as y,k as M,l as S,n as V,p as D,q as j,u as Q,v as ne,w as v,o as q,x as le,r as B,y as fe,z as Z,b as ce,a as ge,f as ie,A as X}from"./ECharts.DLgQWC9u.js";import{d as F}from"./dayjs.min.2rai63wT.js";import{E as ue,a as k,U as Y,A as u,b as L,c as pe,d as me,e as he}from"./AggregationLevelSelection.CSOb1w2l.js";import{T as _e}from"./Toggle.DqEvM5Td.js";import{B as Ae}from"./ButtonsToggle.CZxKLz4t.js";import{a as Ee,b as x,f as $,c as K}from"./ChartLoadingSpinner.DKqLy1Jy.js";import"./index.Dvvzu6m2.js";function G(a){const s=a.slice(),t=s[8][s[20]];return s[21]=t,s}function J(a){const s=a.slice(),t=s[19][0]?.dataIndex;return s[20]=t,s}function Ie(a){let s,t;return s=new pe({props:{aggregation:a[4],energyType:me.ELECTRICITY,layout:a[5],onclick:a[11]}}),{c(){j(s.$$.fragment)},l(e){V(s.$$.fragment,e)},m(e,r){U(s,e,r),t=!0},p(e,r){const o={};r&16&&(o.aggregation=e[4]),r&32&&(o.layout=e[5]),s.$set(o)},i(e){t||(I(s.$$.fragment,e),t=!0)},o(e){C(s.$$.fragment,e),t=!1},d(e){W(s,e)}}}function ee(a){let s,t,e;function r(n){a[14](n)}let o={id:"showAverageToggle",label:"show average mark line"};return a[6]!==void 0&&(o.checked=a[6]),s=new _e({props:o}),ce.push(()=>ge(s,"checked",r)),{c(){j(s.$$.fragment)},l(n){V(s.$$.fragment,n)},m(n,l){U(s,n,l),e=!0},p(n,l){const T={};!t&&l&64&&(t=!0,T.checked=n[6],ie(()=>t=!1)),s.$set(T)},i(n){e||(I(s.$$.fragment,n),e=!0)},o(n){C(s.$$.fragment,n),e=!1},d(n){W(s,n)}}}function de(a){let s,t,e,r,o="Production",n,l,T,p,m,R,w="Data started at:",c,d,i=$(a[7])+"",H,h;l=new Ae({props:{name:"buttons-toggle",selected:a[0],onchange:a[10],list:[{label:"Measured",value:k.PLAIN},{label:"Repartition",value:k.REPARTITION}]}});let g=a[0]===k.PLAIN&&ee(a);return{c(){s=D("div"),t=D("div"),e=D("div"),r=D("span"),r.textContent=o,n=B(),j(l.$$.fragment),T=B(),g&&g.c(),p=B(),m=D("div"),R=D("span"),R.textContent=w,c=B(),d=D("span"),H=fe(i),this.h()},l(_){s=M(_,"DIV",{class:!0});var b=S(s);t=M(b,"DIV",{class:!0});var P=S(t);e=M(P,"DIV",{class:!0});var f=S(e);r=M(f,"SPAN",{"data-svelte-h":!0}),v(r)!=="svelte-1quta9p"&&(r.textContent=o),n=q(f),V(l.$$.fragment,f),f.forEach(N),T=q(P),g&&g.l(P),P.forEach(N),p=q(b),m=M(b,"DIV",{class:!0});var E=S(m);R=M(E,"SPAN",{"data-svelte-h":!0}),v(R)!=="svelte-1cta1ja"&&(R.textContent=w),c=q(E),d=M(E,"SPAN",{class:!0});var A=S(d);H=le(A,i),A.forEach(N),E.forEach(N),b.forEach(N),this.h()},h(){y(e,"class","flex flex-col items-center gap-2 md:flex-row"),y(t,"class","flex flex-col items-center gap-4 lg:flex-row"),y(d,"class","font-semibold"),y(m,"class","flex items-center gap-1 text-sm"),y(s,"class","flex flex-col-reverse items-center gap-4 py-4 lg:flex-row lg:justify-between lg:gap-0 lg:py-2")},m(_,b){z(_,s,b),O(s,t),O(t,e),O(e,r),O(e,n),U(l,e,null),O(t,T),g&&g.m(t,null),O(s,p),O(s,m),O(m,R),O(m,c),O(m,d),O(d,H),h=!0},p(_,b){const P={};b&1&&(P.selected=_[0]),l.$set(P),_[0]===k.PLAIN?g?(g.p(_,b),b&1&&I(g,1)):(g=ee(_),g.c(),I(g,1),g.m(t,null)):g&&(X(),C(g,1,1,()=>{g=null}),Q()),(!h||b&128)&&i!==(i=$(_[7])+"")&&ne(H,i)},i(_){h||(I(l.$$.fragment,_),I(g),h=!0)},o(_){C(l.$$.fragment,_),C(g),h=!1},d(_){_&&N(s),W(l),g&&g.d()}}}function te(a){let s,t,e=a[8].length>a[20]&&se(G(a));return{c(){e&&e.c(),s=Z()},l(r){e&&e.l(r),s=Z()},m(r,o){e&&e.m(r,o),z(r,s,o),t=!0},p(r,o){r[8].length>r[20]?e?(e.p(G(r),o),o&524544&&I(e,1)):(e=se(G(r)),e.c(),I(e,1),e.m(s.parentNode,s)):e&&(X(),C(e,1,1,()=>{e=null}),Q())},i(r){t||(I(e),t=!0)},o(r){C(e),t=!1},d(r){r&&N(s),e&&e.d(r)}}}function se(a){let s,t;return s=new he({props:{params:a[19],currentItem:a[21],aggregation:a[4],unit:a[3],showTotal:a[0]===k.REPARTITION}}),{c(){j(s.$$.fragment)},l(e){V(s.$$.fragment,e)},m(e,r){U(s,e,r),t=!0},p(e,r){const o={};r&524288&&(o.params=e[19]),r&524544&&(o.currentItem=e[21]),r&16&&(o.aggregation=e[4]),r&8&&(o.unit=e[3]),r&1&&(o.showTotal=e[0]===k.REPARTITION),s.$set(o)},i(e){t||(I(s.$$.fragment,e),t=!0)},o(e){C(s.$$.fragment,e),t=!1},d(e){W(s,e)}}}function be(a){let s,t,e=a[19]!==void 0&&te(J(a));return{c(){e&&e.c(),s=Z()},l(r){e&&e.l(r),s=Z()},m(r,o){e&&e.m(r,o),z(r,s,o),t=!0},p(r,o){r[19]!==void 0?e?(e.p(J(r),o),o&524288&&I(e,1)):(e=te(J(r)),e.c(),I(e,1),e.m(s.parentNode,s)):e&&(X(),C(e,1,1,()=>{e=null}),Q())},i(r){t||(I(e),t=!0)},o(r){C(e),t=!1},d(r){r&&N(s),e&&e.d(r)}}}function ke(a){let s,t,e,r;return e=new ue({props:{type:a[0],color:a[1],labels:a[2],unit:a[3],aggregation:a[4],timeseries:a[8],dataZoomOptions:a[9],showAverageMarkline:a[6],onclick:a[12],$$slots:{tooltip:[be,({params:o})=>({19:o}),({params:o})=>o?524288:0],footer:[de],headerActions:[Ie]},$$scope:{ctx:a}}}),{c(){s=D("div"),t=D("div"),j(e.$$.fragment),this.h()},l(o){s=M(o,"DIV",{class:!0});var n=S(s);t=M(n,"DIV",{class:!0});var l=S(t);V(e.$$.fragment,l),l.forEach(N),n.forEach(N),this.h()},h(){y(t,"class","absolute top-0 right-0 bottom-0 left-0"),y(s,"class","relative grow")},m(o,n){z(o,s,n),O(s,t),U(e,t,null),r=!0},p(o,[n]){const l={};n&1&&(l.type=o[0]),n&2&&(l.color=o[1]),n&4&&(l.labels=o[2]),n&8&&(l.unit=o[3]),n&16&&(l.aggregation=o[4]),n&256&&(l.timeseries=o[8]),n&512&&(l.dataZoomOptions=o[9]),n&64&&(l.showAverageMarkline=o[6]),n&4719097&&(l.$$scope={dirty:n,ctx:o}),e.$set(l)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){C(e.$$.fragment,o),r=!1},d(o){o&&N(s),W(e)}}}function Te(a,s,t){const e={[`${k.PLAIN}`]:["Production"],[`${k.REPARTITION}`]:["I shared","I sold to market"]},r={[`${k.PLAIN}`]:[x],[`${k.REPARTITION}`]:[Ee,x]};let o=k.PLAIN,n=r[o],l=e[o],T=Y.KWH,p=u.MONTH,m=L.YEAR,R=!1,w,c=[],d={showAll:!1},{data:i}=s;const H=f=>{t(0,o=k.PLAIN),t(3,T=Y.KWH),t(4,p=u.MONTH),t(5,m=L.YEAR),t(8,c=f.months.plain),t(7,w=c[0].startedAt),t(1,n=r[o]),t(2,l=e[o]),t(9,d={showAll:!1}),console.log("ElectricityProduction.onData",f)},h=f=>{const E=o===k.REPARTITION?"repartition":"plain";return f[E]},g=f=>{t(0,o=f),t(3,T=Y.KWH),t(6,R=!1),t(4,p=u.MONTH),t(5,m=L.YEAR),t(8,c=h(i.months)),t(7,w=c[0].startedAt),t(1,n=r[o]),t(2,l=e[o])},_=(f,E)=>{if(t(3,T=Y.KWH),t(9,d={showAll:!1}),E===L.YEAR){switch(f){case u.MONTH:t(8,c=h(i.months));break;case u.WEEK:t(8,c=h(i.weeks));break}t(7,w=c[0].startedAt),t(4,p=f),t(5,m=E);return}let A=K(F(w).startOf("month"));switch(f){case u.WEEK:t(8,c=h(i.weeksMap[A]));break;case u.DAY:t(8,c=h(i.daysMap[A]));break;case u.HOUR:A=K(w),t(8,c=h(i.hoursMap[A])),t(9,d={showAll:!0});break}t(7,w=c[0].startedAt),t(4,p=f),t(5,m=E)},b=f=>{const{startedAt:E}=f;let A=K(E);if(console.log("ElectricityProduction.onChartClick timeserie",f),t(9,d={showAll:!1}),m===L.YEAR){switch(p){case u.MONTH:t(4,p=u.WEEK),t(8,c=h(i.weeksMap[A]));break;case u.WEEK:A=K(F(E).startOf("month")),t(4,p=u.DAY),t(8,c=h(i.daysMap[A]));break}t(7,w=c[0].startedAt),t(5,m=L.MONTH);return}switch(p){case u.WEEK:A=K(F(E).startOf("month")),t(4,p=u.DAY),t(8,c=h(i.daysMap[A]));break;case u.DAY:t(4,p=u.HOUR),t(8,c=h(i.hoursMap[A]));break;case u.HOUR:t(4,p=u.MINUTES),t(8,c=h(i.minutesMap[A])),t(3,T=Y.KW);break}t(7,w=c[0].startedAt),[u.HOUR,u.MINUTES].includes(p)&&(t(5,m=L.DAY),t(9,d={showAll:!0}))};function P(f){R=f,t(6,R)}return a.$$set=f=>{"data"in f&&t(13,i=f.data)},a.$$.update=()=>{a.$$.dirty&8192&&H(i)},[o,n,l,T,p,m,R,w,c,d,g,_,b,i,P]}class De extends oe{constructor(s){super(),re(this,s,Te,ke,ae,{data:13})}}export{De as default};
