import{S as oe,i as re,s as ne,d as C,e as W,t as N,f as I,h as z,j as O,m as U,k as y,l as M,n as S,p as V,q as D,u as j,C as Q,z as X,w as ae,A as v,o as B,x as le,r as q,y as fe,B as Z,b as ce,c as ge,g as ie}from"./ECharts.DErE1pJn.js";import{d as F}from"./dayjs.min.2rai63wT.js";import{E as ue,a as T,U as Y,A as u,b as L,c as pe,d as me,e as he}from"./AggregationLevelSelection.l6X66VA6.js";import{T as _e}from"./Toggle.BZbeGocj.js";import{B as Ae}from"./ButtonsToggle.BXoMYmCt.js";import{k as Ee,o as x,m as $,n as K}from"./ChartLoadingSpinner.DaRjRDxB.js";import"./index.CsXiGAml.js";function G(n){const s=n.slice(),t=s[8][s[20]];return s[21]=t,s}function J(n){const s=n.slice(),t=s[19][0]?.dataIndex;return s[20]=t,s}function Ie(n){let s,t;return s=new pe({props:{aggregation:n[4],energyType:me.ELECTRICITY,layout:n[5],onclick:n[11]}}),{c(){j(s.$$.fragment)},l(e){V(s.$$.fragment,e)},m(e,r){U(s,e,r),t=!0},p(e,r){const o={};r&16&&(o.aggregation=e[4]),r&32&&(o.layout=e[5]),s.$set(o)},i(e){t||(I(s.$$.fragment,e),t=!0)},o(e){N(s.$$.fragment,e),t=!1},d(e){W(s,e)}}}function ee(n){let s,t,e;function r(a){n[14](a)}let o={id:"showAverageToggle",label:"show average mark line"};return n[6]!==void 0&&(o.checked=n[6]),s=new _e({props:o}),ce.push(()=>ge(s,"checked",r)),{c(){j(s.$$.fragment)},l(a){V(s.$$.fragment,a)},m(a,l){U(s,a,l),e=!0},p(a,l){const b={};!t&&l&64&&(t=!0,b.checked=a[6],ie(()=>t=!1)),s.$set(b)},i(a){e||(I(s.$$.fragment,a),e=!0)},o(a){N(s.$$.fragment,a),e=!1},d(a){W(s,a)}}}function de(n){let s,t,e,r,o="Production",a,l,b,p,m,R,w="Data started at:",c,d,i=$(n[7])+"",H,h;l=new Ae({props:{name:"buttons-toggle",selected:n[0],onchange:n[10],list:[{label:"Measured",value:T.PLAIN},{label:"Repartition",value:T.REPARTITION}]}});let g=n[0]===T.PLAIN&&ee(n);return{c(){s=D("div"),t=D("div"),e=D("div"),r=D("span"),r.textContent=o,a=q(),j(l.$$.fragment),b=q(),g&&g.c(),p=q(),m=D("div"),R=D("span"),R.textContent=w,c=q(),d=D("span"),H=fe(i),this.h()},l(_){s=M(_,"DIV",{class:!0});var k=S(s);t=M(k,"DIV",{class:!0});var P=S(t);e=M(P,"DIV",{class:!0});var f=S(e);r=M(f,"SPAN",{"data-svelte-h":!0}),v(r)!=="svelte-1quta9p"&&(r.textContent=o),a=B(f),V(l.$$.fragment,f),f.forEach(C),b=B(P),g&&g.l(P),P.forEach(C),p=B(k),m=M(k,"DIV",{class:!0});var E=S(m);R=M(E,"SPAN",{"data-svelte-h":!0}),v(R)!=="svelte-1cta1ja"&&(R.textContent=w),c=B(E),d=M(E,"SPAN",{class:!0});var A=S(d);H=le(A,i),A.forEach(C),E.forEach(C),k.forEach(C),this.h()},h(){y(e,"class","flex flex-col items-center gap-2 md:flex-row"),y(t,"class","flex flex-col items-center gap-4 lg:flex-row"),y(d,"class","font-semibold"),y(m,"class","flex items-center gap-1 text-sm"),y(s,"class","flex flex-col-reverse items-center gap-4 py-4 lg:flex-row lg:justify-between lg:gap-0 lg:py-2")},m(_,k){z(_,s,k),O(s,t),O(t,e),O(e,r),O(e,a),U(l,e,null),O(t,b),g&&g.m(t,null),O(s,p),O(s,m),O(m,R),O(m,c),O(m,d),O(d,H),h=!0},p(_,k){const P={};k&1&&(P.selected=_[0]),l.$set(P),_[0]===T.PLAIN?g?(g.p(_,k),k&1&&I(g,1)):(g=ee(_),g.c(),I(g,1),g.m(t,null)):g&&(Q(),N(g,1,1,()=>{g=null}),X()),(!h||k&128)&&i!==(i=$(_[7])+"")&&ae(H,i)},i(_){h||(I(l.$$.fragment,_),I(g),h=!0)},o(_){N(l.$$.fragment,_),N(g),h=!1},d(_){_&&C(s),W(l),g&&g.d()}}}function te(n){let s,t,e=n[8].length>n[20]&&se(G(n));return{c(){e&&e.c(),s=Z()},l(r){e&&e.l(r),s=Z()},m(r,o){e&&e.m(r,o),z(r,s,o),t=!0},p(r,o){r[8].length>r[20]?e?(e.p(G(r),o),o&524544&&I(e,1)):(e=se(G(r)),e.c(),I(e,1),e.m(s.parentNode,s)):e&&(Q(),N(e,1,1,()=>{e=null}),X())},i(r){t||(I(e),t=!0)},o(r){N(e),t=!1},d(r){r&&C(s),e&&e.d(r)}}}function se(n){let s,t;return s=new he({props:{params:n[19],currentItem:n[21],aggregation:n[4],unit:n[3],showTotal:n[0]===T.REPARTITION}}),{c(){j(s.$$.fragment)},l(e){V(s.$$.fragment,e)},m(e,r){U(s,e,r),t=!0},p(e,r){const o={};r&524288&&(o.params=e[19]),r&524544&&(o.currentItem=e[21]),r&16&&(o.aggregation=e[4]),r&8&&(o.unit=e[3]),r&1&&(o.showTotal=e[0]===T.REPARTITION),s.$set(o)},i(e){t||(I(s.$$.fragment,e),t=!0)},o(e){N(s.$$.fragment,e),t=!1},d(e){W(s,e)}}}function ke(n){let s,t,e=n[19]!==void 0&&te(J(n));return{c(){e&&e.c(),s=Z()},l(r){e&&e.l(r),s=Z()},m(r,o){e&&e.m(r,o),z(r,s,o),t=!0},p(r,o){r[19]!==void 0?e?(e.p(J(r),o),o&524288&&I(e,1)):(e=te(J(r)),e.c(),I(e,1),e.m(s.parentNode,s)):e&&(Q(),N(e,1,1,()=>{e=null}),X())},i(r){t||(I(e),t=!0)},o(r){N(e),t=!1},d(r){r&&C(s),e&&e.d(r)}}}function Te(n){let s,t,e,r;return e=new ue({props:{type:n[0],color:n[1],labels:n[2],unit:n[3],aggregation:n[4],timeseries:n[8],dataZoomOptions:n[9],showAverageMarkline:n[6],onclick:n[12],$$slots:{tooltip:[ke,({params:o})=>({19:o}),({params:o})=>o?524288:0],footer:[de],headerActions:[Ie]},$$scope:{ctx:n}}}),{c(){s=D("div"),t=D("div"),j(e.$$.fragment),this.h()},l(o){s=M(o,"DIV",{class:!0});var a=S(s);t=M(a,"DIV",{class:!0});var l=S(t);V(e.$$.fragment,l),l.forEach(C),a.forEach(C),this.h()},h(){y(t,"class","absolute top-0 right-0 bottom-0 left-0"),y(s,"class","relative grow")},m(o,a){z(o,s,a),O(s,t),U(e,t,null),r=!0},p(o,[a]){const l={};a&1&&(l.type=o[0]),a&2&&(l.color=o[1]),a&4&&(l.labels=o[2]),a&8&&(l.unit=o[3]),a&16&&(l.aggregation=o[4]),a&256&&(l.timeseries=o[8]),a&512&&(l.dataZoomOptions=o[9]),a&64&&(l.showAverageMarkline=o[6]),a&4719097&&(l.$$scope={dirty:a,ctx:o}),e.$set(l)},i(o){r||(I(e.$$.fragment,o),r=!0)},o(o){N(e.$$.fragment,o),r=!1},d(o){o&&C(s),W(e)}}}function be(n,s,t){const e={[`${T.PLAIN}`]:["Production"],[`${T.REPARTITION}`]:["I shared","I sold to market"]},r={[`${T.PLAIN}`]:[x],[`${T.REPARTITION}`]:[Ee,x]};let o=T.PLAIN,a=r[o],l=e[o],b=Y.KWH,p=u.MONTH,m=L.YEAR,R=!1,w,c=[],d={showAll:!1},{data:i}=s;const H=f=>{t(0,o=T.PLAIN),t(3,b=Y.KWH),t(4,p=u.MONTH),t(5,m=L.YEAR),t(8,c=f.months.plain),t(7,w=c[0].startedAt),t(1,a=r[o]),t(2,l=e[o]),t(9,d={showAll:!1}),console.log("ElectricityProduction.onData",f)},h=f=>{const E=o===T.REPARTITION?"repartition":"plain";return f[E]},g=f=>{t(0,o=f),t(3,b=Y.KWH),t(6,R=!1),t(4,p=u.MONTH),t(5,m=L.YEAR),t(8,c=h(i.months)),t(7,w=c[0].startedAt),t(1,a=r[o]),t(2,l=e[o])},_=(f,E)=>{if(t(3,b=Y.KWH),t(9,d={showAll:!1}),E===L.YEAR){switch(f){case u.MONTH:t(8,c=h(i.months));break;case u.WEEK:t(8,c=h(i.weeks));break}t(7,w=c[0].startedAt),t(4,p=f),t(5,m=E);return}let A=K(F(w).startOf("month"));switch(f){case u.WEEK:t(8,c=h(i.weeksMap[A]));break;case u.DAY:t(8,c=h(i.daysMap[A]));break;case u.HOUR:A=K(w),t(8,c=h(i.hoursMap[A])),t(9,d={showAll:!0});break}t(7,w=c[0].startedAt),t(4,p=f),t(5,m=E)},k=f=>{const{startedAt:E}=f;let A=K(E);if(console.log("ElectricityProduction.onChartClick timeserie",f),t(9,d={showAll:!1}),m===L.YEAR){switch(p){case u.MONTH:t(4,p=u.WEEK),t(8,c=h(i.weeksMap[A]));break;case u.WEEK:A=K(F(E).startOf("month")),t(4,p=u.DAY),t(8,c=h(i.daysMap[A]));break}t(7,w=c[0].startedAt),t(5,m=L.MONTH);return}switch(p){case u.WEEK:A=K(F(E).startOf("month")),t(4,p=u.DAY),t(8,c=h(i.daysMap[A]));break;case u.DAY:t(4,p=u.HOUR),t(8,c=h(i.hoursMap[A]));break;case u.HOUR:t(4,p=u.MINUTES),t(8,c=h(i.minutesMap[A])),t(3,b=Y.KW);break}t(7,w=c[0].startedAt),[u.HOUR,u.MINUTES].includes(p)&&(t(5,m=L.DAY),t(9,d={showAll:!0}))};function P(f){R=f,t(6,R)}return n.$$set=f=>{"data"in f&&t(13,i=f.data)},n.$$.update=()=>{n.$$.dirty&8192&&H(i)},[o,a,l,b,p,m,R,w,c,d,g,_,k,i,P]}class De extends oe{constructor(s){super(),re(this,s,be,Te,ne,{data:13})}}export{De as default};
