import{S as se,i as ne,s as le,z,d as E,h as w,k as m,l as C,n as N,q as A,A as re,B as ie,C as F,w as oe,j as g,D as J,o as O,x as j,r as R,y as G,e as K,t as y,f as D,m as W,p as X,u as Y,F as ce,G as ue,H as Q,b as de,c as fe,g as _e}from"./ECharts.C5Iir41h.js";import{e as Z,u as ge,d as he,E as me,a as v,U as H,A as V}from"./EnergyChart.DeoKOa97.js";import{T as pe}from"./Toggle.DGDEntvT.js";import{c as B}from"./cn.BpZeWVFd.js";import{h as U,j as x,k as Ee,l as be}from"./ChartLoadingSpinner.9-7-XflD.js";import"./dayjs.min.2rai63wT.js";import"./index.BAn-HqPX.js";function $(r,t,e){const s=r.slice();s[9]=t[e],s[12]=e;const c=s[9].disabled||s[2];return s[10]=c,s}function ee(r,t){let e,s,c,l=!1,a,n,i,h=t[9].label+"",f,_,d,b,I,k,L;return I=re(t[8][0]),{key:r,first:null,c(){e=A("label"),s=A("input"),n=R(),i=A("span"),f=G(h),d=R(),this.h()},l(p){e=C(p,"LABEL",{class:!0});var o=N(e);s=C(o,"INPUT",{class:!0,type:!0,name:!0}),n=O(o),i=C(o,"SPAN",{class:!0});var u=N(i);f=j(u,h),u.forEach(E),d=O(o),o.forEach(E),this.h()},h(){m(s,"class","peer hidden"),m(s,"type","radio"),m(s,"name",t[1]),s.__value=c=t[9].value,F(s,s.__value),s.disabled=a=t[10],m(i,"class",_=B(te,{"rounded-l-md":t[12]===0,"rounded-r-md":t[12]===t[4]})),m(e,"class",b=B("inline-flex items-center rounded-md text-gray-800",{"cursor-pointer":!t[10]})),I.p(s),this.first=e},m(p,o){w(p,e,o),g(e,s),s.checked=s.__value===t[0],g(e,n),g(e,i),g(i,f),g(e,d),k||(L=[J(s,"change",t[7]),J(s,"input",t[5])],k=!0)},p(p,o){t=p,o&2&&m(s,"name",t[1]),o&8&&c!==(c=t[9].value)&&(s.__value=c,F(s,s.__value),l=!0),o&12&&a!==(a=t[10])&&(s.disabled=a),(l||o&9)&&(s.checked=s.__value===t[0]),o&8&&h!==(h=t[9].label+"")&&oe(f,h),o&24&&_!==(_=B(te,{"rounded-l-md":t[12]===0,"rounded-r-md":t[12]===t[4]}))&&m(i,"class",_),o&12&&b!==(b=B("inline-flex items-center rounded-md text-gray-800",{"cursor-pointer":!t[10]}))&&m(e,"class",b)},d(p){p&&E(e),I.r(),k=!1,ie(L)}}}function ve(r){let t,e=[],s=new Map,c=Z(r[3]);const l=a=>a[9].value;for(let a=0;a<c.length;a+=1){let n=$(r,c,a),i=l(n);s.set(i,e[a]=ee(i,n))}return{c(){t=A("div");for(let a=0;a<e.length;a+=1)e[a].c();this.h()},l(a){t=C(a,"DIV",{class:!0});var n=N(t);for(let i=0;i<e.length;i+=1)e[i].l(n);n.forEach(E),this.h()},h(){m(t,"class","flex items-center")},m(a,n){w(a,t,n);for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(t,null)},p(a,[n]){n&63&&(c=Z(a[3]),e=ge(e,n,l,1,a,c,s,t,he,ee,null,$))},i:z,o:z,d(a){a&&E(t);for(let n=0;n<e.length;n+=1)e[n].d()}}}const Ce=()=>{},te="bg-gray-300 px-4 py-1 peer-checked:bg-blue-300 peer-disabled:opacity-50";function Ae(r,t,e){let s,{name:c}=t,{selected:l}=t,{disabled:a=!1}=t,{list:n}=t,{onchange:i=Ce}=t;const h=d=>{i(d.target?.value)},f=[[]];function _(){l=this.__value,e(0,l)}return r.$$set=d=>{"name"in d&&e(1,c=d.name),"selected"in d&&e(0,l=d.selected),"disabled"in d&&e(2,a=d.disabled),"list"in d&&e(3,n=d.list),"onchange"in d&&e(6,i=d.onchange)},r.$$.update=()=>{r.$$.dirty&8&&e(4,s=n.length-1)},[l,c,a,n,s,h,i,_,f]}class Ie extends se{constructor(t){super(),ne(this,t,Ae,ve,le,{name:1,selected:0,disabled:2,list:3,onchange:6})}}function ke(r){let t;return{c(){t=G("Electricity Consumption header actions")},l(e){t=j(e,"Electricity Consumption header actions")},m(e,s){w(e,t,s)},d(e){e&&E(t)}}}function ae(r){let t,e,s;function c(a){r[11](a)}let l={id:"showAverageToggle",label:"show average mark line"};return r[5]!==void 0&&(l.checked=r[5]),t=new pe({props:l}),de.push(()=>fe(t,"checked",c)),{c(){Y(t.$$.fragment)},l(a){X(t.$$.fragment,a)},m(a,n){W(t,a,n),s=!0},p(a,n){const i={};!e&&n&32&&(e=!0,i.checked=a[5],_e(()=>e=!1)),t.$set(i)},i(a){s||(D(t.$$.fragment,a),s=!0)},o(a){y(t.$$.fragment,a),s=!1},d(a){K(t,a)}}}function Te(r){let t,e,s,c,l="Consumption",a,n,i,h,f,_,d="Data started at:",b,I,k=x(r[6])+"",L,p;n=new Ie({props:{name:"buttons-toggle",selected:r[0],onchange:r[8],list:[{label:"Measured",value:v.PLAIN},{label:"Repartition",value:v.REPARTITION},{label:"Exceedance",value:v.EXCEEDANCE,disabled:!0}]}});let o=r[0]===v.PLAIN&&ae(r);return{c(){t=A("div"),e=A("div"),s=A("div"),c=A("span"),c.textContent=l,a=R(),Y(n.$$.fragment),i=R(),o&&o.c(),h=R(),f=A("div"),_=A("span"),_.textContent=d,b=R(),I=A("span"),L=G(k),this.h()},l(u){t=C(u,"DIV",{class:!0});var T=N(t);e=C(T,"DIV",{class:!0});var P=N(e);s=C(P,"DIV",{class:!0});var S=N(s);c=C(S,"SPAN",{"data-svelte-h":!0}),Q(c)!=="svelte-1vrp2az"&&(c.textContent=l),a=O(S),X(n.$$.fragment,S),S.forEach(E),i=O(P),o&&o.l(P),P.forEach(E),h=O(T),f=C(T,"DIV",{class:!0});var M=N(f);_=C(M,"SPAN",{"data-svelte-h":!0}),Q(_)!=="svelte-1cta1ja"&&(_.textContent=d),b=O(M),I=C(M,"SPAN",{class:!0});var q=N(I);L=j(q,k),q.forEach(E),M.forEach(E),T.forEach(E),this.h()},h(){m(s,"class","flex items-center gap-2"),m(e,"class","flex items-center gap-4"),m(I,"class","font-semibold"),m(f,"class","flex items-center gap-1 text-sm"),m(t,"class","flex items-center justify-between pt-2")},m(u,T){w(u,t,T),g(t,e),g(e,s),g(s,c),g(s,a),W(n,s,null),g(e,i),o&&o.m(e,null),g(t,h),g(t,f),g(f,_),g(f,b),g(f,I),g(I,L),p=!0},p(u,T){const P={};T&1&&(P.selected=u[0]),n.$set(P),u[0]===v.PLAIN?o?(o.p(u,T),T&1&&D(o,1)):(o=ae(u),o.c(),D(o,1),o.m(e,null)):o&&(ce(),y(o,1,1,()=>{o=null}),ue()),(!p||T&64)&&k!==(k=x(u[6])+"")&&oe(L,k)},i(u){p||(D(n.$$.fragment,u),D(o),p=!0)},o(u){y(n.$$.fragment,u),y(o),p=!1},d(u){u&&E(t),K(n),o&&o.d()}}}function Ne(r){let t,e,s,c;return s=new me({props:{type:r[0],color:r[1],labels:r[2],unit:r[3],aggregation:r[4],timeseries:r[7],showAverageMarkline:r[5],onclick:r[9],$$slots:{footer:[Te],headerActions:[ke]},$$scope:{ctx:r}}}),{c(){t=A("div"),e=A("div"),Y(s.$$.fragment),this.h()},l(l){t=C(l,"DIV",{class:!0});var a=N(t);e=C(a,"DIV",{class:!0});var n=N(e);X(s.$$.fragment,n),n.forEach(E),a.forEach(E),this.h()},h(){m(e,"class","absolute top-0 right-0 bottom-0 left-0"),m(t,"class","relative grow")},m(l,a){w(l,t,a),g(t,e),W(s,e,null),c=!0},p(l,[a]){const n={};a&1&&(n.type=l[0]),a&2&&(n.color=l[1]),a&4&&(n.labels=l[2]),a&8&&(n.unit=l[3]),a&16&&(n.aggregation=l[4]),a&128&&(n.timeseries=l[7]),a&32&&(n.showAverageMarkline=l[5]),a&65633&&(n.$$scope={dirty:a,ctx:l}),s.$set(n)},i(l){c||(D(s.$$.fragment,l),c=!0)},o(l){y(s.$$.fragment,l),c=!1},d(l){l&&E(t),K(s)}}}function Le(r,t,e){const s={[`${v.PLAIN}`]:["Consumption","Exceedance"],[`${v.PLAIN}_EXCEEDANCE`]:["Consumption","Exceedance"],[`${v.REPARTITION}`]:["Shared with me","Bought from market"]},c={[`${v.PLAIN}`]:[U],[`${v.PLAIN}_EXCEEDANCE`]:[U,be],[`${v.REPARTITION}`]:[Ee,U]};let l=v.PLAIN,a=[U],n=["Consumption","Exceedance"],i=H.KWH,h=V.MONTH,f=!1,_,d=[],{data:b}=t;const I=u=>{e(0,l=v.PLAIN),e(3,i=H.KWH),e(4,h=V.MONTH),e(7,d=u.months.plain),e(6,_=d[0].startedAt),e(1,a=c[l]),e(2,n=s[l])},k=u=>{e(0,l=u),e(5,f=!1),L()},L=()=>{e(3,i=h===V.MINUTES?H.KW:H.KWH),e(7,d=b.months[l===v.REPARTITION?"repartition":"plain"]),e(6,_=d[0].startedAt),e(1,a=c[l]),e(2,n=s[l]),console.log("ElectricityConsumption.updateTimeseries",{type:l,aggregation:h,color:a,labels:n,data:b})},p=u=>{console.log("ElectricityConsumption.onChartClick timeserie:",u)};function o(u){f=u,e(5,f)}return r.$$set=u=>{"data"in u&&e(10,b=u.data)},r.$$.update=()=>{r.$$.dirty&1024&&I(b)},[l,a,n,i,h,f,_,d,k,p,b,o]}class Me extends se{constructor(t){super(),ne(this,t,Le,Ne,le,{data:10})}}export{Me as default};
