import{S as ht,i as dt,s as mt,E as _t,A as gt,b as At,a as bt,d as g,c as N,t as M,e as j,f as xt,g as q,h as y,m as W,j as _,k as C,l as O,o as yt,n as z,p as k,r as Ct,q as H,B as Ot,v as kt,x as Et,y as pt}from"./ECharts.6qOP-yiC.js";import{d as Y}from"./dayjs.min.2rai63wT.js";import"./index.Bn5gjWO9.js";import{h as G}from"./colors.DRy8vmPD.js";import{e as Lt,g as vt,h as Dt,p as wt,j as It,L,k as St,q as Rt,m as Tt}from"./ChartLoadingSpinner.DDnJmpK1.js";import{a as P}from"./math.4fE8PRGd.js";function B(l){let t,a,o,s;return{c(){t=k("div"),a=k("span"),o=pt(l[0]),this.h()},l(i){t=C(i,"DIV",{class:!0});var c=O(t);a=C(c,"SPAN",{class:!0,title:!0});var r=O(a);o=Et(r,l[0]),r.forEach(g),c.forEach(g),this.h()},h(){_(a,"class","text-[0.7rem]"),_(a,"title",s="Unit: "+l[0]),_(t,"class","absolute top-2 left-4 z-10")},m(i,c){q(i,t,c),y(t,a),y(a,o)},p(i,c){c&1&&kt(o,i[0]),c&1&&s!==(s="Unit: "+i[0])&&_(a,"title",s)},d(i){i&&g(t)}}}function Ut(l){let t,a;return t=new It({props:{color:l[1]}}),{c(){H(t.$$.fragment)},l(o){z(t.$$.fragment,o)},m(o,s){W(t,o,s),a=!0},p(o,s){const i={};s&2&&(i.color=o[1]),t.$set(i)},i(o){a||(j(t.$$.fragment,o),a=!0)},o(o){M(t.$$.fragment,o),a=!1},d(o){N(t,o)}}}function Vt(l){let t,a,o,s,i,c,r=l[0]&&B(l);function A(n){l[11](n)}let d={init:gt,options:l[3],notMerge:!0,$$slots:{default:[Ut]},$$scope:{ctx:l}};return l[2]!==void 0&&(d.chart=l[2]),s=new _t({props:d}),At.push(()=>bt(s,"chart",A)),{c(){t=k("div"),r&&r.c(),a=Ct(),o=k("div"),H(s.$$.fragment),this.h()},l(n){t=C(n,"DIV",{class:!0});var u=O(t);r&&r.l(u),a=yt(u),o=C(u,"DIV",{class:!0});var f=O(o);z(s.$$.fragment,f),f.forEach(g),u.forEach(g),this.h()},h(){_(o,"class","absolute top-0 right-0 bottom-0 left-0 overflow-hidden rounded-lg border border-gray-100"),_(t,"class","relative grow")},m(n,u){q(n,t,u),r&&r.m(t,null),y(t,a),y(t,o),W(s,o,null),c=!0},p(n,[u]){n[0]?r?r.p(n,u):(r=B(n),r.c(),r.m(t,a)):r&&(r.d(1),r=null);const f={};u&8&&(f.options=n[3]),u&32770&&(f.$$scope={dirty:u,ctx:n}),!i&&u&4&&(i=!0,f.chart=n[2],xt(()=>i=!1)),s.$set(f)},i(n){c||(j(s.$$.fragment,n),c=!0)},o(n){M(s.$$.fragment,n),c=!1},d(n){n&&g(t),r&&r.d(),N(s)}}}const Ft="en-US";function Yt(l,t,a){let{unit:o=""}=t,{xAxisAttribute:s="startedAt"}=t,{yAxisAttribute:i="value"}=t,{color:c=Lt}=t,{colorOpacity:r=vt}=t,{backgroundColor:A=Dt}=t,{catchClickOnEmpty:d=!1}=t,{timeseries:n=[]}=t,{onclick:u=wt}=t,f,v={};const K=(e,m,b,w,J,Q,I)=>{const $=G(w,J),tt=G(L,.75);e=X(e);const S=e.length-1,et=new Intl.NumberFormat(Ft,{maximumFractionDigits:0}),x=e.reduce((h,E,V)=>{const F=V===S?w:$,lt=V===S?L:tt,p=E.value,ct=p===0;return p>h.maxYAxisValue&&(h.maxYAxisValue=p),h.xAxis.push(E[m]),h.yAxis.push({value:E[b],itemStyle:{borderRadius:St,borderWidth:1,borderColor:F,color:F},label:{show:!0,position:"top",color:lt,fontWeight:"bold",formatter:ut=>{const ft=ut.value;return ct?"":et.format(ft)}}}),h},{xAxis:[],yAxis:[],maxYAxisValue:0}),R="2%",T="10%",at={top:T,bottom:T,left:R,right:R},ot={trigger:"axis",axisPointer:{type:"shadow",z:0,shadowStyle:{color:Tt}},formatter:()=>""},rt={type:"category",data:x.xAxis,axisLabel:{formatter:Rt,color:L},axisLine:{show:!1},axisTick:{show:!1}},nt={type:"value",show:!1,max:h=>I?h.max:P(h.max,15)},U={type:"bar",data:x.yAxis,barCategoryGap:10},st=P(x.maxYAxisValue,15),it={type:"bar",color:"transparent",data:x.yAxis.map(()=>st),barGap:"-100%"};a(3,v={backgroundColor:Q,grid:at,tooltip:ot,xAxis:rt,yAxis:nt,series:I?[it,U]:[U]})},X=e=>{if(e.length>0)return e;for(let m=5;m>=0;m--){const b=(m>0?Y().subtract(m,"month"):Y()).startOf("month").startOf("day");e.push({startedAt:b.format(),endedAt:b.endOf("month").endOf("day").format(),value:0})}return e},D=e=>{console.log("onChartClick",e),e.data&&u(n[e.dataIndex])};Ot(()=>(f.on("click",D),console.log("EnergyOverviewChart - mounted",{chart:f}),()=>{f.off("click",D),console.log("EnergyOverviewChart - destroyed",{chart:f})}));function Z(e){f=e,a(2,f)}return l.$$set=e=>{"unit"in e&&a(0,o=e.unit),"xAxisAttribute"in e&&a(4,s=e.xAxisAttribute),"yAxisAttribute"in e&&a(5,i=e.yAxisAttribute),"color"in e&&a(1,c=e.color),"colorOpacity"in e&&a(6,r=e.colorOpacity),"backgroundColor"in e&&a(7,A=e.backgroundColor),"catchClickOnEmpty"in e&&a(8,d=e.catchClickOnEmpty),"timeseries"in e&&a(9,n=e.timeseries),"onclick"in e&&a(10,u=e.onclick)},l.$$.update=()=>{l.$$.dirty&1010&&K(n,s,i,c,r,A,d)},[o,c,f,v,s,i,r,A,d,n,u,Z]}class Wt extends ht{constructor(t){super(),dt(this,t,Yt,Vt,mt,{unit:0,xAxisAttribute:4,yAxisAttribute:5,color:1,colorOpacity:6,backgroundColor:7,catchClickOnEmpty:8,timeseries:9,onclick:10})}}export{Wt as E};
